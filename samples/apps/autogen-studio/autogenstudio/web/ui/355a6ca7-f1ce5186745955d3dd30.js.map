{"version":3,"file":"355a6ca7-f1ce5186745955d3dd30.js","mappings":"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","sources":["webpack://AutoGen_Studio/./node_modules/@antv/g-lite/dist/index.esm.js"],"sourcesContent":["/*!\n * @antv/g-lite\n * @description A core module for rendering engine implements DOM API.\n * @version 2.1.3\n * @date 10/24/2024, 7:56:07 AM\n * @author AntVis\n * @docs https://g.antv.antgroup.com/\n */\nimport _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport _callSuper from '@babel/runtime/helpers/callSuper';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport EventEmitter from 'eventemitter3';\nimport { vec3, vec4, mat4, mat3, quat as quat$1, vec2 } from 'gl-matrix';\nimport '@babel/runtime/helpers/readOnlyError';\nimport { isNumber, distanceSquareRoot, isString, isNil, clamp, getTotalLength, min, max, isNumberEqual, mod, normalizePath, path2Curve, equalizeSegments, getDrawDirection, reverseCurve, clonePath, getRotatedCurve, isUndefined, isArray, isBoolean, isFunction, isObject, getPointAtLength } from '@antv/util';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _superPropGet from '@babel/runtime/helpers/superPropGet';\nimport * as d3 from 'd3-color';\nimport { polylineLength, arcBox, cubicBox, quadBox, linePointAt, lineLength } from '@antv/g-math';\nimport _regeneratorRuntime from '@babel/runtime/helpers/regeneratorRuntime';\nimport _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _createForOfIteratorHelper from '@babel/runtime/helpers/createForOfIteratorHelper';\nimport _objectWithoutProperties from '@babel/runtime/helpers/objectWithoutProperties';\n\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nvar rbush = {exports: {}};\n\n(function (module, exports) {\n(function (global, factory) {\nmodule.exports = factory() ;\n}(commonjsGlobal, function () {\nfunction quickselect(arr, k, left, right, compare) {\n    quickselectStep(arr, k, left || 0, right || (arr.length - 1), compare || defaultCompare);\n}\n\nfunction quickselectStep(arr, k, left, right, compare) {\n\n    while (right > left) {\n        if (right - left > 600) {\n            var n = right - left + 1;\n            var m = k - left + 1;\n            var z = Math.log(n);\n            var s = 0.5 * Math.exp(2 * z / 3);\n            var sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\n            var newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\n            var newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\n            quickselectStep(arr, k, newLeft, newRight, compare);\n        }\n\n        var t = arr[k];\n        var i = left;\n        var j = right;\n\n        swap(arr, left, k);\n        if (compare(arr[right], t) > 0) { swap(arr, left, right); }\n\n        while (i < j) {\n            swap(arr, i, j);\n            i++;\n            j--;\n            while (compare(arr[i], t) < 0) { i++; }\n            while (compare(arr[j], t) > 0) { j--; }\n        }\n\n        if (compare(arr[left], t) === 0) { swap(arr, left, j); }\n        else {\n            j++;\n            swap(arr, j, right);\n        }\n\n        if (j <= k) { left = j + 1; }\n        if (k <= j) { right = j - 1; }\n    }\n}\n\nfunction swap(arr, i, j) {\n    var tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n}\n\nfunction defaultCompare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\nvar RBush = function RBush(maxEntries) {\n    if ( maxEntries === void 0 ) maxEntries = 9;\n\n    // max entries in a node is 9 by default; min node fill is 40% for best performance\n    this._maxEntries = Math.max(4, maxEntries);\n    this._minEntries = Math.max(2, Math.ceil(this._maxEntries * 0.4));\n    this.clear();\n};\n\nRBush.prototype.all = function all () {\n    return this._all(this.data, []);\n};\n\nRBush.prototype.search = function search (bbox) {\n    var node = this.data;\n    var result = [];\n\n    if (!intersects(bbox, node)) { return result; }\n\n    var toBBox = this.toBBox;\n    var nodesToSearch = [];\n\n    while (node) {\n        for (var i = 0; i < node.children.length; i++) {\n            var child = node.children[i];\n            var childBBox = node.leaf ? toBBox(child) : child;\n\n            if (intersects(bbox, childBBox)) {\n                if (node.leaf) { result.push(child); }\n                else if (contains(bbox, childBBox)) { this._all(child, result); }\n                else { nodesToSearch.push(child); }\n            }\n        }\n        node = nodesToSearch.pop();\n    }\n\n    return result;\n};\n\nRBush.prototype.collides = function collides (bbox) {\n    var node = this.data;\n\n    if (!intersects(bbox, node)) { return false; }\n\n    var nodesToSearch = [];\n    while (node) {\n        for (var i = 0; i < node.children.length; i++) {\n            var child = node.children[i];\n            var childBBox = node.leaf ? this.toBBox(child) : child;\n\n            if (intersects(bbox, childBBox)) {\n                if (node.leaf || contains(bbox, childBBox)) { return true; }\n                nodesToSearch.push(child);\n            }\n        }\n        node = nodesToSearch.pop();\n    }\n\n    return false;\n};\n\nRBush.prototype.load = function load (data) {\n    if (!(data && data.length)) { return this; }\n\n    if (data.length < this._minEntries) {\n        for (var i = 0; i < data.length; i++) {\n            this.insert(data[i]);\n        }\n        return this;\n    }\n\n    // recursively build the tree with the given data from scratch using OMT algorithm\n    var node = this._build(data.slice(), 0, data.length - 1, 0);\n\n    if (!this.data.children.length) {\n        // save as is if tree is empty\n        this.data = node;\n\n    } else if (this.data.height === node.height) {\n        // split root if trees have the same height\n        this._splitRoot(this.data, node);\n\n    } else {\n        if (this.data.height < node.height) {\n            // swap trees if inserted one is bigger\n            var tmpNode = this.data;\n            this.data = node;\n            node = tmpNode;\n        }\n\n        // insert the small tree into the large tree at appropriate level\n        this._insert(node, this.data.height - node.height - 1, true);\n    }\n\n    return this;\n};\n\nRBush.prototype.insert = function insert (item) {\n    if (item) { this._insert(item, this.data.height - 1); }\n    return this;\n};\n\nRBush.prototype.clear = function clear () {\n    this.data = createNode([]);\n    return this;\n};\n\nRBush.prototype.remove = function remove (item, equalsFn) {\n    if (!item) { return this; }\n\n    var node = this.data;\n    var bbox = this.toBBox(item);\n    var path = [];\n    var indexes = [];\n    var i, parent, goingUp;\n\n    // depth-first iterative tree traversal\n    while (node || path.length) {\n\n        if (!node) { // go up\n            node = path.pop();\n            parent = path[path.length - 1];\n            i = indexes.pop();\n            goingUp = true;\n        }\n\n        if (node.leaf) { // check current node\n            var index = findItem(item, node.children, equalsFn);\n\n            if (index !== -1) {\n                // item found, remove the item and condense tree upwards\n                node.children.splice(index, 1);\n                path.push(node);\n                this._condense(path);\n                return this;\n            }\n        }\n\n        if (!goingUp && !node.leaf && contains(node, bbox)) { // go down\n            path.push(node);\n            indexes.push(i);\n            i = 0;\n            parent = node;\n            node = node.children[0];\n\n        } else if (parent) { // go right\n            i++;\n            node = parent.children[i];\n            goingUp = false;\n\n        } else { node = null; } // nothing found\n    }\n\n    return this;\n};\n\nRBush.prototype.toBBox = function toBBox (item) { return item; };\n\nRBush.prototype.compareMinX = function compareMinX (a, b) { return a.minX - b.minX; };\nRBush.prototype.compareMinY = function compareMinY (a, b) { return a.minY - b.minY; };\n\nRBush.prototype.toJSON = function toJSON () { return this.data; };\n\nRBush.prototype.fromJSON = function fromJSON (data) {\n    this.data = data;\n    return this;\n};\n\nRBush.prototype._all = function _all (node, result) {\n    var nodesToSearch = [];\n    while (node) {\n        if (node.leaf) { result.push.apply(result, node.children); }\n        else { nodesToSearch.push.apply(nodesToSearch, node.children); }\n\n        node = nodesToSearch.pop();\n    }\n    return result;\n};\n\nRBush.prototype._build = function _build (items, left, right, height) {\n\n    var N = right - left + 1;\n    var M = this._maxEntries;\n    var node;\n\n    if (N <= M) {\n        // reached leaf level; return leaf\n        node = createNode(items.slice(left, right + 1));\n        calcBBox(node, this.toBBox);\n        return node;\n    }\n\n    if (!height) {\n        // target height of the bulk-loaded tree\n        height = Math.ceil(Math.log(N) / Math.log(M));\n\n        // target number of root entries to maximize storage utilization\n        M = Math.ceil(N / Math.pow(M, height - 1));\n    }\n\n    node = createNode([]);\n    node.leaf = false;\n    node.height = height;\n\n    // split the items into M mostly square tiles\n\n    var N2 = Math.ceil(N / M);\n    var N1 = N2 * Math.ceil(Math.sqrt(M));\n\n    multiSelect(items, left, right, N1, this.compareMinX);\n\n    for (var i = left; i <= right; i += N1) {\n\n        var right2 = Math.min(i + N1 - 1, right);\n\n        multiSelect(items, i, right2, N2, this.compareMinY);\n\n        for (var j = i; j <= right2; j += N2) {\n\n            var right3 = Math.min(j + N2 - 1, right2);\n\n            // pack each entry recursively\n            node.children.push(this._build(items, j, right3, height - 1));\n        }\n    }\n\n    calcBBox(node, this.toBBox);\n\n    return node;\n};\n\nRBush.prototype._chooseSubtree = function _chooseSubtree (bbox, node, level, path) {\n    while (true) {\n        path.push(node);\n\n        if (node.leaf || path.length - 1 === level) { break; }\n\n        var minArea = Infinity;\n        var minEnlargement = Infinity;\n        var targetNode = (void 0);\n\n        for (var i = 0; i < node.children.length; i++) {\n            var child = node.children[i];\n            var area = bboxArea(child);\n            var enlargement = enlargedArea(bbox, child) - area;\n\n            // choose entry with the least area enlargement\n            if (enlargement < minEnlargement) {\n                minEnlargement = enlargement;\n                minArea = area < minArea ? area : minArea;\n                targetNode = child;\n\n            } else if (enlargement === minEnlargement) {\n                // otherwise choose one with the smallest area\n                if (area < minArea) {\n                    minArea = area;\n                    targetNode = child;\n                }\n            }\n        }\n\n        node = targetNode || node.children[0];\n    }\n\n    return node;\n};\n\nRBush.prototype._insert = function _insert (item, level, isNode) {\n    var bbox = isNode ? item : this.toBBox(item);\n    var insertPath = [];\n\n    // find the best node for accommodating the item, saving all nodes along the path too\n    var node = this._chooseSubtree(bbox, this.data, level, insertPath);\n\n    // put the item into the node\n    node.children.push(item);\n    extend(node, bbox);\n\n    // split on node overflow; propagate upwards if necessary\n    while (level >= 0) {\n        if (insertPath[level].children.length > this._maxEntries) {\n            this._split(insertPath, level);\n            level--;\n        } else { break; }\n    }\n\n    // adjust bboxes along the insertion path\n    this._adjustParentBBoxes(bbox, insertPath, level);\n};\n\n// split overflowed node into two\nRBush.prototype._split = function _split (insertPath, level) {\n    var node = insertPath[level];\n    var M = node.children.length;\n    var m = this._minEntries;\n\n    this._chooseSplitAxis(node, m, M);\n\n    var splitIndex = this._chooseSplitIndex(node, m, M);\n\n    var newNode = createNode(node.children.splice(splitIndex, node.children.length - splitIndex));\n    newNode.height = node.height;\n    newNode.leaf = node.leaf;\n\n    calcBBox(node, this.toBBox);\n    calcBBox(newNode, this.toBBox);\n\n    if (level) { insertPath[level - 1].children.push(newNode); }\n    else { this._splitRoot(node, newNode); }\n};\n\nRBush.prototype._splitRoot = function _splitRoot (node, newNode) {\n    // split root node\n    this.data = createNode([node, newNode]);\n    this.data.height = node.height + 1;\n    this.data.leaf = false;\n    calcBBox(this.data, this.toBBox);\n};\n\nRBush.prototype._chooseSplitIndex = function _chooseSplitIndex (node, m, M) {\n    var index;\n    var minOverlap = Infinity;\n    var minArea = Infinity;\n\n    for (var i = m; i <= M - m; i++) {\n        var bbox1 = distBBox(node, 0, i, this.toBBox);\n        var bbox2 = distBBox(node, i, M, this.toBBox);\n\n        var overlap = intersectionArea(bbox1, bbox2);\n        var area = bboxArea(bbox1) + bboxArea(bbox2);\n\n        // choose distribution with minimum overlap\n        if (overlap < minOverlap) {\n            minOverlap = overlap;\n            index = i;\n\n            minArea = area < minArea ? area : minArea;\n\n        } else if (overlap === minOverlap) {\n            // otherwise choose distribution with minimum area\n            if (area < minArea) {\n                minArea = area;\n                index = i;\n            }\n        }\n    }\n\n    return index || M - m;\n};\n\n// sorts node children by the best axis for split\nRBush.prototype._chooseSplitAxis = function _chooseSplitAxis (node, m, M) {\n    var compareMinX = node.leaf ? this.compareMinX : compareNodeMinX;\n    var compareMinY = node.leaf ? this.compareMinY : compareNodeMinY;\n    var xMargin = this._allDistMargin(node, m, M, compareMinX);\n    var yMargin = this._allDistMargin(node, m, M, compareMinY);\n\n    // if total distributions margin value is minimal for x, sort by minX,\n    // otherwise it's already sorted by minY\n    if (xMargin < yMargin) { node.children.sort(compareMinX); }\n};\n\n// total margin of all possible split distributions where each node is at least m full\nRBush.prototype._allDistMargin = function _allDistMargin (node, m, M, compare) {\n    node.children.sort(compare);\n\n    var toBBox = this.toBBox;\n    var leftBBox = distBBox(node, 0, m, toBBox);\n    var rightBBox = distBBox(node, M - m, M, toBBox);\n    var margin = bboxMargin(leftBBox) + bboxMargin(rightBBox);\n\n    for (var i = m; i < M - m; i++) {\n        var child = node.children[i];\n        extend(leftBBox, node.leaf ? toBBox(child) : child);\n        margin += bboxMargin(leftBBox);\n    }\n\n    for (var i$1 = M - m - 1; i$1 >= m; i$1--) {\n        var child$1 = node.children[i$1];\n        extend(rightBBox, node.leaf ? toBBox(child$1) : child$1);\n        margin += bboxMargin(rightBBox);\n    }\n\n    return margin;\n};\n\nRBush.prototype._adjustParentBBoxes = function _adjustParentBBoxes (bbox, path, level) {\n    // adjust bboxes along the given tree path\n    for (var i = level; i >= 0; i--) {\n        extend(path[i], bbox);\n    }\n};\n\nRBush.prototype._condense = function _condense (path) {\n    // go through the path, removing empty nodes and updating bboxes\n    for (var i = path.length - 1, siblings = (void 0); i >= 0; i--) {\n        if (path[i].children.length === 0) {\n            if (i > 0) {\n                siblings = path[i - 1].children;\n                siblings.splice(siblings.indexOf(path[i]), 1);\n\n            } else { this.clear(); }\n\n        } else { calcBBox(path[i], this.toBBox); }\n    }\n};\n\nfunction findItem(item, items, equalsFn) {\n    if (!equalsFn) { return items.indexOf(item); }\n\n    for (var i = 0; i < items.length; i++) {\n        if (equalsFn(item, items[i])) { return i; }\n    }\n    return -1;\n}\n\n// calculate node's bbox from bboxes of its children\nfunction calcBBox(node, toBBox) {\n    distBBox(node, 0, node.children.length, toBBox, node);\n}\n\n// min bounding rectangle of node children from k to p-1\nfunction distBBox(node, k, p, toBBox, destNode) {\n    if (!destNode) { destNode = createNode(null); }\n    destNode.minX = Infinity;\n    destNode.minY = Infinity;\n    destNode.maxX = -Infinity;\n    destNode.maxY = -Infinity;\n\n    for (var i = k; i < p; i++) {\n        var child = node.children[i];\n        extend(destNode, node.leaf ? toBBox(child) : child);\n    }\n\n    return destNode;\n}\n\nfunction extend(a, b) {\n    a.minX = Math.min(a.minX, b.minX);\n    a.minY = Math.min(a.minY, b.minY);\n    a.maxX = Math.max(a.maxX, b.maxX);\n    a.maxY = Math.max(a.maxY, b.maxY);\n    return a;\n}\n\nfunction compareNodeMinX(a, b) { return a.minX - b.minX; }\nfunction compareNodeMinY(a, b) { return a.minY - b.minY; }\n\nfunction bboxArea(a)   { return (a.maxX - a.minX) * (a.maxY - a.minY); }\nfunction bboxMargin(a) { return (a.maxX - a.minX) + (a.maxY - a.minY); }\n\nfunction enlargedArea(a, b) {\n    return (Math.max(b.maxX, a.maxX) - Math.min(b.minX, a.minX)) *\n           (Math.max(b.maxY, a.maxY) - Math.min(b.minY, a.minY));\n}\n\nfunction intersectionArea(a, b) {\n    var minX = Math.max(a.minX, b.minX);\n    var minY = Math.max(a.minY, b.minY);\n    var maxX = Math.min(a.maxX, b.maxX);\n    var maxY = Math.min(a.maxY, b.maxY);\n\n    return Math.max(0, maxX - minX) *\n           Math.max(0, maxY - minY);\n}\n\nfunction contains(a, b) {\n    return a.minX <= b.minX &&\n           a.minY <= b.minY &&\n           b.maxX <= a.maxX &&\n           b.maxY <= a.maxY;\n}\n\nfunction intersects(a, b) {\n    return b.minX <= a.maxX &&\n           b.minY <= a.maxY &&\n           b.maxX >= a.minX &&\n           b.maxY >= a.minY;\n}\n\nfunction createNode(children) {\n    return {\n        children: children,\n        height: 1,\n        leaf: true,\n        minX: Infinity,\n        minY: Infinity,\n        maxX: -Infinity,\n        maxY: -Infinity\n    };\n}\n\n// sort an array so that items come in groups of n unsorted items, with groups sorted between each other;\n// combines selection algorithm with binary divide & conquer approach\n\nfunction multiSelect(arr, left, right, n, compare) {\n    var stack = [left, right];\n\n    while (stack.length) {\n        right = stack.pop();\n        left = stack.pop();\n\n        if (right - left <= n) { continue; }\n\n        var mid = left + Math.ceil((right - left) / n / 2) * n;\n        quickselect(arr, mid, left, right, compare);\n\n        stack.push(left, mid, mid, right);\n    }\n}\n\nreturn RBush;\n\n}));\n}(rbush));\n\nvar RBush = rbush.exports;\n\nvar Shape = /*#__PURE__*/function (Shape) {\n  Shape[\"GROUP\"] = \"g\";\n  Shape[\"FRAGMENT\"] = \"fragment\";\n  Shape[\"CIRCLE\"] = \"circle\";\n  Shape[\"ELLIPSE\"] = \"ellipse\";\n  Shape[\"IMAGE\"] = \"image\";\n  Shape[\"RECT\"] = \"rect\";\n  Shape[\"LINE\"] = \"line\";\n  Shape[\"POLYLINE\"] = \"polyline\";\n  Shape[\"POLYGON\"] = \"polygon\";\n  Shape[\"TEXT\"] = \"text\";\n  Shape[\"PATH\"] = \"path\";\n  Shape[\"HTML\"] = \"html\";\n  Shape[\"MESH\"] = \"mesh\";\n  return Shape;\n}({});\n\n// prettier-ignore\n\n// prettier-ignore\n\n// Cursor style\n// See: https://developer.mozilla.org/en-US/docs/Web/CSS/cursor\n\nvar ClipSpaceNearZ = /*#__PURE__*/function (ClipSpaceNearZ) {\n  ClipSpaceNearZ[ClipSpaceNearZ[\"ZERO\"] = 0] = \"ZERO\";\n  ClipSpaceNearZ[ClipSpaceNearZ[\"NEGATIVE_ONE\"] = 1] = \"NEGATIVE_ONE\";\n  return ClipSpaceNearZ;\n}({});\n\n/**\n * eg. NodeCanvas, OffscreenCanvas, HTMLCanvasElement\n */\n\n/**\n * The format to use when defining custom easing functions\n */\n\n// @see https://github.com/zhanba/pailye/blob/master/packages/flex/src/types.ts\n\nvar AbstractRendererPlugin = /*#__PURE__*/function () {\n  function AbstractRendererPlugin() {\n    _classCallCheck(this, AbstractRendererPlugin);\n    this.plugins = [];\n  }\n  return _createClass(AbstractRendererPlugin, [{\n    key: \"addRenderingPlugin\",\n    value: function addRenderingPlugin(plugin) {\n      this.plugins.push(plugin);\n      this.context.renderingPlugins.push(plugin);\n    }\n  }, {\n    key: \"removeAllRenderingPlugins\",\n    value: function removeAllRenderingPlugins() {\n      var _this = this;\n      this.plugins.forEach(function (plugin) {\n        var index = _this.context.renderingPlugins.indexOf(plugin);\n        if (index >= 0) {\n          _this.context.renderingPlugins.splice(index, 1);\n        }\n      });\n    }\n  }]);\n}();\nvar AbstractRenderer = /*#__PURE__*/function () {\n  function AbstractRenderer(config) {\n    _classCallCheck(this, AbstractRenderer);\n    this.clipSpaceNearZ = ClipSpaceNearZ.NEGATIVE_ONE;\n    this.plugins = [];\n    this.config = _objectSpread({\n      /**\n       * only dirty object will cause re-render\n       */\n      enableDirtyCheck: true,\n      enableCulling: false,\n      /**\n       * enable auto rendering by default\n       */\n      enableAutoRendering: true,\n      /**\n       * enable dirty rectangle rendering by default\n       */\n      enableDirtyRectangleRendering: true,\n      enableDirtyRectangleRenderingDebug: false,\n      enableSizeAttenuation: true\n    }, config);\n  }\n  return _createClass(AbstractRenderer, [{\n    key: \"registerPlugin\",\n    value: function registerPlugin(plugin) {\n      var index = this.plugins.findIndex(function (p) {\n        return p === plugin;\n      });\n      if (index === -1) {\n        this.plugins.push(plugin);\n      }\n    }\n  }, {\n    key: \"unregisterPlugin\",\n    value: function unregisterPlugin(plugin) {\n      var index = this.plugins.findIndex(function (p) {\n        return p === plugin;\n      });\n      if (index > -1) {\n        this.plugins.splice(index, 1);\n      }\n    }\n  }, {\n    key: \"getPlugins\",\n    value: function getPlugins() {\n      return this.plugins;\n    }\n  }, {\n    key: \"getPlugin\",\n    value: function getPlugin(name) {\n      return this.plugins.find(function (plugin) {\n        return plugin.name === name;\n      });\n    }\n  }, {\n    key: \"getConfig\",\n    value: function getConfig() {\n      return this.config;\n    }\n  }, {\n    key: \"setConfig\",\n    value: function setConfig(config) {\n      Object.assign(this.config, config);\n    }\n  }]);\n}();\n\nvar addVec3 = vec3.add,\n  copyVec3 = vec3.copy,\n  maxVec3 = vec3.max,\n  minVec3 = vec3.min,\n  scaleVec3 = vec3.scale,\n  subVec3 = vec3.sub;\n\n/**\n * Axis-Aligned Bounding Box\n * 为了便于后续 Frustum Culling，通过查找表定义 p-vertex 和 n-vertex\n * @see https://github.com/antvis/GWebGPUEngine/issues/3\n */\nvar AABB = /*#__PURE__*/function () {\n  function AABB() {\n    _classCallCheck(this, AABB);\n    this.center = [0, 0, 0];\n    this.halfExtents = [0, 0, 0];\n    this.min = [0, 0, 0];\n    this.max = [0, 0, 0];\n  }\n  return _createClass(AABB, [{\n    key: \"update\",\n    value: function update(center, halfExtents) {\n      copyVec3(this.center, center);\n      copyVec3(this.halfExtents, halfExtents);\n      subVec3(this.min, this.center, this.halfExtents);\n      addVec3(this.max, this.center, this.halfExtents);\n    }\n  }, {\n    key: \"setMinMax\",\n    value: function setMinMax(min, max) {\n      addVec3(this.center, max, min);\n      scaleVec3(this.center, this.center, 0.5);\n      subVec3(this.halfExtents, max, min);\n      scaleVec3(this.halfExtents, this.halfExtents, 0.5);\n      copyVec3(this.min, min);\n      copyVec3(this.max, max);\n    }\n  }, {\n    key: \"getMin\",\n    value: function getMin() {\n      return this.min;\n    }\n  }, {\n    key: \"getMax\",\n    value: function getMax() {\n      return this.max;\n    }\n  }, {\n    key: \"add\",\n    value: function add(aabb) {\n      if (AABB.isEmpty(aabb)) {\n        return;\n      }\n      if (AABB.isEmpty(this)) {\n        this.setMinMax(aabb.getMin(), aabb.getMax());\n        return;\n      }\n      var tc = this.center;\n      var tcx = tc[0];\n      var tcy = tc[1];\n      var tcz = tc[2];\n      var th = this.halfExtents;\n      var thx = th[0];\n      var thy = th[1];\n      var thz = th[2];\n      var tminx = tcx - thx;\n      var tmaxx = tcx + thx;\n      var tminy = tcy - thy;\n      var tmaxy = tcy + thy;\n      var tminz = tcz - thz;\n      var tmaxz = tcz + thz;\n      var oc = aabb.center;\n      var ocx = oc[0];\n      var ocy = oc[1];\n      var ocz = oc[2];\n      var oh = aabb.halfExtents;\n      var ohx = oh[0];\n      var ohy = oh[1];\n      var ohz = oh[2];\n      var ominx = ocx - ohx;\n      var omaxx = ocx + ohx;\n      var ominy = ocy - ohy;\n      var omaxy = ocy + ohy;\n      var ominz = ocz - ohz;\n      var omaxz = ocz + ohz;\n      if (ominx < tminx) {\n        tminx = ominx;\n      }\n      if (omaxx > tmaxx) {\n        tmaxx = omaxx;\n      }\n      if (ominy < tminy) {\n        tminy = ominy;\n      }\n      if (omaxy > tmaxy) {\n        tmaxy = omaxy;\n      }\n      if (ominz < tminz) {\n        tminz = ominz;\n      }\n      if (omaxz > tmaxz) {\n        tmaxz = omaxz;\n      }\n      tc[0] = (tminx + tmaxx) * 0.5;\n      tc[1] = (tminy + tmaxy) * 0.5;\n      tc[2] = (tminz + tmaxz) * 0.5;\n      th[0] = (tmaxx - tminx) * 0.5;\n      th[1] = (tmaxy - tminy) * 0.5;\n      th[2] = (tmaxz - tminz) * 0.5;\n      this.min[0] = tminx;\n      this.min[1] = tminy;\n      this.min[2] = tminz;\n      this.max[0] = tmaxx;\n      this.max[1] = tmaxy;\n      this.max[2] = tmaxz;\n    }\n  }, {\n    key: \"setFromTransformedAABB\",\n    value: function setFromTransformedAABB(aabb, m) {\n      var bc = this.center;\n      var br = this.halfExtents;\n      var ac = aabb.center;\n      var ar = aabb.halfExtents;\n      var mx0 = m[0];\n      var mx1 = m[4];\n      var mx2 = m[8];\n      var my0 = m[1];\n      var my1 = m[5];\n      var my2 = m[9];\n      var mz0 = m[2];\n      var mz1 = m[6];\n      var mz2 = m[10];\n      var mx0a = Math.abs(mx0);\n      var mx1a = Math.abs(mx1);\n      var mx2a = Math.abs(mx2);\n      var my0a = Math.abs(my0);\n      var my1a = Math.abs(my1);\n      var my2a = Math.abs(my2);\n      var mz0a = Math.abs(mz0);\n      var mz1a = Math.abs(mz1);\n      var mz2a = Math.abs(mz2);\n      bc[0] = m[12] + mx0 * ac[0] + mx1 * ac[1] + mx2 * ac[2];\n      bc[1] = m[13] + my0 * ac[0] + my1 * ac[1] + my2 * ac[2];\n      bc[2] = m[14] + mz0 * ac[0] + mz1 * ac[1] + mz2 * ac[2];\n\n      // vec3.set(\n      //   bc,\n      //   m[12] + mx0 * ac[0] + mx1 * ac[1] + mx2 * ac[2],\n      //   m[13] + my0 * ac[0] + my1 * ac[1] + my2 * ac[2],\n      //   m[14] + mz0 * ac[0] + mz1 * ac[1] + mz2 * ac[2],\n      // );\n\n      br[0] = mx0a * ar[0] + mx1a * ar[1] + mx2a * ar[2];\n      br[1] = my0a * ar[0] + my1a * ar[1] + my2a * ar[2];\n      br[2] = mz0a * ar[0] + mz1a * ar[1] + mz2a * ar[2];\n\n      // vec3.set(\n      //   br,\n      //   mx0a * ar[0] + mx1a * ar[1] + mx2a * ar[2],\n      //   my0a * ar[0] + my1a * ar[1] + my2a * ar[2],\n      //   mz0a * ar[0] + mz1a * ar[1] + mz2a * ar[2],\n      // );\n\n      // this.min = vec3.sub(this.min, bc, br);\n      // this.max = vec3.add(this.max, bc, br);\n\n      subVec3(this.min, bc, br);\n      addVec3(this.max, bc, br);\n    }\n  }, {\n    key: \"intersects\",\n    value: function intersects(aabb) {\n      var aMax = this.getMax();\n      var aMin = this.getMin();\n      var bMax = aabb.getMax();\n      var bMin = aabb.getMin();\n      return aMin[0] <= bMax[0] && aMax[0] >= bMin[0] && aMin[1] <= bMax[1] && aMax[1] >= bMin[1] && aMin[2] <= bMax[2] && aMax[2] >= bMin[2];\n    }\n  }, {\n    key: \"intersection\",\n    value: function intersection(aabb) {\n      if (!this.intersects(aabb)) {\n        return null;\n      }\n      var intersection = new AABB();\n      var min = maxVec3([0, 0, 0], this.getMin(), aabb.getMin());\n      var max = minVec3([0, 0, 0], this.getMax(), aabb.getMax());\n      intersection.setMinMax(min, max);\n      return intersection;\n    }\n\n    /**\n     * get n-vertex\n     * @param plane plane of CullingVolume\n     */\n  }, {\n    key: \"getNegativeFarPoint\",\n    value: function getNegativeFarPoint(plane) {\n      if (plane.pnVertexFlag === 0x111) {\n        return copyVec3([0, 0, 0], this.min);\n        // return vec3.copy(vec3.create(), this.min);\n      }\n      if (plane.pnVertexFlag === 0x110) {\n        return [this.min[0], this.min[1], this.max[2]];\n        // return vec3.fromValues(this.min[0], this.min[1], this.max[2]);\n      }\n      if (plane.pnVertexFlag === 0x101) {\n        return [this.min[0], this.max[1], this.min[2]];\n        // return vec3.fromValues(this.min[0], this.max[1], this.min[2]);\n      }\n      if (plane.pnVertexFlag === 0x100) {\n        return [this.min[0], this.max[1], this.max[2]];\n        // return vec3.fromValues(this.min[0], this.max[1], this.max[2]);\n      }\n      if (plane.pnVertexFlag === 0x011) {\n        return [this.max[0], this.min[1], this.min[2]];\n        // return vec3.fromValues(this.max[0], this.min[1], this.min[2]);\n      }\n      if (plane.pnVertexFlag === 0x010) {\n        return [this.max[0], this.min[1], this.max[2]];\n        // return vec3.fromValues(this.max[0], this.min[1], this.max[2]);\n      }\n      if (plane.pnVertexFlag === 0x001) {\n        return [this.max[0], this.max[1], this.min[2]];\n        // return vec3.fromValues(this.max[0], this.max[1], this.min[2]);\n      }\n      return [this.max[0], this.max[1], this.max[2]];\n      // return vec3.fromValues(this.max[0], this.max[1], this.max[2]);\n    }\n\n    /**\n     * get p-vertex\n     * @param plane plane of CullingVolume\n     */\n  }, {\n    key: \"getPositiveFarPoint\",\n    value: function getPositiveFarPoint(plane) {\n      if (plane.pnVertexFlag === 0x111) {\n        return copyVec3([0, 0, 0], this.max);\n        // return vec3.copy(vec3.create(), this.max);\n      }\n      if (plane.pnVertexFlag === 0x110) {\n        return [this.max[0], this.max[1], this.min[2]];\n        // return vec3.fromValues(this.max[0], this.max[1], this.min[2]);\n      }\n      if (plane.pnVertexFlag === 0x101) {\n        return [this.max[0], this.min[1], this.max[2]];\n        // return vec3.fromValues(this.max[0], this.min[1], this.max[2]);\n      }\n      if (plane.pnVertexFlag === 0x100) {\n        return [this.max[0], this.min[1], this.min[2]];\n        // return vec3.fromValues(this.max[0], this.min[1], this.min[2]);\n      }\n      if (plane.pnVertexFlag === 0x011) {\n        return [this.min[0], this.max[1], this.max[2]];\n        // return vec3.fromValues(this.min[0], this.max[1], this.max[2]);\n      }\n      if (plane.pnVertexFlag === 0x010) {\n        return [this.min[0], this.max[1], this.min[2]];\n        // return vec3.fromValues(this.min[0], this.max[1], this.min[2]);\n      }\n      if (plane.pnVertexFlag === 0x001) {\n        return [this.min[0], this.min[1], this.max[2]];\n        // return vec3.fromValues(this.min[0], this.min[1], this.max[2]);\n      }\n      return [this.min[0], this.min[1], this.min[2]];\n      // return vec3.fromValues(this.min[0], this.min[1], this.min[2]);\n    }\n  }], [{\n    key: \"isEmpty\",\n    value: function isEmpty(aabb) {\n      return !aabb || aabb.halfExtents[0] === 0 && aabb.halfExtents[1] === 0 && aabb.halfExtents[2] === 0;\n    }\n  }]);\n}();\n\nvar Plane = /*#__PURE__*/function () {\n  /**\n   * lookup table for p-vertex & n-vertex when doing frustum culling\n   */\n\n  function Plane(distance, normal) {\n    _classCallCheck(this, Plane);\n    this.distance = distance || 0;\n    this.normal = normal || vec3.fromValues(0, 1, 0);\n    this.updatePNVertexFlag();\n  }\n  return _createClass(Plane, [{\n    key: \"updatePNVertexFlag\",\n    value: function updatePNVertexFlag() {\n      this.pnVertexFlag = (Number(this.normal[0] >= 0) << 8) + (Number(this.normal[1] >= 0) << 4) + Number(this.normal[2] >= 0);\n    }\n  }, {\n    key: \"distanceToPoint\",\n    value: function distanceToPoint(point) {\n      return vec3.dot(point, this.normal) - this.distance;\n    }\n  }, {\n    key: \"normalize\",\n    value: function normalize() {\n      var invLen = 1 / vec3.len(this.normal);\n      vec3.scale(this.normal, this.normal, invLen);\n      this.distance *= invLen;\n    }\n  }, {\n    key: \"intersectsLine\",\n    value: function intersectsLine(start, end, point) {\n      var d0 = this.distanceToPoint(start);\n      var d1 = this.distanceToPoint(end);\n      var t = d0 / (d0 - d1);\n      var intersects = t >= 0 && t <= 1;\n      if (intersects && point) {\n        vec3.lerp(point, start, end, t);\n      }\n      return intersects;\n    }\n  }]);\n}();\n\nvar Mask = /*#__PURE__*/function (Mask) {\n  Mask[Mask[\"OUTSIDE\"] = 4294967295] = \"OUTSIDE\";\n  Mask[Mask[\"INSIDE\"] = 0] = \"INSIDE\";\n  Mask[Mask[\"INDETERMINATE\"] = 2147483647] = \"INDETERMINATE\";\n  return Mask;\n}({});\nvar Frustum = /*#__PURE__*/function () {\n  function Frustum(planes) {\n    _classCallCheck(this, Frustum);\n    this.planes = [];\n    if (planes) {\n      this.planes = planes;\n    } else {\n      for (var i = 0; i < 6; i++) {\n        this.planes.push(new Plane());\n      }\n    }\n  }\n\n  /**\n   * extract 6 planes from projectionMatrix\n   * @see http://www8.cs.umu.se/kurser/5DV051/HT12/lab/plane_extraction.pdf\n   */\n  return _createClass(Frustum, [{\n    key: \"extractFromVPMatrix\",\n    value: function extractFromVPMatrix(projectionMatrix) {\n      // @ts-ignore\n      var _projectionMatrix = _slicedToArray(projectionMatrix, 16),\n        m0 = _projectionMatrix[0],\n        m1 = _projectionMatrix[1],\n        m2 = _projectionMatrix[2],\n        m3 = _projectionMatrix[3],\n        m4 = _projectionMatrix[4],\n        m5 = _projectionMatrix[5],\n        m6 = _projectionMatrix[6],\n        m7 = _projectionMatrix[7],\n        m8 = _projectionMatrix[8],\n        m9 = _projectionMatrix[9],\n        m10 = _projectionMatrix[10],\n        m11 = _projectionMatrix[11],\n        m12 = _projectionMatrix[12],\n        m13 = _projectionMatrix[13],\n        m14 = _projectionMatrix[14],\n        m15 = _projectionMatrix[15];\n\n      // right\n      vec3.set(this.planes[0].normal, m3 - m0, m7 - m4, m11 - m8);\n      this.planes[0].distance = m15 - m12;\n\n      // left\n      vec3.set(this.planes[1].normal, m3 + m0, m7 + m4, m11 + m8);\n      this.planes[1].distance = m15 + m12;\n\n      // bottom\n      vec3.set(this.planes[2].normal, m3 + m1, m7 + m5, m11 + m9);\n      this.planes[2].distance = m15 + m13;\n\n      // top\n      vec3.set(this.planes[3].normal, m3 - m1, m7 - m5, m11 - m9);\n      this.planes[3].distance = m15 - m13;\n\n      // far\n      vec3.set(this.planes[4].normal, m3 - m2, m7 - m6, m11 - m10);\n      this.planes[4].distance = m15 - m14;\n\n      // near\n      vec3.set(this.planes[5].normal, m3 + m2, m7 + m6, m11 + m10);\n      this.planes[5].distance = m15 + m14;\n      this.planes.forEach(function (plane) {\n        plane.normalize();\n        plane.updatePNVertexFlag();\n      });\n    }\n  }]);\n}();\n\nvar Point = /*#__PURE__*/function () {\n  function Point() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    _classCallCheck(this, Point);\n    this.x = 0;\n    this.y = 0;\n    this.x = x;\n    this.y = y;\n  }\n  return _createClass(Point, [{\n    key: \"clone\",\n    value: function clone() {\n      return new Point(this.x, this.y);\n    }\n  }, {\n    key: \"copyFrom\",\n    value: function copyFrom(p) {\n      this.x = p.x;\n      this.y = p.y;\n    }\n  }]);\n}();\n\nvar Rectangle = /*#__PURE__*/function () {\n  function Rectangle(x, y, width, height) {\n    _classCallCheck(this, Rectangle);\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n    this.left = x;\n    this.right = x + width;\n    this.top = y;\n    this.bottom = y + height;\n  }\n  return _createClass(Rectangle, [{\n    key: \"toJSON\",\n    value: function toJSON() {}\n  }], [{\n    key: \"fromRect\",\n    value:\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMRect/fromRect_static\n     */\n    function fromRect(rect) {\n      return new Rectangle(rect.x, rect.y, rect.width, rect.height);\n    }\n\n    /**\n     * will return a new rect instance\n     */\n  }, {\n    key: \"applyTransform\",\n    value: function applyTransform(rect, matrix) {\n      var topLeft = vec4.fromValues(rect.x, rect.y, 0, 1);\n      var topRight = vec4.fromValues(rect.x + rect.width, rect.y, 0, 1);\n      var bottomLeft = vec4.fromValues(rect.x, rect.y + rect.height, 0, 1);\n      var bottomRight = vec4.fromValues(rect.x + rect.width, rect.y + rect.height, 0, 1);\n      var transformedTopLeft = vec4.create();\n      var transformedTopRight = vec4.create();\n      var transformedBottomLeft = vec4.create();\n      var transformedBottomRight = vec4.create();\n      vec4.transformMat4(transformedTopLeft, topLeft, matrix);\n      vec4.transformMat4(transformedTopRight, topRight, matrix);\n      vec4.transformMat4(transformedBottomLeft, bottomLeft, matrix);\n      vec4.transformMat4(transformedBottomRight, bottomRight, matrix);\n      var minX = Math.min(transformedTopLeft[0], transformedTopRight[0], transformedBottomLeft[0], transformedBottomRight[0]);\n      var minY = Math.min(transformedTopLeft[1], transformedTopRight[1], transformedBottomLeft[1], transformedBottomRight[1]);\n      var maxX = Math.max(transformedTopLeft[0], transformedTopRight[0], transformedBottomLeft[0], transformedBottomRight[0]);\n      var maxY = Math.max(transformedTopLeft[1], transformedTopRight[1], transformedBottomLeft[1], transformedBottomRight[1]);\n      return Rectangle.fromRect({\n        x: minX,\n        y: minY,\n        width: maxX - minX,\n        height: maxY - minY\n      });\n    }\n  }]);\n}();\n\nvar ERROR_MSG_METHOD_NOT_IMPLEMENTED = 'Method not implemented.';\nvar ERROR_MSG_USE_DOCUMENT_ELEMENT = 'Use document.documentElement instead.';\nvar ERROR_MSG_APPEND_DESTROYED_ELEMENT = 'Cannot append a destroyed element.';\n\nfunction getAngle(angle) {\n  if (angle === undefined) {\n    return 0;\n  }\n  if (angle > 360 || angle < -360) {\n    return angle % 360;\n  }\n  return angle;\n}\nvar $vec3$2 = vec3.create();\nfunction createVec3(x) {\n  var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var clone = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n  if (Array.isArray(x) && x.length === 3) {\n    return clone ? vec3.clone(x) : vec3.copy($vec3$2, x);\n  }\n  if (isNumber(x)) {\n    return clone ? vec3.fromValues(x, y, z) : vec3.set($vec3$2, x, y, z);\n  }\n  return clone ? vec3.fromValues(x[0], x[1] || y, x[2] || z) : vec3.set($vec3$2, x[0], x[1] || y, x[2] || z);\n}\nvar DEG_RAD = Math.PI / 180;\nfunction deg2rad(deg) {\n  return deg * DEG_RAD;\n}\nvar RAD_DEG = 180 / Math.PI;\nfunction rad2deg(rad) {\n  return rad * RAD_DEG;\n}\nvar GRAD_DEG = 0.9; // 360 / 400;\nfunction grad2deg(grads) {\n  grads %= 400;\n  if (grads < 0) {\n    grads += 400;\n  }\n  return grads * GRAD_DEG;\n}\nfunction deg2turn(deg) {\n  return deg / 360;\n}\nfunction turn2deg(turn) {\n  return 360 * turn;\n}\nvar HALF_PI = Math.PI / 2;\nfunction getEulerFromQuat(out, quat) {\n  var x = quat[0];\n  var y = quat[1];\n  var z = quat[2];\n  var w = quat[3];\n  var x2 = x * x;\n  var y2 = y * y;\n  var z2 = z * z;\n  var w2 = w * w;\n  var unit = x2 + y2 + z2 + w2;\n  var test = x * w - y * z;\n  if (test > 0.499995 * unit) {\n    // TODO: Use glmatrix.EPSILON\n    // singularity at the north pole\n    out[0] = HALF_PI;\n    out[1] = 2 * Math.atan2(y, x);\n    out[2] = 0;\n  } else if (test < -0.499995 * unit) {\n    // TODO: Use glmatrix.EPSILON\n    // singularity at the south pole\n    out[0] = -HALF_PI;\n    out[1] = 2 * Math.atan2(y, x);\n    out[2] = 0;\n  } else {\n    out[0] = Math.asin(2 * (x * z - w * y));\n    out[1] = Math.atan2(2 * (x * w + y * z), 1 - 2 * (z2 + w2));\n    out[2] = Math.atan2(2 * (x * y + z * w), 1 - 2 * (y2 + z2));\n  }\n  // TODO: Return them as degrees and not as radians\n  return out;\n}\nfunction getEulerFromMat4(out, m) {\n  var x;\n  var z;\n  var _mat4$getScaling = mat4.getScaling(vec3.create(), m),\n    _mat4$getScaling2 = _slicedToArray(_mat4$getScaling, 3),\n    sx = _mat4$getScaling2[0],\n    sy = _mat4$getScaling2[1],\n    sz = _mat4$getScaling2[2];\n  var y = Math.asin(-m[2] / sx);\n  if (y < HALF_PI) {\n    if (y > -HALF_PI) {\n      x = Math.atan2(m[6] / sy, m[10] / sz);\n      z = Math.atan2(m[1] / sx, m[0] / sx);\n    } else {\n      // Not a unique solution\n      z = 0;\n      x = -Math.atan2(m[4] / sy, m[5] / sy);\n    }\n  } else {\n    // Not a unique solution\n    z = 0;\n    x = Math.atan2(m[4] / sy, m[5] / sy);\n  }\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n\n/**\n * @see https://github.com/toji/gl-matrix/issues/329\n * @see https://doc.babylonjs.com/divingDeeper/mesh/transforms/center_origin/rotation_conventions\n */\nfunction getEuler(out, quat) {\n  if (quat.length === 16) {\n    return getEulerFromMat4(out, quat);\n  }\n  return getEulerFromQuat(out, quat);\n}\nfunction fromRotationTranslationScale(rotation, x, y, scaleX, scaleY) {\n  var cos = Math.cos(rotation);\n  var sin = Math.sin(rotation);\n  return mat3.fromValues(scaleX * cos, scaleY * sin, 0, -scaleX * sin, scaleY * cos, 0, x, y, 1);\n}\nfunction makePerspective(out, left, right, top, bottom, near, far) {\n  var zero = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : false;\n  var twoNear = 2 * near;\n  var rightMinusLeft = right - left;\n  var topMinusBottom = top - bottom;\n  var x = twoNear / rightMinusLeft;\n  var y = twoNear / topMinusBottom;\n  var a = (right + left) / rightMinusLeft;\n  var b = (top + bottom) / topMinusBottom;\n  var c;\n  var d;\n  var farMinusNear = far - near;\n  var farMulNear = far * near;\n  if (zero) {\n    c = -far / farMinusNear;\n    d = -farMulNear / farMinusNear;\n  } else {\n    c = -(far + near) / farMinusNear;\n    d = -2 * farMulNear / farMinusNear;\n  }\n  out[0] = x;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = y;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = a;\n  out[9] = b;\n  out[10] = c;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = d;\n  out[15] = 0;\n  return out;\n}\nfunction decompose(mat) {\n  var row0x = mat[0];\n  var row0y = mat[1];\n  var row1x = mat[3];\n  var row1y = mat[4];\n  // decompose 3x3 matrix\n  // @see https://www.w3.org/TR/css-transforms-1/#decomposing-a-2d-matrix\n  var scalingX = Math.sqrt(row0x * row0x + row0y * row0y);\n  var scalingY = Math.sqrt(row1x * row1x + row1y * row1y);\n\n  // If determinant is negative, one axis was flipped.\n  var determinant = row0x * row1y - row0y * row1x;\n  if (determinant < 0) {\n    // Flip axis with minimum unit vector dot product.\n    if (row0x < row1y) {\n      scalingX = -scalingX;\n    } else {\n      scalingY = -scalingY;\n    }\n  }\n\n  // Renormalize matrix to remove scale.\n  if (scalingX) {\n    var invScalingX = 1 / scalingX;\n    row0x *= invScalingX;\n    row0y *= invScalingX;\n  }\n  if (scalingY) {\n    var invScalingY = 1 / scalingY;\n    row1x *= invScalingY;\n    row1y *= invScalingY;\n  }\n\n  // Compute rotation and renormalize matrix.\n  var rotation = Math.atan2(row0y, row0x);\n  var angle = rad2deg(rotation);\n  return [mat[6], mat[7], scalingX, scalingY, angle];\n}\nvar tmp = mat4.create();\nvar perspectiveMatrix = mat4.create();\nvar tmpVec4 = vec4.create();\nvar row = [vec3.create(), vec3.create(), vec3.create()];\nvar pdum3 = vec3.create();\n\n/*\nInput:  matrix      ; a 4x4 matrix\nOutput: translation ; a 3 component vector\n        scale       ; a 3 component vector\n        skew        ; skew factors XY,XZ,YZ represented as a 3 component vector\n        perspective ; a 4 component vector\n        quaternion  ; a 4 component vector\nReturns false if the matrix cannot be decomposed, true if it can\n\n\nReferences:\nhttps://github.com/kamicane/matrix3d/blob/master/lib/Matrix3d.js\nhttps://github.com/ChromiumWebApps/chromium/blob/master/ui/gfx/transform_util.cc\nhttp://www.w3.org/TR/css3-transforms/#decomposing-a-3d-matrix\n*/\nfunction decomposeMat4(matrix, translation, scale, skew, perspective, quaternion) {\n  // normalize, if not possible then bail out early\n  if (!normalize(tmp, matrix)) return false;\n\n  // perspectiveMatrix is used to solve for perspective, but it also provides\n  // an easy way to test for singularity of the upper 3x3 component.\n  mat4.copy(perspectiveMatrix, tmp);\n  perspectiveMatrix[3] = 0;\n  perspectiveMatrix[7] = 0;\n  perspectiveMatrix[11] = 0;\n  perspectiveMatrix[15] = 1;\n\n  // If the perspectiveMatrix is not invertible, we are also unable to\n  // decompose, so we'll bail early. Constant taken from SkMatrix44::invert.\n  if (Math.abs(mat4.determinant(perspectiveMatrix)) < 1e-8) return false;\n  var a03 = tmp[3];\n  var a13 = tmp[7];\n  var a23 = tmp[11];\n  var a30 = tmp[12];\n  var a31 = tmp[13];\n  var a32 = tmp[14];\n  var a33 = tmp[15];\n\n  // First, isolate perspective.\n  if (a03 !== 0 || a13 !== 0 || a23 !== 0) {\n    tmpVec4[0] = a03;\n    tmpVec4[1] = a13;\n    tmpVec4[2] = a23;\n    tmpVec4[3] = a33;\n\n    // Solve the equation by inverting perspectiveMatrix and multiplying\n    // rightHandSide by the inverse.\n    // resuing the perspectiveMatrix here since it's no longer needed\n    var ret = mat4.invert(perspectiveMatrix, perspectiveMatrix);\n    if (!ret) return false;\n    mat4.transpose(perspectiveMatrix, perspectiveMatrix);\n\n    // multiply by transposed inverse perspective matrix, into perspective vec4\n    vec4.transformMat4(perspective, tmpVec4, perspectiveMatrix);\n  } else {\n    // no perspective\n    perspective[0] = perspective[1] = perspective[2] = 0;\n    perspective[3] = 1;\n  }\n\n  // Next take care of translation\n  translation[0] = a30;\n  translation[1] = a31;\n  translation[2] = a32;\n\n  // Now get scale and shear. 'row' is a 3 element array of 3 component vectors\n  mat3from4(row, tmp);\n\n  // Compute X scale factor and normalize first row.\n  scale[0] = vec3.length(row[0]);\n  vec3.normalize(row[0], row[0]);\n\n  // Compute XY shear factor and make 2nd row orthogonal to 1st.\n  skew[0] = vec3.dot(row[0], row[1]);\n  combine(row[1], row[1], row[0], 1.0, -skew[0]);\n\n  // Now, compute Y scale and normalize 2nd row.\n  scale[1] = vec3.length(row[1]);\n  vec3.normalize(row[1], row[1]);\n  skew[0] /= scale[1];\n\n  // Compute XZ and YZ shears, orthogonalize 3rd row\n  skew[1] = vec3.dot(row[0], row[2]);\n  combine(row[2], row[2], row[0], 1.0, -skew[1]);\n  skew[2] = vec3.dot(row[1], row[2]);\n  combine(row[2], row[2], row[1], 1.0, -skew[2]);\n\n  // Next, get Z scale and normalize 3rd row.\n  scale[2] = vec3.length(row[2]);\n  vec3.normalize(row[2], row[2]);\n  skew[1] /= scale[2];\n  skew[2] /= scale[2];\n\n  // At this point, the matrix (in rows) is orthonormal.\n  // Check for a coordinate system flip.  If the determinant\n  // is -1, then negate the matrix and the scaling factors.\n  vec3.cross(pdum3, row[1], row[2]);\n  if (vec3.dot(row[0], pdum3) < 0) {\n    for (var i = 0; i < 3; i++) {\n      scale[i] *= -1;\n      row[i][0] *= -1;\n      row[i][1] *= -1;\n      row[i][2] *= -1;\n    }\n  }\n\n  // Now, get the rotations out\n  quaternion[0] = 0.5 * Math.sqrt(Math.max(1 + row[0][0] - row[1][1] - row[2][2], 0));\n  quaternion[1] = 0.5 * Math.sqrt(Math.max(1 - row[0][0] + row[1][1] - row[2][2], 0));\n  quaternion[2] = 0.5 * Math.sqrt(Math.max(1 - row[0][0] - row[1][1] + row[2][2], 0));\n  quaternion[3] = 0.5 * Math.sqrt(Math.max(1 + row[0][0] + row[1][1] + row[2][2], 0));\n  if (row[2][1] > row[1][2]) quaternion[0] = -quaternion[0];\n  if (row[0][2] > row[2][0]) quaternion[1] = -quaternion[1];\n  if (row[1][0] > row[0][1]) quaternion[2] = -quaternion[2];\n  return true;\n}\nfunction normalize(out, mat) {\n  var m44 = mat[15];\n  // Cannot normalize.\n  if (m44 === 0) return false;\n  var scale = 1 / m44;\n  for (var i = 0; i < 16; i++) out[i] = mat[i] * scale;\n  return true;\n}\n\n// gets upper-left of a 4x4 matrix into a 3x3 of vectors\nfunction mat3from4(out, mat4x4) {\n  out[0][0] = mat4x4[0];\n  out[0][1] = mat4x4[1];\n  out[0][2] = mat4x4[2];\n  out[1][0] = mat4x4[4];\n  out[1][1] = mat4x4[5];\n  out[1][2] = mat4x4[6];\n  out[2][0] = mat4x4[8];\n  out[2][1] = mat4x4[9];\n  out[2][2] = mat4x4[10];\n}\nfunction combine(out, a, b, scale1, scale2) {\n  out[0] = a[0] * scale1 + b[0] * scale2;\n  out[1] = a[1] * scale1 + b[1] * scale2;\n  out[2] = a[2] * scale1 + b[2] * scale2;\n}\n\n/**\n * Different type of cameras, eg. simple camera used in 2D scene or\n * advanced camera which can do actions & switch between landmarks.\n */\n\nvar CameraType = /*#__PURE__*/function (CameraType) {\n  CameraType[CameraType[\"ORBITING\"] = 0] = \"ORBITING\";\n  CameraType[CameraType[\"EXPLORING\"] = 1] = \"EXPLORING\";\n  CameraType[CameraType[\"TRACKING\"] = 2] = \"TRACKING\";\n  return CameraType;\n}({});\n\n/**\n * CameraType must be TRACKING\n */\nvar CameraTrackingMode = /*#__PURE__*/function (CameraTrackingMode) {\n  CameraTrackingMode[CameraTrackingMode[\"DEFAULT\"] = 0] = \"DEFAULT\";\n  CameraTrackingMode[CameraTrackingMode[\"ROTATIONAL\"] = 1] = \"ROTATIONAL\";\n  CameraTrackingMode[CameraTrackingMode[\"TRANSLATIONAL\"] = 2] = \"TRANSLATIONAL\";\n  CameraTrackingMode[CameraTrackingMode[\"CINEMATIC\"] = 3] = \"CINEMATIC\";\n  return CameraTrackingMode;\n}({});\nvar CameraProjectionMode = /*#__PURE__*/function (CameraProjectionMode) {\n  CameraProjectionMode[CameraProjectionMode[\"ORTHOGRAPHIC\"] = 0] = \"ORTHOGRAPHIC\";\n  CameraProjectionMode[CameraProjectionMode[\"PERSPECTIVE\"] = 1] = \"PERSPECTIVE\";\n  return CameraProjectionMode;\n}({});\nvar CameraEvent = {\n  UPDATED: 'updated'\n};\n\nvar MIN_DISTANCE = 0.0002;\n\n/**\n * 参考「WebGL Insights - 23.Designing Cameras for WebGL Applications」，基于 Responsible Camera 思路设计\n * @see https://github.com/d13g0/nucleo.js/blob/master/source/camera/Camera.js\n *\n * 保存相机参数，定义相机动作：\n * 1. dolly 沿 n 轴移动\n * 2. pan 沿 u v 轴移动\n * 3. rotate 以方位角旋转\n * 4. 移动到 Landmark，具有平滑的动画效果，其间禁止其他用户交互\n */\n\nvar Camera = /*#__PURE__*/function () {\n  function Camera() {\n    _classCallCheck(this, Camera);\n    /**\n     * Clip space near Z, default to range `[-1, 1]`\n     */\n    this.clipSpaceNearZ = ClipSpaceNearZ.NEGATIVE_ONE;\n    this.eventEmitter = new EventEmitter();\n    /**\n     * Matrix of camera\n     */\n    this.matrix = mat4.create();\n    /**\n     * u axis +X is right\n     * @see http://learnwebgl.brown37.net/07_cameras/camera_introduction.html#a-camera-definition\n     */\n    this.right = vec3.fromValues(1, 0, 0);\n    /**\n     * v axis +Y is up\n     */\n    this.up = vec3.fromValues(0, 1, 0);\n    /**\n     * n axis +Z is inside\n     */\n    this.forward = vec3.fromValues(0, 0, 1);\n    /**\n     * Position of camera.\n     */\n    this.position = vec3.fromValues(0, 0, 1);\n    /**\n     * Position of focal point.\n     */\n    this.focalPoint = vec3.fromValues(0, 0, 0);\n    /**\n     * vector from focalPoint to position\n     */\n    this.distanceVector = vec3.fromValues(0, 0, -1);\n    /**\n     * length(focalPoint - position)\n     */\n    this.distance = 1;\n    /**\n     * @see https://en.wikipedia.org/wiki/Azimuth\n     */\n    this.azimuth = 0;\n    this.elevation = 0;\n    this.roll = 0;\n    this.relAzimuth = 0;\n    this.relElevation = 0;\n    this.relRoll = 0;\n    /**\n     * 沿 n 轴移动时，保证移动速度从快到慢\n     */\n    this.dollyingStep = 0;\n    this.maxDistance = Infinity;\n    this.minDistance = -Infinity;\n    /**\n     * zoom factor of the camera, default is 1\n     * eg. https://threejs.org/docs/#api/en/cameras/OrthographicCamera.zoom\n     */\n    this.zoom = 1;\n    /**\n     * invert the horizontal coordinate system HCS\n     */\n    this.rotateWorld = false;\n    /**\n     * 投影矩阵参数\n     */\n    /**\n     * field of view [0-360]\n     * @see http://en.wikipedia.org/wiki/Angle_of_view\n     */\n    this.fov = 30;\n    this.near = 0.1;\n    this.far = 1000;\n    this.aspect = 1;\n    this.projectionMatrix = mat4.create();\n    this.projectionMatrixInverse = mat4.create();\n    this.jitteredProjectionMatrix = undefined;\n    this.enableUpdate = true;\n    // protected following = undefined;\n    this.type = CameraType.EXPLORING;\n    this.trackingMode = CameraTrackingMode.DEFAULT;\n    this.projectionMode = CameraProjectionMode.PERSPECTIVE;\n    /**\n     * for culling use\n     */\n    this.frustum = new Frustum();\n    /**\n     * ortho matrix for Canvas2D & SVG\n     */\n    this.orthoMatrix = mat4.create();\n  }\n  return _createClass(Camera, [{\n    key: \"isOrtho\",\n    value:\n    // constructor(type = CameraType.EXPLORING, trackingMode = CameraTrackingMode.DEFAULT) {\n    //   this.setType(type, trackingMode);\n    // }\n\n    function isOrtho() {\n      return this.projectionMode === CameraProjectionMode.ORTHOGRAPHIC;\n    }\n  }, {\n    key: \"getProjectionMode\",\n    value: function getProjectionMode() {\n      return this.projectionMode;\n    }\n  }, {\n    key: \"getPerspective\",\n    value: function getPerspective() {\n      // account for TAA\n      return this.jitteredProjectionMatrix || this.projectionMatrix;\n    }\n  }, {\n    key: \"getPerspectiveInverse\",\n    value: function getPerspectiveInverse() {\n      return this.projectionMatrixInverse;\n    }\n  }, {\n    key: \"getFrustum\",\n    value: function getFrustum() {\n      return this.frustum;\n    }\n  }, {\n    key: \"getPosition\",\n    value: function getPosition() {\n      return this.position;\n    }\n  }, {\n    key: \"getFocalPoint\",\n    value: function getFocalPoint() {\n      return this.focalPoint;\n    }\n  }, {\n    key: \"getDollyingStep\",\n    value: function getDollyingStep() {\n      return this.dollyingStep;\n    }\n  }, {\n    key: \"getNear\",\n    value: function getNear() {\n      return this.near;\n    }\n  }, {\n    key: \"getFar\",\n    value: function getFar() {\n      return this.far;\n    }\n  }, {\n    key: \"getZoom\",\n    value: function getZoom() {\n      return this.zoom;\n    }\n  }, {\n    key: \"getOrthoMatrix\",\n    value: function getOrthoMatrix() {\n      return this.orthoMatrix;\n    }\n  }, {\n    key: \"getView\",\n    value: function getView() {\n      return this.view;\n    }\n  }, {\n    key: \"setEnableUpdate\",\n    value: function setEnableUpdate(enabled) {\n      this.enableUpdate = enabled;\n    }\n  }, {\n    key: \"setType\",\n    value: function setType(type, trackingMode) {\n      this.type = type;\n      if (this.type === CameraType.EXPLORING) {\n        this.setWorldRotation(true);\n      } else {\n        this.setWorldRotation(false);\n      }\n      this._getAngles();\n      if (this.type === CameraType.TRACKING && trackingMode !== undefined) {\n        this.setTrackingMode(trackingMode);\n      }\n      return this;\n    }\n  }, {\n    key: \"setProjectionMode\",\n    value: function setProjectionMode(projectionMode) {\n      this.projectionMode = projectionMode;\n      return this;\n    }\n  }, {\n    key: \"setTrackingMode\",\n    value: function setTrackingMode(trackingMode) {\n      if (this.type !== CameraType.TRACKING) {\n        throw new Error('Impossible to set a tracking mode if the camera is not of tracking type');\n      }\n      this.trackingMode = trackingMode;\n      return this;\n    }\n\n    /**\n     * If flag is true, it reverses the azimuth and elevation angles.\n     * Subsequent calls to rotate, setAzimuth, setElevation,\n     * changeAzimuth or changeElevation will cause the inverted effect.\n     * setRoll or changeRoll is not affected by this method.\n     *\n     * This inversion is useful when one wants to simulate that the world\n     * is moving, instead of the camera.\n     *\n     * By default the camera angles are not reversed.\n     * @param {Boolean} flag the boolean flag to reverse the angles.\n     */\n  }, {\n    key: \"setWorldRotation\",\n    value: function setWorldRotation(flag) {\n      this.rotateWorld = flag;\n      this._getAngles();\n      return this;\n    }\n\n    /**\n     * 计算 MV 矩阵，为相机矩阵的逆矩阵\n     */\n  }, {\n    key: \"getViewTransform\",\n    value: function getViewTransform() {\n      // mat4.scale(this.matrix, this.matrix, vec3.fromValues(1, -1, 1));\n\n      return mat4.invert(mat4.create(), this.matrix);\n    }\n  }, {\n    key: \"getWorldTransform\",\n    value: function getWorldTransform() {\n      return this.matrix;\n    }\n  }, {\n    key: \"jitterProjectionMatrix\",\n    value: function jitterProjectionMatrix(x, y) {\n      var translation = mat4.fromTranslation(mat4.create(), [x, y, 0]);\n      this.jitteredProjectionMatrix = mat4.multiply(mat4.create(), translation, this.projectionMatrix);\n    }\n  }, {\n    key: \"clearJitterProjectionMatrix\",\n    value: function clearJitterProjectionMatrix() {\n      this.jitteredProjectionMatrix = undefined;\n    }\n\n    /**\n     * 设置相机矩阵\n     */\n  }, {\n    key: \"setMatrix\",\n    value: function setMatrix(matrix) {\n      this.matrix = matrix;\n      this._update();\n      return this;\n    }\n\n    /**\n     * Set projection matrix manually.\n     */\n  }, {\n    key: \"setProjectionMatrix\",\n    value: function setProjectionMatrix(matrix) {\n      this.projectionMatrix = matrix;\n    }\n  }, {\n    key: \"setFov\",\n    value: function setFov(fov) {\n      this.setPerspective(this.near, this.far, fov, this.aspect);\n      return this;\n    }\n  }, {\n    key: \"setAspect\",\n    value: function setAspect(aspect) {\n      this.setPerspective(this.near, this.far, this.fov, aspect);\n      return this;\n    }\n  }, {\n    key: \"setNear\",\n    value: function setNear(near) {\n      if (this.projectionMode === CameraProjectionMode.PERSPECTIVE) {\n        this.setPerspective(near, this.far, this.fov, this.aspect);\n      } else {\n        this.setOrthographic(this.left, this.rright, this.top, this.bottom, near, this.far);\n      }\n      return this;\n    }\n  }, {\n    key: \"setFar\",\n    value: function setFar(far) {\n      if (this.projectionMode === CameraProjectionMode.PERSPECTIVE) {\n        this.setPerspective(this.near, far, this.fov, this.aspect);\n      } else {\n        this.setOrthographic(this.left, this.rright, this.top, this.bottom, this.near, far);\n      }\n      return this;\n    }\n\n    /**\n     * Sets an offset in a larger frustum, used in PixelPicking\n     */\n  }, {\n    key: \"setViewOffset\",\n    value: function setViewOffset(fullWidth, fullHeight, x, y, width, height) {\n      this.aspect = fullWidth / fullHeight;\n      if (this.view === undefined) {\n        this.view = {\n          enabled: true,\n          fullWidth: 1,\n          fullHeight: 1,\n          offsetX: 0,\n          offsetY: 0,\n          width: 1,\n          height: 1\n        };\n      }\n      this.view.enabled = true;\n      this.view.fullWidth = fullWidth;\n      this.view.fullHeight = fullHeight;\n      this.view.offsetX = x;\n      this.view.offsetY = y;\n      this.view.width = width;\n      this.view.height = height;\n      if (this.projectionMode === CameraProjectionMode.PERSPECTIVE) {\n        this.setPerspective(this.near, this.far, this.fov, this.aspect);\n      } else {\n        this.setOrthographic(this.left, this.rright, this.top, this.bottom, this.near, this.far);\n      }\n      return this;\n    }\n  }, {\n    key: \"clearViewOffset\",\n    value: function clearViewOffset() {\n      if (this.view !== undefined) {\n        this.view.enabled = false;\n      }\n      if (this.projectionMode === CameraProjectionMode.PERSPECTIVE) {\n        this.setPerspective(this.near, this.far, this.fov, this.aspect);\n      } else {\n        this.setOrthographic(this.left, this.rright, this.top, this.bottom, this.near, this.far);\n      }\n      return this;\n    }\n  }, {\n    key: \"setZoom\",\n    value: function setZoom(zoom) {\n      this.zoom = zoom;\n      if (this.projectionMode === CameraProjectionMode.ORTHOGRAPHIC) {\n        this.setOrthographic(this.left, this.rright, this.top, this.bottom, this.near, this.far);\n      } else if (this.projectionMode === CameraProjectionMode.PERSPECTIVE) {\n        this.setPerspective(this.near, this.far, this.fov, this.aspect);\n      }\n      return this;\n    }\n\n    /**\n     * Zoom by specified point in viewport coordinates.\n     */\n  }, {\n    key: \"setZoomByViewportPoint\",\n    value: function setZoomByViewportPoint(zoom, viewportPoint) {\n      var _this$canvas$viewport = this.canvas.viewport2Canvas({\n          x: viewportPoint[0],\n          y: viewportPoint[1]\n        }),\n        ox = _this$canvas$viewport.x,\n        oy = _this$canvas$viewport.y;\n      var roll = this.roll;\n      this.rotate(0, 0, -roll);\n      this.setPosition(ox, oy);\n      this.setFocalPoint(ox, oy);\n      this.setZoom(zoom);\n      this.rotate(0, 0, roll);\n      var _this$canvas$viewport2 = this.canvas.viewport2Canvas({\n          x: viewportPoint[0],\n          y: viewportPoint[1]\n        }),\n        cx = _this$canvas$viewport2.x,\n        cy = _this$canvas$viewport2.y;\n\n      // project to rotated axis\n      var dvec = vec3.fromValues(cx - ox, cy - oy, 0);\n      var dx = vec3.dot(dvec, this.right) / vec3.length(this.right);\n      var dy = vec3.dot(dvec, this.up) / vec3.length(this.up);\n      var _this$getPosition = this.getPosition(),\n        _this$getPosition2 = _slicedToArray(_this$getPosition, 2),\n        px = _this$getPosition2[0],\n        py = _this$getPosition2[1];\n      var _this$getFocalPoint = this.getFocalPoint(),\n        _this$getFocalPoint2 = _slicedToArray(_this$getFocalPoint, 2),\n        fx = _this$getFocalPoint2[0],\n        fy = _this$getFocalPoint2[1];\n      this.setPosition(px - dx, py - dy);\n      this.setFocalPoint(fx - dx, fy - dy);\n      return this;\n    }\n  }, {\n    key: \"setPerspective\",\n    value: function setPerspective(near, far, fov, aspect) {\n      var _this$view;\n      this.projectionMode = CameraProjectionMode.PERSPECTIVE;\n      this.fov = fov;\n      this.near = near;\n      this.far = far;\n      this.aspect = aspect;\n      var top = this.near * Math.tan(deg2rad(0.5 * this.fov)) / this.zoom;\n      var height = 2 * top;\n      var width = this.aspect * height;\n      var left = -0.5 * width;\n      if ((_this$view = this.view) !== null && _this$view !== void 0 && _this$view.enabled) {\n        var fullWidth = this.view.fullWidth;\n        var fullHeight = this.view.fullHeight;\n        left += this.view.offsetX * width / fullWidth;\n        top -= this.view.offsetY * height / fullHeight;\n        width *= this.view.width / fullWidth;\n        height *= this.view.height / fullHeight;\n      }\n      makePerspective(this.projectionMatrix, left, left + width, top - height, top, near, this.far, this.clipSpaceNearZ === ClipSpaceNearZ.ZERO);\n      mat4.invert(this.projectionMatrixInverse, this.projectionMatrix);\n      this.triggerUpdate();\n      return this;\n    }\n  }, {\n    key: \"setOrthographic\",\n    value: function setOrthographic(l, r, t, b, near, far) {\n      var _this$view2;\n      this.projectionMode = CameraProjectionMode.ORTHOGRAPHIC;\n      this.rright = r;\n      this.left = l;\n      this.top = t;\n      this.bottom = b;\n      this.near = near;\n      this.far = far;\n      var dx = (this.rright - this.left) / (2 * this.zoom);\n      var dy = (this.top - this.bottom) / (2 * this.zoom);\n      var cx = (this.rright + this.left) / 2;\n      var cy = (this.top + this.bottom) / 2;\n      var left = cx - dx;\n      var right = cx + dx;\n      var top = cy + dy;\n      var bottom = cy - dy;\n      if ((_this$view2 = this.view) !== null && _this$view2 !== void 0 && _this$view2.enabled) {\n        var scaleW = (this.rright - this.left) / this.view.fullWidth / this.zoom;\n        var scaleH = (this.top - this.bottom) / this.view.fullHeight / this.zoom;\n        left += scaleW * this.view.offsetX;\n        right = left + scaleW * this.view.width;\n        top -= scaleH * this.view.offsetY;\n        bottom = top - scaleH * this.view.height;\n      }\n      if (this.clipSpaceNearZ === ClipSpaceNearZ.NEGATIVE_ONE) {\n        // FlipY with switching bottom & top.\n        // @see https://stackoverflow.com/a/4886656\n        mat4.ortho(this.projectionMatrix, left, right, top, bottom, near, far);\n      } else {\n        mat4.orthoZO(this.projectionMatrix, left, right, top, bottom, near, far);\n      }\n      mat4.invert(this.projectionMatrixInverse, this.projectionMatrix);\n      this._getOrthoMatrix();\n      this.triggerUpdate();\n      return this;\n    }\n\n    /**\n     * Move the camera in world coordinates.\n     * It will keep looking at the current focal point.\n     *\n     * support scalars or vectors.\n     * @example\n     * setPosition(1, 2, 3);\n     * setPosition([1, 2, 3]);\n     */\n  }, {\n    key: \"setPosition\",\n    value: function setPosition(x) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.position[1];\n      var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.position[2];\n      var position = createVec3(x, y, z);\n      this._setPosition(position);\n      this.setFocalPoint(this.focalPoint);\n      this.triggerUpdate();\n      return this;\n    }\n\n    /**\n     * Sets the focal point of this camera in world coordinates.\n     *\n     * support scalars or vectors.\n     * @example\n     * setFocalPoint(1, 2, 3);\n     * setFocalPoint([1, 2, 3]);\n     */\n  }, {\n    key: \"setFocalPoint\",\n    value: function setFocalPoint(x) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.focalPoint[1];\n      var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.focalPoint[2];\n      var up = vec3.fromValues(0, 1, 0);\n      this.focalPoint = createVec3(x, y, z);\n      if (this.trackingMode === CameraTrackingMode.CINEMATIC) {\n        var d = vec3.subtract(vec3.create(), this.focalPoint, this.position);\n        x = d[0];\n        y = d[1];\n        z = d[2];\n        var r = vec3.length(d);\n        var el = rad2deg(Math.asin(y / r));\n        var az = 90 + rad2deg(Math.atan2(z, x));\n        var m = mat4.create();\n        mat4.rotateY(m, m, deg2rad(az));\n        mat4.rotateX(m, m, deg2rad(el));\n        up = vec3.transformMat4(vec3.create(), [0, 1, 0], m);\n      }\n      mat4.invert(this.matrix, mat4.lookAt(mat4.create(), this.position, this.focalPoint, up));\n      this._getAxes();\n      this._getDistance();\n      this._getAngles();\n      this.triggerUpdate();\n      return this;\n    }\n  }, {\n    key: \"getDistance\",\n    value: function getDistance() {\n      return this.distance;\n    }\n  }, {\n    key: \"getDistanceVector\",\n    value: function getDistanceVector() {\n      return this.distanceVector;\n    }\n\n    /**\n     * Moves the camera towards/from the focal point.\n     */\n  }, {\n    key: \"setDistance\",\n    value: function setDistance(d) {\n      if (this.distance === d || d < 0) {\n        return this;\n      }\n      this.distance = d;\n      if (this.distance < MIN_DISTANCE) {\n        this.distance = MIN_DISTANCE;\n      }\n      this.dollyingStep = this.distance / 100;\n      var pos = vec3.create();\n      d = this.distance;\n      var n = this.forward;\n      var f = this.focalPoint;\n      pos[0] = d * n[0] + f[0];\n      pos[1] = d * n[1] + f[1];\n      pos[2] = d * n[2] + f[2];\n      this._setPosition(pos);\n      this.triggerUpdate();\n      return this;\n    }\n  }, {\n    key: \"setMaxDistance\",\n    value: function setMaxDistance(d) {\n      this.maxDistance = d;\n      return this;\n    }\n  }, {\n    key: \"setMinDistance\",\n    value: function setMinDistance(d) {\n      this.minDistance = d;\n      return this;\n    }\n\n    /**\n     * 设置相机方位角，不同相机模式下需要重新计算相机位置或者是视点位置\n     * the azimuth in degrees\n     */\n  }, {\n    key: \"setAzimuth\",\n    value: function setAzimuth(az) {\n      this.azimuth = getAngle(az);\n      this.computeMatrix();\n      this._getAxes();\n      if (this.type === CameraType.ORBITING || this.type === CameraType.EXPLORING) {\n        this._getPosition();\n      } else if (this.type === CameraType.TRACKING) {\n        this._getFocalPoint();\n      }\n      this.triggerUpdate();\n      return this;\n    }\n  }, {\n    key: \"getAzimuth\",\n    value: function getAzimuth() {\n      return this.azimuth;\n    }\n\n    /**\n     * 设置相机方位角，不同相机模式下需要重新计算相机位置或者是视点位置\n     */\n  }, {\n    key: \"setElevation\",\n    value: function setElevation(el) {\n      this.elevation = getAngle(el);\n      this.computeMatrix();\n      this._getAxes();\n      if (this.type === CameraType.ORBITING || this.type === CameraType.EXPLORING) {\n        this._getPosition();\n      } else if (this.type === CameraType.TRACKING) {\n        this._getFocalPoint();\n      }\n      this.triggerUpdate();\n      return this;\n    }\n  }, {\n    key: \"getElevation\",\n    value: function getElevation() {\n      return this.elevation;\n    }\n\n    /**\n     * 设置相机方位角，不同相机模式下需要重新计算相机位置或者是视点位置\n     */\n  }, {\n    key: \"setRoll\",\n    value: function setRoll(angle) {\n      this.roll = getAngle(angle);\n      this.computeMatrix();\n      this._getAxes();\n      if (this.type === CameraType.ORBITING || this.type === CameraType.EXPLORING) {\n        this._getPosition();\n      } else if (this.type === CameraType.TRACKING) {\n        this._getFocalPoint();\n      }\n      this.triggerUpdate();\n      return this;\n    }\n  }, {\n    key: \"getRoll\",\n    value: function getRoll() {\n      return this.roll;\n    }\n\n    /**\n     * 根据相机矩阵重新计算各种相机参数\n     */\n  }, {\n    key: \"_update\",\n    value: function _update() {\n      this._getAxes();\n      this._getPosition();\n      this._getDistance();\n      this._getAngles();\n      this._getOrthoMatrix();\n      this.triggerUpdate();\n    }\n\n    /**\n     * 计算相机矩阵\n     */\n  }, {\n    key: \"computeMatrix\",\n    value: function computeMatrix() {\n      // 使用四元数描述 3D 旋转\n      // @see https://xiaoiver.github.io/coding/2018/12/28/Camera-%E8%AE%BE%E8%AE%A1-%E4%B8%80.html\n      var rotZ = quat$1.setAxisAngle(quat$1.create(), [0, 0, 1], deg2rad(this.roll));\n      mat4.identity(this.matrix);\n\n      // only consider HCS for EXPLORING and ORBITING cameras\n      var rotX = quat$1.setAxisAngle(quat$1.create(), [1, 0, 0], deg2rad((this.rotateWorld && this.type !== CameraType.TRACKING || this.type === CameraType.TRACKING ? 1 : -1) * this.elevation));\n      var rotY = quat$1.setAxisAngle(quat$1.create(), [0, 1, 0], deg2rad((this.rotateWorld && this.type !== CameraType.TRACKING || this.type === CameraType.TRACKING ? 1 : -1) * this.azimuth));\n      var rotQ = quat$1.multiply(quat$1.create(), rotY, rotX);\n      rotQ = quat$1.multiply(quat$1.create(), rotQ, rotZ);\n      var rotMatrix = mat4.fromQuat(mat4.create(), rotQ);\n      if (this.type === CameraType.ORBITING || this.type === CameraType.EXPLORING) {\n        mat4.translate(this.matrix, this.matrix, this.focalPoint);\n        mat4.multiply(this.matrix, this.matrix, rotMatrix);\n        mat4.translate(this.matrix, this.matrix, [0, 0, this.distance]);\n      } else if (this.type === CameraType.TRACKING) {\n        mat4.translate(this.matrix, this.matrix, this.position);\n        mat4.multiply(this.matrix, this.matrix, rotMatrix);\n      }\n    }\n\n    /**\n     * Sets the camera position in the camera matrix\n     */\n  }, {\n    key: \"_setPosition\",\n    value: function _setPosition(x, y, z) {\n      this.position = createVec3(x, y, z);\n      var m = this.matrix;\n      m[12] = this.position[0];\n      m[13] = this.position[1];\n      m[14] = this.position[2];\n      m[15] = 1;\n      this._getOrthoMatrix();\n    }\n\n    /**\n     * Recalculates axes based on the current matrix\n     */\n  }, {\n    key: \"_getAxes\",\n    value: function _getAxes() {\n      vec3.copy(this.right, createVec3(vec4.transformMat4(vec4.create(), [1, 0, 0, 0], this.matrix)));\n      vec3.copy(this.up, createVec3(vec4.transformMat4(vec4.create(), [0, 1, 0, 0], this.matrix)));\n      vec3.copy(this.forward, createVec3(vec4.transformMat4(vec4.create(), [0, 0, 1, 0], this.matrix)));\n      vec3.normalize(this.right, this.right);\n      vec3.normalize(this.up, this.up);\n      vec3.normalize(this.forward, this.forward);\n    }\n\n    /**\n     * Recalculates euler angles based on the current state\n     */\n  }, {\n    key: \"_getAngles\",\n    value: function _getAngles() {\n      // Recalculates angles\n      var x = this.distanceVector[0];\n      var y = this.distanceVector[1];\n      var z = this.distanceVector[2];\n      var r = vec3.length(this.distanceVector);\n\n      // FAST FAIL: If there is no distance we cannot compute angles\n      if (r === 0) {\n        this.elevation = 0;\n        this.azimuth = 0;\n        return;\n      }\n      if (this.type === CameraType.TRACKING) {\n        this.elevation = rad2deg(Math.asin(y / r));\n        this.azimuth = rad2deg(Math.atan2(-x, -z));\n      } else if (this.rotateWorld) {\n        this.elevation = rad2deg(Math.asin(y / r));\n        this.azimuth = rad2deg(Math.atan2(-x, -z));\n      } else {\n        this.elevation = -rad2deg(Math.asin(y / r));\n        this.azimuth = -rad2deg(Math.atan2(-x, -z));\n      }\n    }\n\n    /**\n     * 重新计算相机位置，只有 ORBITING 模式相机位置才会发生变化\n     */\n  }, {\n    key: \"_getPosition\",\n    value: function _getPosition() {\n      vec3.copy(this.position, createVec3(vec4.transformMat4(vec4.create(), [0, 0, 0, 1], this.matrix)));\n\n      // 相机位置变化，需要重新计算视距\n      this._getDistance();\n    }\n\n    /**\n     * 重新计算视点，只有 TRACKING 模式视点才会发生变化\n     */\n  }, {\n    key: \"_getFocalPoint\",\n    value: function _getFocalPoint() {\n      vec3.transformMat3(this.distanceVector, [0, 0, -this.distance], mat3.fromMat4(mat3.create(), this.matrix));\n      vec3.add(this.focalPoint, this.position, this.distanceVector);\n\n      // 视点变化，需要重新计算视距\n      this._getDistance();\n    }\n\n    /**\n     * 重新计算视距\n     */\n  }, {\n    key: \"_getDistance\",\n    value: function _getDistance() {\n      this.distanceVector = vec3.subtract(vec3.create(), this.focalPoint, this.position);\n      this.distance = vec3.length(this.distanceVector);\n      this.dollyingStep = this.distance / 100;\n    }\n  }, {\n    key: \"_getOrthoMatrix\",\n    value: function _getOrthoMatrix() {\n      if (this.projectionMode !== CameraProjectionMode.ORTHOGRAPHIC) {\n        return;\n      }\n      var position = this.position;\n      var rotZ = quat$1.setAxisAngle(quat$1.create(), [0, 0, 1], -this.roll * Math.PI / 180);\n      mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix, rotZ, vec3.fromValues((this.rright - this.left) / 2 - position[0], (this.top - this.bottom) / 2 - position[1], 0), vec3.fromValues(this.zoom, this.zoom, 1), position);\n    }\n  }, {\n    key: \"triggerUpdate\",\n    value: function triggerUpdate() {\n      if (this.enableUpdate) {\n        // update frustum\n        var viewMatrix = this.getViewTransform();\n        var vpMatrix = mat4.multiply(mat4.create(), this.getPerspective(), viewMatrix);\n        this.getFrustum().extractFromVPMatrix(vpMatrix);\n        this.eventEmitter.emit(CameraEvent.UPDATED);\n      }\n    }\n  }, {\n    key: \"rotate\",\n    value: function rotate(azimuth, elevation, roll) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"pan\",\n    value: function pan(tx, ty) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"dolly\",\n    value: function dolly(value) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"createLandmark\",\n    value: function createLandmark(name, params) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"gotoLandmark\",\n    value: function gotoLandmark(name, options) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"cancelLandmarkAnimation\",\n    value: function cancelLandmarkAnimation() {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }]);\n}();\n\n/**\n * @see https://doc.babylonjs.com/how_to/optimizing_your_scene#changing-mesh-culling-strategy\n */\nvar Strategy = /*#__PURE__*/function (Strategy) {\n  Strategy[Strategy[\"Standard\"] = 0] = \"Standard\";\n  return Strategy;\n}({});\n\nvar SortReason = /*#__PURE__*/function (SortReason) {\n  SortReason[SortReason[\"ADDED\"] = 0] = \"ADDED\";\n  SortReason[SortReason[\"REMOVED\"] = 1] = \"REMOVED\";\n  SortReason[SortReason[\"Z_INDEX_CHANGED\"] = 2] = \"Z_INDEX_CHANGED\";\n  return SortReason;\n}({});\n\nvar EMPTY_PARSED_PATH = {\n  absolutePath: [],\n  hasArc: false,\n  segments: [],\n  polygons: [],\n  polylines: [],\n  curve: null,\n  totalLength: 0,\n  rect: new Rectangle(0, 0, 0, 0)\n};\n\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Content_type\n */\nvar PropertySyntax = /*#__PURE__*/function (PropertySyntax) {\n  PropertySyntax[\"COORDINATE\"] = \"<coordinate>\";\n  PropertySyntax[\"COLOR\"] = \"<color>\";\n  PropertySyntax[\"PAINT\"] = \"<paint>\";\n  PropertySyntax[\"NUMBER\"] = \"<number>\";\n  PropertySyntax[\"ANGLE\"] = \"<angle>\";\n  PropertySyntax[\"OPACITY_VALUE\"] = \"<opacity-value>\";\n  PropertySyntax[\"SHADOW_BLUR\"] = \"<shadow-blur>\";\n  PropertySyntax[\"LENGTH\"] = \"<length>\";\n  PropertySyntax[\"PERCENTAGE\"] = \"<percentage>\";\n  PropertySyntax[\"LENGTH_PERCENTAGE\"] = \"<length> | <percentage>\";\n  PropertySyntax[\"LENGTH_PERCENTAGE_12\"] = \"[<length> | <percentage>]{1,2}\";\n  PropertySyntax[\"LENGTH_PERCENTAGE_14\"] = \"[<length> | <percentage>]{1,4}\";\n  PropertySyntax[\"LIST_OF_POINTS\"] = \"<list-of-points>\";\n  PropertySyntax[\"PATH\"] = \"<path>\";\n  PropertySyntax[\"FILTER\"] = \"<filter>\";\n  PropertySyntax[\"Z_INDEX\"] = \"<z-index>\";\n  PropertySyntax[\"OFFSET_DISTANCE\"] = \"<offset-distance>\";\n  PropertySyntax[\"DEFINED_PATH\"] = \"<defined-path>\";\n  PropertySyntax[\"MARKER\"] = \"<marker>\";\n  PropertySyntax[\"TRANSFORM\"] = \"<transform>\";\n  PropertySyntax[\"TRANSFORM_ORIGIN\"] = \"<transform-origin>\";\n  PropertySyntax[\"TEXT\"] = \"<text>\";\n  PropertySyntax[\"TEXT_TRANSFORM\"] = \"<text-transform>\";\n  return PropertySyntax;\n}({});\n\nfunction memoize(func, resolver) {\n  if (typeof func !== 'function' || resolver != null && typeof resolver !== 'function') {\n    throw new TypeError('Expected a function');\n  }\n  var _memoized = function memoized() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    var key = resolver ? resolver.apply(this, args) : args[0];\n    var cache = _memoized.cache;\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    _memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  _memoized.cache = new (memoize.Cache || Map)();\n  return _memoized;\n}\nmemoize.Cache = Map;\n\n// These units are iterated through, so be careful when adding or changing the\n// order.\nvar UnitType = /*#__PURE__*/function (UnitType) {\n  UnitType[UnitType[\"kUnknown\"] = 0] = \"kUnknown\";\n  UnitType[UnitType[\"kNumber\"] = 1] = \"kNumber\";\n  UnitType[UnitType[\"kPercentage\"] = 2] = \"kPercentage\";\n  UnitType[UnitType[\"kEms\"] = 3] = \"kEms\";\n  UnitType[UnitType[\"kPixels\"] = 4] = \"kPixels\";\n  UnitType[UnitType[\"kRems\"] = 5] = \"kRems\";\n  UnitType[UnitType[\"kDegrees\"] = 6] = \"kDegrees\";\n  UnitType[UnitType[\"kRadians\"] = 7] = \"kRadians\";\n  UnitType[UnitType[\"kGradians\"] = 8] = \"kGradians\";\n  UnitType[UnitType[\"kTurns\"] = 9] = \"kTurns\";\n  UnitType[UnitType[\"kMilliseconds\"] = 10] = \"kMilliseconds\";\n  UnitType[UnitType[\"kSeconds\"] = 11] = \"kSeconds\";\n  UnitType[UnitType[\"kInteger\"] = 12] = \"kInteger\";\n  return UnitType;\n}({}); // This value is used to handle quirky margins in reflow roots (body, td,\n// and th) like WinIE. The basic idea is that a stylesheet can use the value\n// __qem (for quirky em) instead of em. When the quirky value is used, if\n// you're in quirks mode, the margin will collapse away inside a table cell.\n// This quirk is specified in the HTML spec but our impl is different.\n// TODO: Remove this. crbug.com/443952\n// kQuirkyEms,\nvar UnitCategory = /*#__PURE__*/function (UnitCategory) {\n  UnitCategory[UnitCategory[\"kUNumber\"] = 0] = \"kUNumber\";\n  UnitCategory[UnitCategory[\"kUPercent\"] = 1] = \"kUPercent\";\n  UnitCategory[UnitCategory[\"kULength\"] = 2] = \"kULength\";\n  UnitCategory[UnitCategory[\"kUAngle\"] = 3] = \"kUAngle\";\n  UnitCategory[UnitCategory[\"kUTime\"] = 4] = \"kUTime\";\n  UnitCategory[UnitCategory[\"kUOther\"] = 5] = \"kUOther\";\n  return UnitCategory;\n}({});\nvar Nested = /*#__PURE__*/function (Nested) {\n  Nested[Nested[\"kYes\"] = 0] = \"kYes\";\n  Nested[Nested[\"kNo\"] = 1] = \"kNo\";\n  return Nested;\n}({});\nvar ParenLess = /*#__PURE__*/function (ParenLess) {\n  ParenLess[ParenLess[\"kYes\"] = 0] = \"kYes\";\n  ParenLess[ParenLess[\"kNo\"] = 1] = \"kNo\";\n  return ParenLess;\n}({});\n\n// This file specifies the unit strings used in CSSPrimitiveValues.\nvar data = [{\n  name: 'em',\n  unit_type: UnitType.kEms\n},\n// {\n//   name: 'ex',\n//   unit_type: UnitType.kExs,\n// },\n{\n  name: 'px',\n  unit_type: UnitType.kPixels\n},\n// {\n//   name: \"cm\",\n//   unit_type: UnitType.kCentimeters,\n// },\n// {\n//   name: \"mm\",\n//   unit_type: UnitType.kMillimeters,\n// },\n// {\n//   name: \"q\",\n//   unit_type: UnitType.kQuarterMillimeters,\n// },\n// {\n//   name: \"in\",\n//   unit_type: UnitType.kInches,\n// },\n// {\n//   name: \"pt\",\n//   unit_type: UnitType.kPoints,\n// },\n// {\n//   name: \"pc\",\n//   unit_type: UnitType.kPicas,\n// },\n{\n  name: 'deg',\n  unit_type: UnitType.kDegrees\n}, {\n  name: 'rad',\n  unit_type: UnitType.kRadians\n}, {\n  name: 'grad',\n  unit_type: UnitType.kGradians\n}, {\n  name: 'ms',\n  unit_type: UnitType.kMilliseconds\n}, {\n  name: 's',\n  unit_type: UnitType.kSeconds\n},\n// {\n//   name: \"hz\",\n//   unit_type: UnitType.kHertz,\n// },\n// {\n//   name: \"khz\",\n//   unit_type: UnitType.kKilohertz,\n// },\n// {\n//   name: \"dpi\",\n//   unit_type: \"kDotsPerInch\",\n// },\n// {\n//   name: \"dpcm\",\n//   unit_type: \"kDotsPerCentimeter\",\n// },\n// {\n//   name: \"dppx\",\n//   unit_type: \"kDotsPerPixel\",\n// },\n// {\n//   name: \"x\",\n//   unit_type: \"kDotsPerPixel\",\n// },\n// {\n//   name: \"vw\",\n//   unit_type: \"kViewportWidth\",\n// },\n// {\n//   name: \"vh\",\n//   unit_type: \"kViewportHeight\",\n// },\n// {\n//   name: \"vi\",\n//   unit_type: \"kViewportInlineSize\",\n// },\n// {\n//   name: \"vb\",\n//   unit_type: \"kViewportBlockSize\",\n// },\n// {\n//   name: \"vmin\",\n//   unit_type: UnitType.kViewportMin,\n// },\n// {\n//   name: \"vmax\",\n//   unit_type: UnitType.kViewportMax,\n// },\n// {\n//   name: \"svw\",\n//   unit_type: \"kSmallViewportWidth\",\n// },\n// {\n//   name: \"svh\",\n//   unit_type: \"kSmallViewportHeight\",\n// },\n// {\n//   name: \"svi\",\n//   unit_type: \"kSmallViewportInlineSize\",\n// },\n// {\n//   name: \"svb\",\n//   unit_type: \"kSmallViewportBlockSize\",\n// },\n// {\n//   name: \"svmin\",\n//   unit_type: \"kSmallViewportMin\",\n// },\n// {\n//   name: \"svmax\",\n//   unit_type: \"kSmallViewportMax\",\n// },\n// {\n//   name: \"lvw\",\n//   unit_type: \"kLargeViewportWidth\",\n// },\n// {\n//   name: \"lvh\",\n//   unit_type: \"kLargeViewportHeight\",\n// },\n// {\n//   name: \"lvi\",\n//   unit_type: \"kLargeViewportInlineSize\",\n// },\n// {\n//   name: \"lvb\",\n//   unit_type: \"kLargeViewportBlockSize\",\n// },\n// {\n//   name: \"lvmin\",\n//   unit_type: UnitType.kLargeViewportMin,\n// },\n// {\n//   name: \"lvmax\",\n//   unit_type: UnitType.kLargeViewportMax,\n// },\n// {\n//   name: \"dvw\",\n//   unit_type: UnitType.kDynamicViewportWidth,\n// },\n// {\n//   name: \"dvh\",\n//   unit_type: UnitType.kDynamicViewportHeight,\n// },\n// {\n//   name: \"dvi\",\n//   unit_type: UnitType.kDynamicViewportInlineSize,\n// },\n// {\n//   name: \"dvb\",\n//   unit_type: UnitType.kDynamicViewportBlockSize,\n// },\n// {\n//   name: \"dvmin\",\n//   unit_type: UnitType.kDynamicViewportMin,\n// },\n// {\n//   name: \"dvmax\",\n//   unit_type: UnitType.kDynamicViewportMax,\n// },\n// {\n//   name: \"cqw\",\n//   unit_type: UnitType.kContainerWidth,\n// },\n// {\n//   name: \"cqh\",\n//   unit_type: UnitType.kContainerHeight,\n// },\n// {\n//   name: \"cqi\",\n//   unit_type: UnitType.kContainerInlineSize,\n// },\n// {\n//   name: \"cqb\",\n//   unit_type: UnitType.kContainerBlockSize,\n// },\n// {\n//   name: \"cqmin\",\n//   unit_type: UnitType.kContainerMin,\n// },\n// {\n//   name: \"cqmax\",\n//   unit_type: UnitType.kContainerMax,\n// },\n{\n  name: 'rem',\n  unit_type: UnitType.kRems\n},\n// {\n//   name: 'fr',\n//   unit_type: UnitType.kFraction,\n// },\n{\n  name: 'turn',\n  unit_type: UnitType.kTurns\n}\n// {\n//   name: 'ch',\n//   unit_type: UnitType.kChs,\n// },\n// {\n//   name: '__qem',\n//   unit_type: UnitType.kQuirkyEms,\n// },\n];\nvar CSSStyleValueType = /*#__PURE__*/function (CSSStyleValueType) {\n  CSSStyleValueType[CSSStyleValueType[\"kUnknownType\"] = 0] = \"kUnknownType\";\n  CSSStyleValueType[CSSStyleValueType[\"kUnparsedType\"] = 1] = \"kUnparsedType\";\n  CSSStyleValueType[CSSStyleValueType[\"kKeywordType\"] = 2] = \"kKeywordType\";\n  CSSStyleValueType[CSSStyleValueType[\"kUnitType\"] = 3] = \"kUnitType\";\n  CSSStyleValueType[CSSStyleValueType[\"kSumType\"] = 4] = \"kSumType\";\n  CSSStyleValueType[CSSStyleValueType[\"kProductType\"] = 5] = \"kProductType\";\n  CSSStyleValueType[CSSStyleValueType[\"kNegateType\"] = 6] = \"kNegateType\";\n  CSSStyleValueType[CSSStyleValueType[\"kInvertType\"] = 7] = \"kInvertType\";\n  CSSStyleValueType[CSSStyleValueType[\"kMinType\"] = 8] = \"kMinType\";\n  CSSStyleValueType[CSSStyleValueType[\"kMaxType\"] = 9] = \"kMaxType\";\n  CSSStyleValueType[CSSStyleValueType[\"kClampType\"] = 10] = \"kClampType\";\n  CSSStyleValueType[CSSStyleValueType[\"kTransformType\"] = 11] = \"kTransformType\";\n  CSSStyleValueType[CSSStyleValueType[\"kPositionType\"] = 12] = \"kPositionType\";\n  CSSStyleValueType[CSSStyleValueType[\"kURLImageType\"] = 13] = \"kURLImageType\";\n  CSSStyleValueType[CSSStyleValueType[\"kColorType\"] = 14] = \"kColorType\";\n  CSSStyleValueType[CSSStyleValueType[\"kUnsupportedColorType\"] = 15] = \"kUnsupportedColorType\";\n  return CSSStyleValueType;\n}({});\n\n// function parseCSSStyleValue(propertyName: string, value: string): CSSStyleValue[] {\n//   // const propertyId = cssPropertyID(propertyName);\n\n//   // if (propertyId === CSSPropertyID.kInvalid) {\n//   //   return [];\n//   // }\n\n//   // const customPropertyName = propertyId === CSSPropertyID.kVariable ? propertyName : null;\n//   // return fromString(propertyId, customPropertyName, value);\n//   return [];\n// }\n\nvar stringToUnitType = function stringToUnitType(name) {\n  return data.find(function (item) {\n    return item.name === name;\n  }).unit_type;\n};\nvar unitFromName = function unitFromName(name) {\n  if (!name) {\n    return UnitType.kUnknown;\n  }\n  if (name === 'number') {\n    return UnitType.kNumber;\n  }\n  if (name === 'percent' || name === '%') {\n    return UnitType.kPercentage;\n  }\n  return stringToUnitType(name);\n};\nvar unitTypeToUnitCategory = function unitTypeToUnitCategory(type) {\n  switch (type) {\n    case UnitType.kNumber:\n    case UnitType.kInteger:\n      return UnitCategory.kUNumber;\n    case UnitType.kPercentage:\n      return UnitCategory.kUPercent;\n    case UnitType.kPixels:\n      // case UnitType.kCentimeters:\n      // case UnitType.kMillimeters:\n      // case UnitType.kQuarterMillimeters:\n      // case UnitType.kInches:\n      // case UnitType.kPoints:\n      // case UnitType.kPicas:\n      // case UnitType.kUserUnits:\n      return UnitCategory.kULength;\n    case UnitType.kMilliseconds:\n    case UnitType.kSeconds:\n      return UnitCategory.kUTime;\n    case UnitType.kDegrees:\n    case UnitType.kRadians:\n    case UnitType.kGradians:\n    case UnitType.kTurns:\n      return UnitCategory.kUAngle;\n    // case UnitType.kHertz:\n    // case UnitType.kKilohertz:\n    //   return UnitCategory.kUFrequency;\n    // case UnitType.kDotsPerPixel:\n    // case UnitType.kDotsPerInch:\n    // case UnitType.kDotsPerCentimeter:\n    //   return UnitCategory.kUResolution;\n    default:\n      return UnitCategory.kUOther;\n  }\n};\nvar canonicalUnitTypeForCategory = function canonicalUnitTypeForCategory(category) {\n  // The canonical unit type is chosen according to the way\n  // CSSPropertyParser.ValidUnit() chooses the default unit in each category\n  // (based on unitflags).\n  switch (category) {\n    case UnitCategory.kUNumber:\n      return UnitType.kNumber;\n    case UnitCategory.kULength:\n      return UnitType.kPixels;\n    case UnitCategory.kUPercent:\n      return UnitType.kPercentage;\n    // return UnitType.kUnknown; // Cannot convert between numbers and percent.\n    case UnitCategory.kUTime:\n      return UnitType.kSeconds;\n    case UnitCategory.kUAngle:\n      return UnitType.kDegrees;\n    // case UnitCategory.kUFrequency:\n    //   return UnitType.kHertz;\n    // case UnitCategory.kUResolution:\n    //   return UnitType.kDotsPerPixel;\n    default:\n      return UnitType.kUnknown;\n  }\n};\n\n/**\n * @see https://chromium.googlesource.com/chromium/src/+/refs/heads/main/third_party/blink/renderer/core/css/css_primitive_value.cc#353\n */\nvar conversionToCanonicalUnitsScaleFactor = function conversionToCanonicalUnitsScaleFactor(unit_type) {\n  var factor = 1.0;\n  // FIXME: the switch can be replaced by an array of scale factors.\n  switch (unit_type) {\n    // These are \"canonical\" units in their respective categories.\n    case UnitType.kPixels:\n    // case UnitType.kUserUnits:\n    case UnitType.kDegrees:\n    case UnitType.kSeconds:\n      // case UnitType.kHertz:\n      break;\n    case UnitType.kMilliseconds:\n      factor = 0.001;\n      break;\n    // case UnitType.kCentimeters:\n    //   // factor = kCssPixelsPerCentimeter;\n    //   break;\n    // case UnitType.kDotsPerCentimeter:\n    //   // factor = 1 / kCssPixelsPerCentimeter;\n    //   break;\n    // case UnitType.kMillimeters:\n    //   // factor = kCssPixelsPerMillimeter;\n    //   break;\n    // case UnitType.kQuarterMillimeters:\n    //   // factor = kCssPixelsPerQuarterMillimeter;\n    //   break;\n    // case UnitType.kInches:\n    //   // factor = kCssPixelsPerInch;\n    //   break;\n    // case UnitType.kDotsPerInch:\n    //   // factor = 1 / kCssPixelsPerInch;\n    //   break;\n    // case UnitType.kPoints:\n    //   // factor = kCssPixelsPerPoint;\n    //   break;\n    // case UnitType.kPicas:\n    //   // factor = kCssPixelsPerPica;\n    //   break;\n    case UnitType.kRadians:\n      factor = 180 / Math.PI;\n      break;\n    case UnitType.kGradians:\n      factor = 0.9;\n      break;\n    case UnitType.kTurns:\n      factor = 360;\n      break;\n  }\n  return factor;\n};\nvar unitTypeToString = function unitTypeToString(type) {\n  switch (type) {\n    case UnitType.kNumber:\n    case UnitType.kInteger:\n      // case UnitType.kUserUnits:\n      return '';\n    case UnitType.kPercentage:\n      return '%';\n    case UnitType.kEms:\n      // case UnitType.kQuirkyEms:\n      return 'em';\n    // case UnitType.kExs:\n    //   return 'ex';\n    case UnitType.kRems:\n      return 'rem';\n    // case UnitType.kChs:\n    //   return 'ch';\n    case UnitType.kPixels:\n      return 'px';\n    // case UnitType.kCentimeters:\n    //   return 'cm';\n    // case UnitType.kDotsPerPixel:\n    //   return 'dppx';\n    // case UnitType.kDotsPerInch:\n    //   return 'dpi';\n    // case UnitType.kDotsPerCentimeter:\n    //   return 'dpcm';\n    // case UnitType.kMillimeters:\n    //   return 'mm';\n    // case UnitType.kQuarterMillimeters:\n    //   return 'q';\n    // case UnitType.kInches:\n    //   return 'in';\n    // case UnitType.kPoints:\n    //   return 'pt';\n    // case UnitType.kPicas:\n    //   return 'pc';\n    case UnitType.kDegrees:\n      return 'deg';\n    case UnitType.kRadians:\n      return 'rad';\n    case UnitType.kGradians:\n      return 'grad';\n    case UnitType.kMilliseconds:\n      return 'ms';\n    case UnitType.kSeconds:\n      return 's';\n    // case UnitType.kHertz:\n    //   return 'hz';\n    // case UnitType.kKilohertz:\n    //   return 'khz';\n    case UnitType.kTurns:\n      return 'turn';\n  }\n  return '';\n};\n\n/**\n * CSSStyleValue is the base class for all CSS values accessible from Typed OM.\n * Values that are not yet supported as specific types are also returned as base CSSStyleValues.\n *\n * Spec @see https://drafts.css-houdini.org/css-typed-om/#stylevalue-objects\n * Docs @see https://developer.mozilla.org/en-US/docs/Web/API/CSSStyleValue\n */\nvar CSSStyleValue = /*#__PURE__*/function () {\n  function CSSStyleValue() {\n    _classCallCheck(this, CSSStyleValue);\n  }\n  return _createClass(CSSStyleValue, [{\n    key: \"toString\",\n    value:\n    // protected abstract toCSSValue(): CSSValue;\n\n    function toString() {\n      return this.buildCSSText(Nested.kNo, ParenLess.kNo, '');\n    }\n  }, {\n    key: \"isNumericValue\",\n    value: function isNumericValue() {\n      return this.getType() >= CSSStyleValueType.kUnitType && this.getType() <= CSSStyleValueType.kClampType;\n    }\n  }], [{\n    key: \"isAngle\",\n    value:\n    // static parse(propertyName: string, value: string): CSSStyleValue {\n    //   return parseCSSStyleValue(propertyName, value)[0];\n    // }\n\n    // static parseAll(propertyName: string, value: string): CSSStyleValue[] {\n    //   return parseCSSStyleValue(propertyName, value);\n    // }\n\n    function isAngle(unit) {\n      return unit === UnitType.kDegrees || unit === UnitType.kRadians || unit === UnitType.kGradians || unit === UnitType.kTurns;\n    }\n\n    // static isViewportPercentageLength(type: UnitType) {\n    //   return type >= UnitType.kViewportWidth && type <= UnitType.kDynamicViewportMax;\n    // }\n\n    // static isContainerPercentageLength(type: UnitType) {\n    //   return type >= UnitType.kContainerWidth && type <= UnitType.kContainerMax;\n    // }\n  }, {\n    key: \"isLength\",\n    value: function isLength(type) {\n      // return (type >= UnitType.kEms && type <= UnitType.kUserUnits) || type == UnitType.kQuirkyEms;\n      return type >= UnitType.kEms && type < UnitType.kDegrees;\n    }\n  }, {\n    key: \"isRelativeUnit\",\n    value: function isRelativeUnit(type) {\n      return type === UnitType.kPercentage || type === UnitType.kEms ||\n      // type === UnitType.kExs ||\n      type === UnitType.kRems\n      // type === UnitType.kChs ||\n      // this.isViewportPercentageLength(type) ||\n      // this.isContainerPercentageLength(type)\n      ;\n    }\n  }, {\n    key: \"isTime\",\n    value: function isTime(unit) {\n      return unit === UnitType.kSeconds || unit === UnitType.kMilliseconds;\n    }\n\n    // static isFrequency(unit: UnitType) {\n    //   return unit == UnitType.kHertz || unit == UnitType.kKilohertz;\n    // }\n\n    // static isResolution(type: UnitType) {\n    //   return type >= UnitType.kDotsPerPixel && type <= UnitType.kDotsPerCentimeter;\n    // }\n\n    // static isFlex(unit: UnitType) {\n    //   return unit === UnitType.kFraction;\n    // }\n  }]);\n}();\n\n/**\n * @see https://drafts.css-houdini.org/css-typed-om-1/#dom-csscolorvalue-colorspace\n */\n\n/**\n * CSSColorValue is the base class used for the various CSS color interfaces.\n *\n * @see https://drafts.css-houdini.org/css-typed-om-1/#colorvalue-objects\n */\nvar CSSColorValue = /*#__PURE__*/function (_CSSStyleValue) {\n  function CSSColorValue(colorSpace) {\n    var _this;\n    _classCallCheck(this, CSSColorValue);\n    _this = _callSuper(this, CSSColorValue);\n    _this.colorSpace = colorSpace;\n    return _this;\n  }\n  _inherits(CSSColorValue, _CSSStyleValue);\n  return _createClass(CSSColorValue, [{\n    key: \"getType\",\n    value: function getType() {\n      return CSSStyleValueType.kColorType;\n    }\n\n    /**\n     * @see https://drafts.css-houdini.org/css-typed-om-1/#dom-csscolorvalue-to\n     */\n  }, {\n    key: \"to\",\n    value: function to(colorSpace) {\n      return this;\n    }\n  }]);\n}(CSSStyleValue);\n\nvar GradientType = /*#__PURE__*/function (GradientType) {\n  GradientType[GradientType[\"Constant\"] = 0] = \"Constant\";\n  GradientType[GradientType[\"LinearGradient\"] = 1] = \"LinearGradient\";\n  GradientType[GradientType[\"RadialGradient\"] = 2] = \"RadialGradient\";\n  return GradientType;\n}({});\nvar CSSGradientValue = /*#__PURE__*/function (_CSSStyleValue) {\n  function CSSGradientValue(type, value) {\n    var _this;\n    _classCallCheck(this, CSSGradientValue);\n    _this = _callSuper(this, CSSGradientValue);\n    _this.type = type;\n    _this.value = value;\n    return _this;\n  }\n  _inherits(CSSGradientValue, _CSSStyleValue);\n  return _createClass(CSSGradientValue, [{\n    key: \"clone\",\n    value: function clone() {\n      return new CSSGradientValue(this.type, this.value);\n    }\n  }, {\n    key: \"buildCSSText\",\n    value: function buildCSSText(n, p, result) {\n      return result;\n    }\n  }, {\n    key: \"getType\",\n    value: function getType() {\n      return CSSStyleValueType.kColorType;\n    }\n  }]);\n}(CSSStyleValue);\n\n/**\n * CSSKeywordValue represents CSS Values that are specified as keywords\n * eg. 'initial'\n * @see https://developer.mozilla.org/en-US/docs/Web/API/CSSKeywordValue\n * @see https://chromium.googlesource.com/chromium/src/+/refs/heads/main/third_party/blink/renderer/core/css/cssom/css_keyword_value.idl\n */\nvar CSSKeywordValue = /*#__PURE__*/function (_CSSStyleValue) {\n  function CSSKeywordValue(value) {\n    var _this;\n    _classCallCheck(this, CSSKeywordValue);\n    _this = _callSuper(this, CSSKeywordValue);\n    _this.value = value;\n    return _this;\n  }\n  _inherits(CSSKeywordValue, _CSSStyleValue);\n  return _createClass(CSSKeywordValue, [{\n    key: \"clone\",\n    value: function clone() {\n      return new CSSKeywordValue(this.value);\n    }\n  }, {\n    key: \"getType\",\n    value: function getType() {\n      return CSSStyleValueType.kKeywordType;\n    }\n  }, {\n    key: \"buildCSSText\",\n    value: function buildCSSText(n, p, result) {\n      return result + this.value;\n    }\n  }]);\n}(CSSStyleValue);\n\nvar formatInfinityOrNaN = function formatInfinityOrNaN(number) {\n  var suffix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  var result = '';\n  if (!Number.isFinite(number)) {\n    if (number > 0) result = 'infinity';else result = '-infinity';\n  } else {\n    result = 'NaN';\n  }\n  return result += suffix;\n};\nvar toCanonicalUnit = function toCanonicalUnit(unit) {\n  return canonicalUnitTypeForCategory(unitTypeToUnitCategory(unit));\n};\n\n/**\n * CSSNumericValue is the base class for numeric and length typed CSS Values.\n * @see https://drafts.css-houdini.org/css-typed-om/#numeric-objects\n * @see https://developer.mozilla.org/en-US/docs/Web/API/CSSNumericValue\n * @see https://chromium.googlesource.com/chromium/src/+/refs/heads/main/third_party/blink/renderer/core/css/cssom/css_numeric_value.idl\n */\n\n/**\n * Represents numeric values that can be expressed as a single number plus a\n * unit (or a naked number or percentage).\n * @see https://drafts.css-houdini.org/css-typed-om/#cssunitvalue\n */\nvar CSSUnitValue = /*#__PURE__*/function (_CSSStyleValue) {\n  function CSSUnitValue(value) {\n    var _this;\n    var unitOrName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : UnitType.kNumber;\n    _classCallCheck(this, CSSUnitValue);\n    _this = _callSuper(this, CSSUnitValue);\n    var unit;\n    if (typeof unitOrName === 'string') {\n      unit = unitFromName(unitOrName);\n    } else {\n      unit = unitOrName;\n    }\n    _this.unit = unit;\n    _this.value = value;\n    return _this;\n  }\n  _inherits(CSSUnitValue, _CSSStyleValue);\n  return _createClass(CSSUnitValue, [{\n    key: \"clone\",\n    value: function clone() {\n      return new CSSUnitValue(this.value, this.unit);\n    }\n  }, {\n    key: \"equals\",\n    value: function equals(other) {\n      var other_unit_value = other;\n      return this.value === other_unit_value.value && this.unit === other_unit_value.unit;\n    }\n  }, {\n    key: \"getType\",\n    value: function getType() {\n      return CSSStyleValueType.kUnitType;\n    }\n  }, {\n    key: \"convertTo\",\n    value: function convertTo(target_unit) {\n      if (this.unit === target_unit) {\n        return new CSSUnitValue(this.value, this.unit);\n      }\n\n      // Instead of defining the scale factors for every unit to every other unit,\n      // we simply convert to the canonical unit and back since we already have\n      // the scale factors for canonical units.\n      var canonical_unit = toCanonicalUnit(this.unit);\n      if (canonical_unit !== toCanonicalUnit(target_unit) || canonical_unit === UnitType.kUnknown) {\n        return null;\n      }\n      var scale_factor = conversionToCanonicalUnitsScaleFactor(this.unit) / conversionToCanonicalUnitsScaleFactor(target_unit);\n      return new CSSUnitValue(this.value * scale_factor, target_unit);\n    }\n  }, {\n    key: \"buildCSSText\",\n    value: function buildCSSText(n, p, result) {\n      var text;\n      switch (this.unit) {\n        case UnitType.kUnknown:\n          // FIXME\n          break;\n        case UnitType.kInteger:\n          text = Number(this.value).toFixed(0);\n          break;\n        case UnitType.kNumber:\n        case UnitType.kPercentage:\n        case UnitType.kEms:\n        // case UnitType.kQuirkyEms:\n        // case UnitType.kExs:\n        case UnitType.kRems:\n        // case UnitType.kChs:\n        case UnitType.kPixels:\n        // case UnitType.kCentimeters:\n        // case UnitType.kDotsPerPixel:\n        // case UnitType.kDotsPerInch:\n        // case UnitType.kDotsPerCentimeter:\n        // case UnitType.kMillimeters:\n        // case UnitType.kQuarterMillimeters:\n        // case UnitType.kInches:\n        // case UnitType.kPoints:\n        // case UnitType.kPicas:\n        // case UnitType.kUserUnits:\n        case UnitType.kDegrees:\n        case UnitType.kRadians:\n        case UnitType.kGradians:\n        case UnitType.kMilliseconds:\n        case UnitType.kSeconds:\n        // case UnitType.kHertz:\n        // case UnitType.kKilohertz:\n        case UnitType.kTurns:\n          {\n            // case UnitType.kContainerMax: { // case UnitType.kContainerMin: // case UnitType.kContainerBlockSize: // case UnitType.kContainerInlineSize: // case UnitType.kContainerHeight: // case UnitType.kContainerWidth: // case UnitType.kDynamicViewportMax: // case UnitType.kDynamicViewportMin: // case UnitType.kDynamicViewportBlockSize: // case UnitType.kDynamicViewportInlineSize: // case UnitType.kDynamicViewportHeight: // case UnitType.kDynamicViewportWidth: // case UnitType.kLargeViewportMax: // case UnitType.kLargeViewportMin: // case UnitType.kLargeViewportBlockSize: // case UnitType.kLargeViewportInlineSize: // case UnitType.kLargeViewportHeight: // case UnitType.kLargeViewportWidth: // case UnitType.kSmallViewportMax: // case UnitType.kSmallViewportMin: // case UnitType.kSmallViewportBlockSize: // case UnitType.kSmallViewportInlineSize: // case UnitType.kSmallViewportHeight: // case UnitType.kSmallViewportWidth: // case UnitType.kViewportMax: // case UnitType.kViewportMin: // case UnitType.kViewportBlockSize: // case UnitType.kViewportInlineSize: // case UnitType.kViewportHeight: // case UnitType.kViewportWidth: // case UnitType.kFraction:\n            var kMinInteger = -999999;\n            var kMaxInteger = 999999;\n            var value = this.value;\n            var unit = unitTypeToString(this.unit);\n            if (value < kMinInteger || value > kMaxInteger) {\n              var _unit = unitTypeToString(this.unit);\n              if (!Number.isFinite(value) || Number.isNaN(value)) {\n                text = formatInfinityOrNaN(value, _unit);\n              } else {\n                text = value + (_unit || '');\n              }\n            } else {\n              text = \"\".concat(value).concat(unit);\n            }\n          }\n      }\n      result += text;\n      return result;\n    }\n  }]);\n}(CSSStyleValue);\nvar Opx = new CSSUnitValue(0, 'px');\nnew CSSUnitValue(1, 'px');\nvar Odeg = new CSSUnitValue(0, 'deg');\n\n/**\n * The CSSRGB class represents the CSS rgb()/rgba() functions.\n *\n * @see https://drafts.css-houdini.org/css-typed-om-1/#cssrgb\n */\nvar CSSRGB = /*#__PURE__*/function (_CSSColorValue) {\n  function CSSRGB(r, g, b) {\n    var _this;\n    var alpha = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n    var isNone = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n    _classCallCheck(this, CSSRGB);\n    _this = _callSuper(this, CSSRGB, ['rgb']);\n    _this.r = r;\n    _this.g = g;\n    _this.b = b;\n    _this.alpha = alpha;\n    _this.isNone = isNone;\n    return _this;\n  }\n  _inherits(CSSRGB, _CSSColorValue);\n  return _createClass(CSSRGB, [{\n    key: \"clone\",\n    value: function clone() {\n      return new CSSRGB(this.r, this.g, this.b, this.alpha);\n    }\n  }, {\n    key: \"buildCSSText\",\n    value: function buildCSSText(n, p, result) {\n      return \"\".concat(result, \"rgba(\").concat(this.r, \",\").concat(this.g, \",\").concat(this.b, \",\").concat(this.alpha, \")\");\n    }\n  }]);\n}(CSSColorValue);\n\n/**\n * CSSKeywordValue\n */\nvar unsetKeywordValue = new CSSKeywordValue('unset');\nvar initialKeywordValue = new CSSKeywordValue('initial');\nvar inheritKeywordValue = new CSSKeywordValue('inherit');\nvar keywordCache = {\n  '': unsetKeywordValue,\n  unset: unsetKeywordValue,\n  initial: initialKeywordValue,\n  inherit: inheritKeywordValue\n};\nvar getOrCreateKeyword = function getOrCreateKeyword(name) {\n  if (!keywordCache[name]) {\n    keywordCache[name] = new CSSKeywordValue(name);\n  }\n  return keywordCache[name];\n};\n\n/**\n * CSSColor\n */\nvar noneColor = new CSSRGB(0, 0, 0, 0, true);\nvar transparentColor = new CSSRGB(0, 0, 0, 0);\nvar getOrCreateRGBA = memoize(function (r, g, b, a) {\n  return new CSSRGB(r, g, b, a);\n}, function (r, g, b, a) {\n  return \"rgba(\".concat(r, \",\").concat(g, \",\").concat(b, \",\").concat(a, \")\");\n});\n\n// export const getOrCreateUnitValue = memoize(\n//   (value: number, unitOrName: UnitType | string = UnitType.kNumber) => {\n//     return new CSSUnitValue(value, unitOrName);\n//   },\n//   (value: number, unitOrName: UnitType | string = UnitType.kNumber) => {\n//     return `${value}${unitOrName}`;\n//   },\n// );\n\nvar getOrCreateUnitValue = function getOrCreateUnitValue(value) {\n  var unitOrName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : UnitType.kNumber;\n  return new CSSUnitValue(value, unitOrName);\n};\nnew CSSUnitValue(50, '%');\n\n/**\n * borrow from gradient-parser, but we delete some browser compatible prefix such as `-webkit-`\n * @see https://github.com/rafaelcaricio/gradient-parser\n */\n\nfunction colorStopToString(colorStop) {\n  var type = colorStop.type,\n    value = colorStop.value;\n  if (type === 'hex') {\n    return \"#\".concat(value);\n  }\n  if (type === 'literal') {\n    return value;\n  }\n  if (type === 'rgb') {\n    return \"rgb(\".concat(value.join(','), \")\");\n  }\n  return \"rgba(\".concat(value.join(','), \")\");\n}\nvar parseGradient$1 = function () {\n  var tokens = {\n    linearGradient: /^(linear\\-gradient)/i,\n    repeatingLinearGradient: /^(repeating\\-linear\\-gradient)/i,\n    radialGradient: /^(radial\\-gradient)/i,\n    repeatingRadialGradient: /^(repeating\\-radial\\-gradient)/i,\n    /**\n     * @see https://projects.verou.me/conic-gradient/\n     */\n    conicGradient: /^(conic\\-gradient)/i,\n    sideOrCorner: /^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,\n    extentKeywords: /^(closest\\-side|closest\\-corner|farthest\\-side|farthest\\-corner|contain|cover)/,\n    positionKeywords: /^(left|center|right|top|bottom)/i,\n    pixelValue: /^(-?(([0-9]*\\.[0-9]+)|([0-9]+\\.?)))px/,\n    percentageValue: /^(-?(([0-9]*\\.[0-9]+)|([0-9]+\\.?)))\\%/,\n    emValue: /^(-?(([0-9]*\\.[0-9]+)|([0-9]+\\.?)))em/,\n    angleValue: /^(-?(([0-9]*\\.[0-9]+)|([0-9]+\\.?)))deg/,\n    startCall: /^\\(/,\n    endCall: /^\\)/,\n    comma: /^,/,\n    hexColor: /^\\#([0-9a-fA-F]+)/,\n    literalColor: /^([a-zA-Z]+)/,\n    rgbColor: /^rgb/i,\n    rgbaColor: /^rgba/i,\n    number: /^(([0-9]*\\.[0-9]+)|([0-9]+\\.?))/\n  };\n  var input = '';\n  function error(msg) {\n    throw new Error(\"\".concat(input, \": \").concat(msg));\n  }\n  function getAST() {\n    var ast = matchListDefinitions();\n    if (input.length > 0) {\n      error('Invalid input not EOF');\n    }\n    return ast;\n  }\n  function matchListDefinitions() {\n    return matchListing(matchDefinition);\n  }\n  function matchDefinition() {\n    return matchGradient('linear-gradient', tokens.linearGradient, matchLinearOrientation) || matchGradient('repeating-linear-gradient', tokens.repeatingLinearGradient, matchLinearOrientation) || matchGradient('radial-gradient', tokens.radialGradient, matchListRadialOrientations) || matchGradient('repeating-radial-gradient', tokens.repeatingRadialGradient, matchListRadialOrientations) || matchGradient('conic-gradient', tokens.conicGradient, matchListRadialOrientations);\n  }\n  function matchGradient(gradientType, pattern, orientationMatcher) {\n    return matchCall(pattern, function (captures) {\n      var orientation = orientationMatcher();\n      if (orientation) {\n        if (!scan(tokens.comma)) {\n          error('Missing comma before color stops');\n        }\n      }\n      return {\n        type: gradientType,\n        orientation: orientation,\n        colorStops: matchListing(matchColorStop)\n      };\n    });\n  }\n  function matchCall(pattern, callback) {\n    var captures = scan(pattern);\n    if (captures) {\n      if (!scan(tokens.startCall)) {\n        error('Missing (');\n      }\n      var result = callback(captures);\n      if (!scan(tokens.endCall)) {\n        error('Missing )');\n      }\n      return result;\n    }\n  }\n  function matchLinearOrientation() {\n    return matchSideOrCorner() || matchAngle();\n  }\n  function matchSideOrCorner() {\n    return match('directional', tokens.sideOrCorner, 1);\n  }\n  function matchAngle() {\n    return match('angular', tokens.angleValue, 1);\n  }\n  function matchListRadialOrientations() {\n    var radialOrientations;\n    var radialOrientation = matchRadialOrientation();\n    var lookaheadCache;\n    if (radialOrientation) {\n      radialOrientations = [];\n      radialOrientations.push(radialOrientation);\n      lookaheadCache = input;\n      if (scan(tokens.comma)) {\n        radialOrientation = matchRadialOrientation();\n        if (radialOrientation) {\n          radialOrientations.push(radialOrientation);\n        } else {\n          input = lookaheadCache;\n        }\n      }\n    }\n    return radialOrientations;\n  }\n  function matchRadialOrientation() {\n    var radialType = matchCircle() || matchEllipse();\n    if (radialType) {\n      // @ts-ignore\n      radialType.at = matchAtPosition();\n    } else {\n      var extent = matchExtentKeyword();\n      if (extent) {\n        radialType = extent;\n        var positionAt = matchAtPosition();\n        if (positionAt) {\n          // @ts-ignore\n          radialType.at = positionAt;\n        }\n      } else {\n        var defaultPosition = matchPositioning();\n        if (defaultPosition) {\n          radialType = {\n            type: 'default-radial',\n            // @ts-ignore\n            at: defaultPosition\n          };\n        }\n      }\n    }\n    return radialType;\n  }\n  function matchCircle() {\n    var circle = match('shape', /^(circle)/i, 0);\n    if (circle) {\n      // @ts-ignore\n      circle.style = matchLength() || matchExtentKeyword();\n    }\n    return circle;\n  }\n  function matchEllipse() {\n    var ellipse = match('shape', /^(ellipse)/i, 0);\n    if (ellipse) {\n      // @ts-ignore\n      ellipse.style = matchDistance() || matchExtentKeyword();\n    }\n    return ellipse;\n  }\n  function matchExtentKeyword() {\n    return match('extent-keyword', tokens.extentKeywords, 1);\n  }\n  function matchAtPosition() {\n    if (match('position', /^at/, 0)) {\n      var positioning = matchPositioning();\n      if (!positioning) {\n        error('Missing positioning value');\n      }\n      return positioning;\n    }\n  }\n  function matchPositioning() {\n    var location = matchCoordinates();\n    if (location.x || location.y) {\n      return {\n        type: 'position',\n        value: location\n      };\n    }\n  }\n  function matchCoordinates() {\n    return {\n      x: matchDistance(),\n      y: matchDistance()\n    };\n  }\n  function matchListing(matcher) {\n    var captures = matcher();\n    var result = [];\n    if (captures) {\n      result.push(captures);\n      while (scan(tokens.comma)) {\n        captures = matcher();\n        if (captures) {\n          result.push(captures);\n        } else {\n          error('One extra comma');\n        }\n      }\n    }\n    return result;\n  }\n  function matchColorStop() {\n    var color = matchColor();\n    if (!color) {\n      error('Expected color definition');\n    }\n    color.length = matchDistance();\n    return color;\n  }\n  function matchColor() {\n    return matchHexColor() || matchRGBAColor() || matchRGBColor() || matchLiteralColor();\n  }\n  function matchLiteralColor() {\n    return match('literal', tokens.literalColor, 0);\n  }\n  function matchHexColor() {\n    return match('hex', tokens.hexColor, 1);\n  }\n  function matchRGBColor() {\n    return matchCall(tokens.rgbColor, function () {\n      return {\n        type: 'rgb',\n        value: matchListing(matchNumber)\n      };\n    });\n  }\n  function matchRGBAColor() {\n    return matchCall(tokens.rgbaColor, function () {\n      return {\n        type: 'rgba',\n        value: matchListing(matchNumber)\n      };\n    });\n  }\n  function matchNumber() {\n    return scan(tokens.number)[1];\n  }\n  function matchDistance() {\n    return match('%', tokens.percentageValue, 1) || matchPositionKeyword() || matchLength();\n  }\n  function matchPositionKeyword() {\n    return match('position-keyword', tokens.positionKeywords, 1);\n  }\n  function matchLength() {\n    return match('px', tokens.pixelValue, 1) || match('em', tokens.emValue, 1);\n  }\n  function match(type, pattern, captureIndex) {\n    var captures = scan(pattern);\n    if (captures) {\n      return {\n        type: type,\n        value: captures[captureIndex]\n      };\n    }\n  }\n  function scan(regexp) {\n    var blankCaptures = /^[\\n\\r\\t\\s]+/.exec(input);\n    if (blankCaptures) {\n      consume(blankCaptures[0].length);\n    }\n    var captures = regexp.exec(input);\n    if (captures) {\n      consume(captures[0].length);\n    }\n    return captures;\n  }\n  function consume(size) {\n    input = input.substring(size);\n  }\n  return function (code) {\n    input = code;\n    return getAST();\n  };\n}();\nfunction computeLinearGradient(min, width, height, angle) {\n  var rad = deg2rad(angle.value);\n  var rx = 0;\n  var ry = 0;\n  var rcx = rx + width / 2;\n  var rcy = ry + height / 2;\n  // get the length of gradient line\n  // @see https://observablehq.com/@danburzo/css-gradient-line\n  var length = Math.abs(width * Math.cos(rad)) + Math.abs(height * Math.sin(rad));\n  var x1 = min[0] + rcx - Math.cos(rad) * length / 2;\n  var y1 = min[1] + rcy - Math.sin(rad) * length / 2;\n  var x2 = min[0] + rcx + Math.cos(rad) * length / 2;\n  var y2 = min[1] + rcy + Math.sin(rad) * length / 2;\n  return {\n    x1: x1,\n    y1: y1,\n    x2: x2,\n    y2: y2\n  };\n}\nfunction computeRadialGradient(min, width, height, cx, cy, size) {\n  // 'px'\n  var x = cx.value;\n  var y = cy.value;\n\n  // TODO: 'em'\n\n  // '%'\n  if (cx.unit === UnitType.kPercentage) {\n    x = cx.value / 100 * width;\n  }\n  if (cy.unit === UnitType.kPercentage) {\n    y = cy.value / 100 * height;\n  }\n\n  // default to farthest-side\n  var r = Math.max(distanceSquareRoot([0, 0], [x, y]), distanceSquareRoot([0, height], [x, y]), distanceSquareRoot([width, height], [x, y]), distanceSquareRoot([width, 0], [x, y]));\n  if (size) {\n    if (size instanceof CSSUnitValue) {\n      r = size.value;\n    } else if (size instanceof CSSKeywordValue) {\n      // @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Images/Using_CSS_gradients#example_closest-side_for_circles\n      if (size.value === 'closest-side') {\n        r = Math.min(x, width - x, y, height - y);\n      } else if (size.value === 'farthest-side') {\n        r = Math.max(x, width - x, y, height - y);\n      } else if (size.value === 'closest-corner') {\n        r = Math.min(distanceSquareRoot([0, 0], [x, y]), distanceSquareRoot([0, height], [x, y]), distanceSquareRoot([width, height], [x, y]), distanceSquareRoot([width, 0], [x, y]));\n      }\n    }\n  }\n  return {\n    x: x + min[0],\n    y: y + min[1],\n    r: r\n  };\n}\n\nvar regexLG = /^l\\s*\\(\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexRG = /^r\\s*\\(\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexPR = /^p\\s*\\(\\s*([axyn])\\s*\\)\\s*(.*)/i;\nvar regexColorStop = /[\\d.]+:(#[^\\s]+|[^\\)]+\\))/gi;\nfunction spaceColorStops(colorStops) {\n  var _colorStops$length;\n  var length = colorStops.length;\n  colorStops[length - 1].length = (_colorStops$length = colorStops[length - 1].length) !== null && _colorStops$length !== void 0 ? _colorStops$length : {\n    type: '%',\n    value: '100'\n  };\n  if (length > 1) {\n    var _colorStops$0$length;\n    colorStops[0].length = (_colorStops$0$length = colorStops[0].length) !== null && _colorStops$0$length !== void 0 ? _colorStops$0$length : {\n      type: '%',\n      value: '0'\n    };\n  }\n  var previousIndex = 0;\n  var previousOffset = Number(colorStops[0].length.value);\n  for (var i = 1; i < length; i++) {\n    var _colorStops$i$length;\n    // support '%' & 'px'\n    var offset = (_colorStops$i$length = colorStops[i].length) === null || _colorStops$i$length === void 0 ? void 0 : _colorStops$i$length.value;\n    if (!isNil(offset) && !isNil(previousOffset)) {\n      for (var j = 1; j < i - previousIndex; j++) colorStops[previousIndex + j].length = {\n        type: '%',\n        value: \"\".concat(previousOffset + (Number(offset) - previousOffset) * j / (i - previousIndex))\n      };\n      previousIndex = i;\n      previousOffset = Number(offset);\n    }\n  }\n}\n\n// The position of the gradient line's starting point.\n// different from CSS side(to top) @see https://developer.mozilla.org/en-US/docs/Web/CSS/gradient/linear-gradient#values\nvar SideOrCornerToDegMap = {\n  left: 270 - 90,\n  top: 0 - 90,\n  bottom: 180 - 90,\n  right: 90 - 90,\n  'left top': 315 - 90,\n  'top left': 315 - 90,\n  'left bottom': 225 - 90,\n  'bottom left': 225 - 90,\n  'right top': 45 - 90,\n  'top right': 45 - 90,\n  'right bottom': 135 - 90,\n  'bottom right': 135 - 90\n};\nvar angleToDeg = memoize(function (orientation) {\n  var angle;\n  if (orientation.type === 'angular') {\n    angle = Number(orientation.value);\n  } else {\n    angle = SideOrCornerToDegMap[orientation.value] || 0;\n  }\n  return getOrCreateUnitValue(angle, 'deg');\n});\nvar positonToCSSUnitValue = memoize(function (position) {\n  var cx = 50;\n  var cy = 50;\n  var unitX = '%';\n  var unitY = '%';\n  if ((position === null || position === void 0 ? void 0 : position.type) === 'position') {\n    var _position$value = position.value,\n      x = _position$value.x,\n      y = _position$value.y;\n    if ((x === null || x === void 0 ? void 0 : x.type) === 'position-keyword') {\n      if (x.value === 'left') {\n        cx = 0;\n      } else if (x.value === 'center') {\n        cx = 50;\n      } else if (x.value === 'right') {\n        cx = 100;\n      } else if (x.value === 'top') {\n        cy = 0;\n      } else if (x.value === 'bottom') {\n        cy = 100;\n      }\n    }\n    if ((y === null || y === void 0 ? void 0 : y.type) === 'position-keyword') {\n      if (y.value === 'left') {\n        cx = 0;\n      } else if (y.value === 'center') {\n        cy = 50;\n      } else if (y.value === 'right') {\n        cx = 100;\n      } else if (y.value === 'top') {\n        cy = 0;\n      } else if (y.value === 'bottom') {\n        cy = 100;\n      }\n    }\n    if ((x === null || x === void 0 ? void 0 : x.type) === 'px' || (x === null || x === void 0 ? void 0 : x.type) === '%' || (x === null || x === void 0 ? void 0 : x.type) === 'em') {\n      unitX = x === null || x === void 0 ? void 0 : x.type;\n      cx = Number(x.value);\n    }\n    if ((y === null || y === void 0 ? void 0 : y.type) === 'px' || (y === null || y === void 0 ? void 0 : y.type) === '%' || (y === null || y === void 0 ? void 0 : y.type) === 'em') {\n      unitY = y === null || y === void 0 ? void 0 : y.type;\n      cy = Number(y.value);\n    }\n  }\n  return {\n    cx: getOrCreateUnitValue(cx, unitX),\n    cy: getOrCreateUnitValue(cy, unitY)\n  };\n});\nvar parseGradient = memoize(function (colorStr) {\n  if (colorStr.indexOf('linear') > -1 || colorStr.indexOf('radial') > -1) {\n    var ast = parseGradient$1(colorStr);\n    return ast.map(function (_ref) {\n      var type = _ref.type,\n        orientation = _ref.orientation,\n        colorStops = _ref.colorStops;\n      spaceColorStops(colorStops);\n      var steps = colorStops.map(function (colorStop) {\n        // TODO: only support % for now, should calc percentage of axis length when using px/em\n        return {\n          offset: getOrCreateUnitValue(Number(colorStop.length.value), '%'),\n          color: colorStopToString(colorStop)\n        };\n      });\n      if (type === 'linear-gradient') {\n        return new CSSGradientValue(GradientType.LinearGradient, {\n          angle: orientation ? angleToDeg(orientation) : Odeg,\n          steps: steps\n        });\n      }\n      if (type === 'radial-gradient') {\n        if (!orientation) {\n          orientation = [{\n            type: 'shape',\n            value: 'circle'\n          }];\n        }\n        if (orientation[0].type === 'shape' && orientation[0].value === 'circle') {\n          var _positonToCSSUnitValu = positonToCSSUnitValue(orientation[0].at),\n            cx = _positonToCSSUnitValu.cx,\n            cy = _positonToCSSUnitValu.cy;\n          var size;\n          if (orientation[0].style) {\n            var _orientation$0$style = orientation[0].style,\n              _type = _orientation$0$style.type,\n              value = _orientation$0$style.value;\n            if (_type === 'extent-keyword') {\n              size = getOrCreateKeyword(value);\n            } else {\n              size = getOrCreateUnitValue(value, _type);\n            }\n          }\n          return new CSSGradientValue(GradientType.RadialGradient, {\n            cx: cx,\n            cy: cy,\n            size: size,\n            steps: steps\n          });\n        }\n        // TODO: support ellipse shape\n        // TODO: repeating-linear-gradient & repeating-radial-gradient\n        // } else if (type === 'repeating-linear-gradient') {\n        // } else if (type === 'repeating-radial-gradient') {\n      }\n      return undefined;\n    });\n  }\n\n  // legacy format, should be deprecated later\n  var type = colorStr[0];\n  if (colorStr[1] === '(' || colorStr[2] === '(') {\n    if (type === 'l') {\n      var arr = regexLG.exec(colorStr);\n      if (arr) {\n        var _arr$2$match;\n        var steps = ((_arr$2$match = arr[2].match(regexColorStop)) === null || _arr$2$match === void 0 ? void 0 : _arr$2$match.map(function (stop) {\n          return stop.split(':');\n        })) || [];\n        return [new CSSGradientValue(GradientType.LinearGradient, {\n          angle: getOrCreateUnitValue(parseFloat(arr[1]), 'deg'),\n          steps: steps.map(function (_ref2) {\n            var _ref3 = _slicedToArray(_ref2, 2),\n              offset = _ref3[0],\n              color = _ref3[1];\n            return {\n              offset: getOrCreateUnitValue(Number(offset) * 100, '%'),\n              color: color\n            };\n          })\n        })];\n      }\n    } else if (type === 'r') {\n      var parsedRadialGradient = parseRadialGradient(colorStr);\n      if (parsedRadialGradient) {\n        if (isString(parsedRadialGradient)) {\n          colorStr = parsedRadialGradient;\n        } else {\n          return [new CSSGradientValue(GradientType.RadialGradient, parsedRadialGradient)];\n        }\n      }\n    } else if (type === 'p') {\n      return parsePattern(colorStr);\n    }\n  }\n});\nfunction parseRadialGradient(gradientStr) {\n  var arr = regexRG.exec(gradientStr);\n  if (arr) {\n    var _arr$4$match;\n    var steps = ((_arr$4$match = arr[4].match(regexColorStop)) === null || _arr$4$match === void 0 ? void 0 : _arr$4$match.map(function (stop) {\n      return stop.split(':');\n    })) || [];\n    return {\n      cx: getOrCreateUnitValue(50, '%'),\n      cy: getOrCreateUnitValue(50, '%'),\n      steps: steps.map(function (_ref4) {\n        var _ref5 = _slicedToArray(_ref4, 2),\n          offset = _ref5[0],\n          color = _ref5[1];\n        return {\n          offset: getOrCreateUnitValue(Number(offset) * 100, '%'),\n          color: color\n        };\n      })\n    };\n  }\n  return null;\n}\nfunction parsePattern(patternStr) {\n  var arr = regexPR.exec(patternStr);\n  if (arr) {\n    var repetition = arr[1];\n    var src = arr[2];\n    switch (repetition) {\n      case 'a':\n        repetition = 'repeat';\n        break;\n      case 'x':\n        repetition = 'repeat-x';\n        break;\n      case 'y':\n        repetition = 'repeat-y';\n        break;\n      case 'n':\n        repetition = 'no-repeat';\n        break;\n      default:\n        repetition = 'no-repeat';\n    }\n    return {\n      image: src,\n      // @ts-ignore\n      repetition: repetition\n    };\n  }\n  return null;\n}\n\n/**\n * @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createPattern\n */\n\nfunction isCSSGradientValue(object) {\n  return !!object.type && !!object.value;\n}\nfunction isPattern(object) {\n  return object && !!object.image;\n}\nfunction isCSSRGB(object) {\n  return object && !isNil(object.r) && !isNil(object.g) && !isNil(object.b);\n}\n\n/**\n * @see https://github.com/WebKit/WebKit/blob/main/Source/WebCore/css/parser/CSSParser.cpp#L97\n */\nvar parseColor = memoize(function (colorStr) {\n  if (isPattern(colorStr)) {\n    return _objectSpread({\n      repetition: 'repeat'\n    }, colorStr);\n  }\n  if (isNil(colorStr)) {\n    colorStr = '';\n  }\n  if (colorStr === 'transparent') {\n    // transparent black\n    return transparentColor;\n  }\n  if (colorStr === 'currentColor') {\n    // @see https://github.com/adobe-webplatform/Snap.svg/issues/526\n    colorStr = 'black';\n  } else if (colorStr === 'none') {\n    return noneColor;\n  }\n\n  // support CSS gradient syntax\n  var g = parseGradient(colorStr);\n  if (g) {\n    return g;\n  }\n\n  // constants\n  var color = d3.color(colorStr);\n  var rgba = [0, 0, 0, 0];\n  if (color !== null) {\n    rgba[0] = color.r || 0;\n    rgba[1] = color.g || 0;\n    rgba[2] = color.b || 0;\n    rgba[3] = color.opacity;\n  }\n\n  // return new CSSRGB(...rgba);\n  return getOrCreateRGBA.apply(void 0, rgba);\n});\nfunction mergeColors(left, right) {\n  // only support constant value, exclude gradient & pattern\n  if (!isCSSRGB(left) || !isCSSRGB(right)) {\n    return;\n  }\n  return [[Number(left.r), Number(left.g), Number(left.b), Number(left.alpha)], [Number(right.r), Number(right.g), Number(right.b), Number(right.alpha)], function (color) {\n    var rgba = color.slice();\n    if (rgba[3]) {\n      for (var i = 0; i < 3; i++) rgba[i] = Math.round(clamp(rgba[i], 0, 255));\n    }\n    rgba[3] = clamp(rgba[3], 0, 1);\n    return \"rgba(\".concat(rgba.join(','), \")\");\n  }];\n}\n\nfunction parseDimension(unitRegExp, string) {\n  if (isNil(string)) {\n    return getOrCreateUnitValue(0, 'px');\n  }\n  string = \"\".concat(string).trim().toLowerCase();\n  if (isFinite(Number(string))) {\n    if ('px'.search(unitRegExp) >= 0) {\n      return getOrCreateUnitValue(Number(string), 'px');\n    }\n    if ('deg'.search(unitRegExp) >= 0) {\n      return getOrCreateUnitValue(Number(string), 'deg');\n    }\n  }\n  var matchedUnits = [];\n  string = string.replace(unitRegExp, function (match) {\n    matchedUnits.push(match);\n    return \"U\".concat(match);\n  });\n  var taggedUnitRegExp = \"U(\".concat(unitRegExp.source, \")\");\n  return matchedUnits.map(function (unit) {\n    return getOrCreateUnitValue(Number(string.replace(new RegExp(\"U\".concat(unit), 'g'), '').replace(new RegExp(taggedUnitRegExp, 'g'), '*0')), unit);\n  })[0];\n}\n\n/**\n * <length>\n * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/length\n * length with only absolute unit, eg. 1px\n */\nvar parseLengthUnmemoize = function parseLengthUnmemoize(css) {\n  return parseDimension(new RegExp('px', 'g'), css);\n};\nvar parseLength = memoize(parseLengthUnmemoize);\n\n/**\n * <percentage>\n * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/percentage\n */\nvar parserPercentageUnmemoize = function parserPercentageUnmemoize(css) {\n  return parseDimension(new RegExp('%', 'g'), css);\n};\nmemoize(parserPercentageUnmemoize);\n\n/**\n * length with absolute or relative unit,\n * eg. 1px, 0.7em, 50%, calc(100% - 200px);\n *\n * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/length-percentage\n */\nvar parseLengthOrPercentageUnmemoize = function parseLengthOrPercentageUnmemoize(css) {\n  if (isNumber(css) || isFinite(Number(css))) {\n    // Number(css) is NaN\n    return getOrCreateUnitValue(Number(css) || 0, 'px');\n    // return Number(css);\n  }\n  return parseDimension(new RegExp('px|%|em|rem', 'g'), css);\n};\nvar parseLengthOrPercentage = memoize(parseLengthOrPercentageUnmemoize);\nvar parseAngleUnmemoize = function parseAngleUnmemoize(css) {\n  return parseDimension(new RegExp('deg|rad|grad|turn', 'g'), css);\n};\nvar parseAngle = memoize(parseAngleUnmemoize);\n\n/**\n * merge CSSUnitValue\n *\n * @example\n * 10px + 20px = 30px\n * 10deg + 10rad\n * 10% + 20% = 30%\n */\nfunction mergeDimensions(left, right, target, nonNegative) {\n  var index = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n  var unit = '';\n  var leftValue = left.value || 0;\n  var rightValue = right.value || 0;\n  var canonicalUnit = toCanonicalUnit(left.unit);\n  var leftCanonicalUnitValue = left.convertTo(canonicalUnit);\n  var rightCanonicalUnitValue = right.convertTo(canonicalUnit);\n  if (leftCanonicalUnitValue && rightCanonicalUnitValue) {\n    leftValue = leftCanonicalUnitValue.value;\n    rightValue = rightCanonicalUnitValue.value;\n    unit = unitTypeToString(left.unit);\n  }\n  // format '%' to 'px'\n  else if (CSSUnitValue.isLength(left.unit) || CSSUnitValue.isLength(right.unit)) {\n    leftValue = convertPercentUnit(left, index, target);\n    rightValue = convertPercentUnit(right, index, target);\n    unit = 'px';\n  }\n  return [leftValue, rightValue, function (value) {\n    if (nonNegative) {\n      value = Math.max(value, 0);\n    }\n    return value + unit;\n  }];\n}\nfunction convertAngleUnit(value) {\n  var deg = 0;\n  if (value.unit === UnitType.kDegrees) {\n    deg = value.value;\n  } else if (value.unit === UnitType.kRadians) {\n    deg = rad2deg(Number(value.value));\n  } else if (value.unit === UnitType.kTurns) {\n    deg = turn2deg(Number(value.value));\n  } else if (value.value) {\n    deg = value.value;\n  }\n  return deg;\n}\nfunction parseDimensionArrayFormat(string, size) {\n  var parsed;\n  if (Array.isArray(string)) {\n    // [1, '2px', 3]\n    parsed = string.map(function (segment) {\n      return Number(segment);\n    });\n  } else if (isString(string)) {\n    parsed = string.split(' ').map(function (segment) {\n      return Number(segment);\n    });\n  } else if (isNumber(string)) {\n    parsed = [string];\n  }\n  if (size === 2) {\n    if (parsed.length === 1) {\n      return [parsed[0], parsed[0]];\n    }\n    return [parsed[0], parsed[1]];\n  }\n  if (parsed.length === 1) {\n    return [parsed[0], parsed[0], parsed[0], parsed[0]];\n  }\n  if (parsed.length === 2) {\n    return [parsed[0], parsed[1], parsed[0], parsed[1]];\n  }\n  if (parsed.length === 3) {\n    return [parsed[0], parsed[1], parsed[2], parsed[1]];\n  }\n  return [parsed[0], parsed[1], parsed[2], parsed[3]];\n}\n\n// export function mergeDimensionList(\n//   left: CSSUnitValue[],\n//   right: CSSUnitValue[],\n//   target: IElement | null,\n// ): [number[], number[], (list: number[]) => string] | undefined {\n//   if (left.length !== right.length) {\n//     return;\n//   }\n\n//   const unit = left[0].unit;\n\n//   return [\n//     left.map((l) => l.value),\n//     right.map((l) => l.value),\n//     (values: number[]) => {\n//       return values.map((n) => new CSSUnitValue(n, unit)).join(' ');\n//     },\n//   ];\n// }\n\nfunction convertPercentUnit(valueWithUnit, vec3Index, target) {\n  var useMin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  if (valueWithUnit.unit === UnitType.kPixels) {\n    return Number(valueWithUnit.value);\n  }\n  if (valueWithUnit.unit === UnitType.kPercentage && target) {\n    var bounds = target.nodeName === Shape.GROUP ? target.getLocalBounds() : target.getGeometryBounds();\n    return (useMin ? bounds.min[vec3Index] : 0) + valueWithUnit.value / 100 * bounds.halfExtents[vec3Index] * 2;\n  }\n  return 0;\n}\n\nvar parseParam = function parseParam(css) {\n  return parseDimension(/deg|rad|grad|turn|px|%/g, css);\n};\nvar supportedFilters = ['blur', 'brightness', 'drop-shadow', 'contrast', 'grayscale', 'sepia', 'saturate', 'hue-rotate', 'invert'];\nfunction parseFilter() {\n  var filterStr = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  filterStr = filterStr.toLowerCase().trim();\n  if (filterStr === 'none') {\n    return [];\n  }\n  var filterRegExp = /\\s*([\\w-]+)\\(([^)]*)\\)/g;\n  var result = [];\n  var match;\n  var prevLastIndex = 0;\n  while (match = filterRegExp.exec(filterStr)) {\n    if (match.index !== prevLastIndex) {\n      return [];\n    }\n    prevLastIndex = match.index + match[0].length;\n    if (supportedFilters.indexOf(match[1]) > -1) {\n      result.push({\n        name: match[1],\n        params: match[2].split(' ').map(function (p) {\n          return parseParam(p) || parseColor(p);\n        })\n      });\n    }\n    if (filterRegExp.lastIndex === filterStr.length) {\n      return result;\n    }\n  }\n  return [];\n}\n\nfunction numberToString(x) {\n  // scale(0.00000001) -> scale(0)\n  // return x.toFixed(6).replace(/0+$/, '').replace(/\\.$/, '');\n  return x.toString();\n}\n\n/**\n * parse string or number to CSSUnitValue(numeric)\n *\n * eg.\n * * 0 -> CSSUnitValue(0)\n * * '2' -> CSSUnitValue(2)\n */\nvar parseNumberUnmemoize = function parseNumberUnmemoize(string) {\n  if (typeof string === 'number') {\n    return getOrCreateUnitValue(string);\n  }\n  if (/^\\s*[-+]?(\\d*\\.)?\\d+\\s*$/.test(string)) {\n    return getOrCreateUnitValue(Number(string));\n  }\n  return getOrCreateUnitValue(0);\n};\nvar parseNumber = memoize(parseNumberUnmemoize);\nmemoize(function (string) {\n  if (isString(string)) {\n    return string.split(' ').map(parseNumber);\n  }\n  return string.map(parseNumber);\n});\nfunction mergeNumbers(left, right) {\n  return [left, right, numberToString];\n}\nfunction clampedMergeNumbers(min, max) {\n  return function (left, right) {\n    return [left, right, function (x) {\n      return numberToString(clamp(x, min, max));\n    }];\n  };\n}\nfunction mergeNumberLists(left, right) {\n  if (left.length !== right.length) {\n    return;\n  }\n  return [left, right, function (numberList) {\n    return numberList;\n  }];\n}\n\nfunction getOrCalculatePathTotalLength(path) {\n  if (path.parsedStyle.d.totalLength === 0) {\n    path.parsedStyle.d.totalLength = getTotalLength(path.parsedStyle.d.absolutePath);\n  }\n  return path.parsedStyle.d.totalLength;\n}\nfunction getOrCalculatePolylineTotalLength(polyline) {\n  if (polyline.parsedStyle.points.totalLength === 0) {\n    polyline.parsedStyle.points.totalLength = polylineLength(polyline.parsedStyle.points.points);\n  }\n  return polyline.parsedStyle.points.totalLength;\n}\nfunction removeRedundantMCommand(path) {\n  for (var i = 0; i < path.length; i++) {\n    var prevSegment = path[i - 1];\n    var segment = path[i];\n    var cmd = segment[0];\n    if (cmd === 'M') {\n      if (prevSegment) {\n        var prevCmd = prevSegment[0];\n        var srcPoint = [segment[1], segment[2]];\n        var destPoint = void 0;\n        if (prevCmd === 'L' || prevCmd === 'M') {\n          destPoint = [prevSegment[1], prevSegment[2]];\n        } else if (prevCmd === 'C' || prevCmd === 'A' || prevCmd === 'Q') {\n          destPoint = [prevSegment[prevSegment.length - 2], prevSegment[prevSegment.length - 1]];\n        }\n        if (destPoint && isSamePoint(srcPoint, destPoint)) {\n          path.splice(i, 1);\n          i--;\n        }\n      }\n    }\n  }\n}\nfunction hasArcOrBezier(path) {\n  var hasArc = false;\n  var count = path.length;\n  for (var i = 0; i < count; i++) {\n    var params = path[i];\n    var cmd = params[0];\n    if (cmd === 'C' || cmd === 'A' || cmd === 'Q') {\n      hasArc = true;\n      break;\n    }\n  }\n  return hasArc;\n}\nfunction extractPolygons(pathArray) {\n  var polygons = [];\n  var polylines = [];\n  var points = []; // 防止第一个命令不是 'M'\n  for (var i = 0; i < pathArray.length; i++) {\n    var params = pathArray[i];\n    var cmd = params[0];\n    if (cmd === 'M') {\n      // 遇到 'M' 判定是否是新数组，新数组中没有点\n      if (points.length) {\n        // 如果存在点，则说明没有遇到 'Z'，开始了一个新的多边形\n        polylines.push(points);\n        points = []; // 创建新的点\n      }\n      points.push([params[1], params[2]]);\n    } else if (cmd === 'Z') {\n      if (points.length) {\n        // 存在点\n        polygons.push(points);\n        points = []; // 开始新的点集合\n      }\n      // 如果不存在点，同时 'Z'，则说明是错误，不处理\n    } else {\n      points.push([params[1], params[2]]);\n    }\n  }\n  // 说明 points 未放入 polygons 或者 polyline\n  // 仅当只有一个 M，没有 Z 时会发生这种情况\n  if (points.length > 0) {\n    polylines.push(points);\n  }\n  return {\n    polygons: polygons,\n    polylines: polylines\n  };\n}\nfunction isSamePoint(point1, point2) {\n  return point1[0] === point2[0] && point1[1] === point2[1];\n}\nfunction getPathBBox(segments, lineWidth) {\n  var xArr = [];\n  var yArr = [];\n  var segmentsWithAngle = [];\n  for (var i = 0; i < segments.length; i++) {\n    var segment = segments[i];\n    var currentPoint = segment.currentPoint,\n      params = segment.params,\n      prePoint = segment.prePoint;\n    var box = void 0;\n    switch (segment.command) {\n      case 'Q':\n        box = quadBox(prePoint[0], prePoint[1], params[1], params[2], params[3], params[4]);\n        break;\n      case 'C':\n        box = cubicBox(prePoint[0], prePoint[1], params[1], params[2], params[3], params[4], params[5], params[6]);\n        break;\n      case 'A':\n        var arcParams = segment.arcParams;\n        box = arcBox(arcParams.cx, arcParams.cy, arcParams.rx, arcParams.ry, arcParams.xRotation, arcParams.startAngle, arcParams.endAngle);\n        break;\n      default:\n        xArr.push(currentPoint[0]);\n        yArr.push(currentPoint[1]);\n        break;\n    }\n    if (box) {\n      segment.box = box;\n      xArr.push(box.x, box.x + box.width);\n      yArr.push(box.y, box.y + box.height);\n    }\n    if (lineWidth && (segment.command === 'L' || segment.command === 'M') && segment.prePoint && segment.nextPoint) {\n      segmentsWithAngle.push(segment);\n    }\n  }\n  // bbox calculation should ignore NaN for path attribute\n  // ref: https://github.com/antvis/g/issues/210\n  // ref: https://github.com/antvis/G2/issues/3109\n  xArr = xArr.filter(function (item) {\n    return !Number.isNaN(item) && item !== Infinity && item !== -Infinity;\n  });\n  yArr = yArr.filter(function (item) {\n    return !Number.isNaN(item) && item !== Infinity && item !== -Infinity;\n  });\n  var minX = min(xArr);\n  var minY = min(yArr);\n  var maxX = max(xArr);\n  var maxY = max(yArr);\n  if (segmentsWithAngle.length === 0) {\n    return {\n      x: minX,\n      y: minY,\n      width: maxX - minX,\n      height: maxY - minY\n    };\n  }\n  for (var _i = 0; _i < segmentsWithAngle.length; _i++) {\n    var _segment = segmentsWithAngle[_i];\n    var _currentPoint = _segment.currentPoint;\n    var extra = void 0;\n    if (_currentPoint[0] === minX) {\n      extra = getExtraFromSegmentWithAngle(_segment, lineWidth);\n      minX -= extra.xExtra;\n    } else if (_currentPoint[0] === maxX) {\n      extra = getExtraFromSegmentWithAngle(_segment, lineWidth);\n      maxX += extra.xExtra;\n    }\n    if (_currentPoint[1] === minY) {\n      extra = getExtraFromSegmentWithAngle(_segment, lineWidth);\n      minY -= extra.yExtra;\n    } else if (_currentPoint[1] === maxY) {\n      extra = getExtraFromSegmentWithAngle(_segment, lineWidth);\n      maxY += extra.yExtra;\n    }\n  }\n  return {\n    x: minX,\n    y: minY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\nfunction getExtraFromSegmentWithAngle(segment, lineWidth) {\n  var prePoint = segment.prePoint,\n    currentPoint = segment.currentPoint,\n    nextPoint = segment.nextPoint;\n  var currentAndPre = Math.pow(currentPoint[0] - prePoint[0], 2) + Math.pow(currentPoint[1] - prePoint[1], 2);\n  var currentAndNext = Math.pow(currentPoint[0] - nextPoint[0], 2) + Math.pow(currentPoint[1] - nextPoint[1], 2);\n  var preAndNext = Math.pow(prePoint[0] - nextPoint[0], 2) + Math.pow(prePoint[1] - nextPoint[1], 2);\n  // 以 currentPoint 为顶点的夹角\n  var currentAngle = Math.acos((currentAndPre + currentAndNext - preAndNext) / (2 * Math.sqrt(currentAndPre) * Math.sqrt(currentAndNext)));\n  // 夹角为空、 0 或 PI 时，不需要计算夹角处的额外宽度\n  // 注意: 由于计算精度问题，夹角为 0 的情况计算出来的角度可能是一个很小的值，还需要判断其与 0 是否近似相等\n  if (!currentAngle || Math.sin(currentAngle) === 0 || isNumberEqual(currentAngle, 0)) {\n    return {\n      xExtra: 0,\n      yExtra: 0\n    };\n  }\n  var xAngle = Math.abs(Math.atan2(nextPoint[1] - currentPoint[1], nextPoint[0] - currentPoint[0]));\n  var yAngle = Math.abs(Math.atan2(nextPoint[0] - currentPoint[0], nextPoint[1] - currentPoint[1]));\n  // 将夹角转为锐角\n  xAngle = xAngle > Math.PI / 2 ? Math.PI - xAngle : xAngle;\n  yAngle = yAngle > Math.PI / 2 ? Math.PI - yAngle : yAngle;\n  // 这里不考虑在水平和垂直方向的投影，直接使用最大差值\n  // 由于上层统一加减了二分之一线宽，这里需要进行弥补\n  var extra = {\n    // 水平方向投影\n    xExtra: Math.cos(currentAngle / 2 - xAngle) * (lineWidth / 2 * (1 / Math.sin(currentAngle / 2))) - lineWidth / 2 || 0,\n    // 垂直方向投影\n    yExtra: Math.cos(yAngle - currentAngle / 2) * (lineWidth / 2 * (1 / Math.sin(currentAngle / 2))) - lineWidth / 2 || 0\n  };\n  return extra;\n}\n\n// 点对称\nfunction toSymmetry(point, center) {\n  return [center[0] + (center[0] - point[0]), center[1] + (center[1] - point[1])];\n}\nvar angleBetween = function angleBetween(v0, v1) {\n  var p = v0.x * v1.x + v0.y * v1.y;\n  var n = Math.sqrt((Math.pow(v0.x, 2) + Math.pow(v0.y, 2)) * (Math.pow(v1.x, 2) + Math.pow(v1.y, 2)));\n  var sign = v0.x * v1.y - v0.y * v1.x < 0 ? -1 : 1;\n  var angle = sign * Math.acos(p / n);\n  return angle;\n};\n/**\n * @see https://github.com/rveciana/svg-path-properties/blob/b6bd9a322966f6ef7a311872d80c56e3718de861/src/arc.ts#L121\n */\nvar pointOnEllipticalArc = function pointOnEllipticalArc(p0, rx, ry, xAxisRotation, largeArcFlag, sweepFlag, p1, t) {\n  // In accordance to: http://www.w3.org/TR/SVG/implnote.html#ArcOutOfRangeParameters\n  rx = Math.abs(rx);\n  ry = Math.abs(ry);\n  xAxisRotation = mod(xAxisRotation, 360);\n  var xAxisRotationRadians = deg2rad(xAxisRotation);\n  // If the endpoints are identical, then this is equivalent to omitting the elliptical arc segment entirely.\n  if (p0.x === p1.x && p0.y === p1.y) {\n    return {\n      x: p0.x,\n      y: p0.y,\n      ellipticalArcAngle: 0\n    }; // Check if angle is correct\n  }\n\n  // If rx = 0 or ry = 0 then this arc is treated as a straight line segment joining the endpoints.\n  if (rx === 0 || ry === 0) {\n    // return this.pointOnLine(p0, p1, t);\n    return {\n      x: 0,\n      y: 0,\n      ellipticalArcAngle: 0\n    }; // Check if angle is correct\n  }\n\n  // Following \"Conversion from endpoint to center parameterization\"\n  // http://www.w3.org/TR/SVG/implnote.html#ArcConversionEndpointToCenter\n\n  // Step #1: Compute transformedPoint\n  var dx = (p0.x - p1.x) / 2;\n  var dy = (p0.y - p1.y) / 2;\n  var transformedPoint = {\n    x: Math.cos(xAxisRotationRadians) * dx + Math.sin(xAxisRotationRadians) * dy,\n    y: -Math.sin(xAxisRotationRadians) * dx + Math.cos(xAxisRotationRadians) * dy\n  };\n  // Ensure radii are large enough\n  var radiiCheck = Math.pow(transformedPoint.x, 2) / Math.pow(rx, 2) + Math.pow(transformedPoint.y, 2) / Math.pow(ry, 2);\n  if (radiiCheck > 1) {\n    rx *= Math.sqrt(radiiCheck);\n    ry *= Math.sqrt(radiiCheck);\n  }\n\n  // Step #2: Compute transformedCenter\n  var cSquareNumerator = Math.pow(rx, 2) * Math.pow(ry, 2) - Math.pow(rx, 2) * Math.pow(transformedPoint.y, 2) - Math.pow(ry, 2) * Math.pow(transformedPoint.x, 2);\n  var cSquareRootDenom = Math.pow(rx, 2) * Math.pow(transformedPoint.y, 2) + Math.pow(ry, 2) * Math.pow(transformedPoint.x, 2);\n  var cRadicand = cSquareNumerator / cSquareRootDenom;\n  // Make sure this never drops below zero because of precision\n  cRadicand = cRadicand < 0 ? 0 : cRadicand;\n  var cCoef = (largeArcFlag !== sweepFlag ? 1 : -1) * Math.sqrt(cRadicand);\n  var transformedCenter = {\n    x: cCoef * (rx * transformedPoint.y / ry),\n    y: cCoef * (-(ry * transformedPoint.x) / rx)\n  };\n\n  // Step #3: Compute center\n  var center = {\n    x: Math.cos(xAxisRotationRadians) * transformedCenter.x - Math.sin(xAxisRotationRadians) * transformedCenter.y + (p0.x + p1.x) / 2,\n    y: Math.sin(xAxisRotationRadians) * transformedCenter.x + Math.cos(xAxisRotationRadians) * transformedCenter.y + (p0.y + p1.y) / 2\n  };\n\n  // Step #4: Compute start/sweep angles\n  // Start angle of the elliptical arc prior to the stretch and rotate operations.\n  // Difference between the start and end angles\n  var startVector = {\n    x: (transformedPoint.x - transformedCenter.x) / rx,\n    y: (transformedPoint.y - transformedCenter.y) / ry\n  };\n  var startAngle = angleBetween({\n    x: 1,\n    y: 0\n  }, startVector);\n  var endVector = {\n    x: (-transformedPoint.x - transformedCenter.x) / rx,\n    y: (-transformedPoint.y - transformedCenter.y) / ry\n  };\n  var sweepAngle = angleBetween(startVector, endVector);\n  if (!sweepFlag && sweepAngle > 0) {\n    sweepAngle -= 2 * Math.PI;\n  } else if (sweepFlag && sweepAngle < 0) {\n    sweepAngle += 2 * Math.PI;\n  }\n  // We use % instead of `mod(..)` because we want it to be -360deg to 360deg(but actually in radians)\n  sweepAngle %= 2 * Math.PI;\n\n  // From http://www.w3.org/TR/SVG/implnote.html#ArcParameterizationAlternatives\n  var angle = startAngle + sweepAngle * t;\n  var ellipseComponentX = rx * Math.cos(angle);\n  var ellipseComponentY = ry * Math.sin(angle);\n  var point = {\n    x: Math.cos(xAxisRotationRadians) * ellipseComponentX - Math.sin(xAxisRotationRadians) * ellipseComponentY + center.x,\n    y: Math.sin(xAxisRotationRadians) * ellipseComponentX + Math.cos(xAxisRotationRadians) * ellipseComponentY + center.y,\n    ellipticalArcStartAngle: startAngle,\n    ellipticalArcEndAngle: startAngle + sweepAngle,\n    ellipticalArcAngle: angle,\n    ellipticalArcCenter: center,\n    resultantRx: rx,\n    resultantRy: ry\n  };\n  return point;\n};\nfunction path2Segments(path) {\n  var segments = [];\n  var currentPoint = null; // 当前图形\n  var nextParams = null; // 下一节点的 path 参数\n  var startMovePoint = null; // 开始 M 的点，可能会有多个\n  var lastStartMovePointIndex = 0; // 最近一个开始点 M 的索引\n  var count = path.length;\n  for (var i = 0; i < count; i++) {\n    var params = path[i];\n    nextParams = path[i + 1];\n    var command = params[0];\n    // 数学定义上的参数，便于后面的计算\n    var segment = {\n      command: command,\n      prePoint: currentPoint,\n      params: params,\n      startTangent: null,\n      endTangent: null,\n      currentPoint: null,\n      nextPoint: null,\n      arcParams: null,\n      box: null,\n      cubicParams: null\n    };\n    switch (command) {\n      case 'M':\n        startMovePoint = [params[1], params[2]];\n        lastStartMovePointIndex = i;\n        break;\n      case 'A':\n        var arcParams = getArcParams(currentPoint, params);\n        segment.arcParams = arcParams;\n        break;\n    }\n    if (command === 'Z') {\n      // 有了 Z 后，当前节点从开始 M 的点开始\n      currentPoint = startMovePoint;\n      // 如果当前点的命令为 Z，相当于当前点为最近一个 M 点，则下一个点直接指向最近一个 M 点的下一个点\n      nextParams = path[lastStartMovePointIndex + 1];\n    } else {\n      var len = params.length;\n      currentPoint = [params[len - 2], params[len - 1]];\n    }\n    if (nextParams && nextParams[0] === 'Z') {\n      // 如果下一个点的命令为 Z，则下一个点直接指向最近一个 M 点\n      nextParams = path[lastStartMovePointIndex];\n      if (segments[lastStartMovePointIndex]) {\n        // 如果下一个点的命令为 Z，则最近一个 M 点的前一个点为当前点\n        segments[lastStartMovePointIndex].prePoint = currentPoint;\n      }\n    }\n    segment.currentPoint = currentPoint;\n    // 如果当前点与最近一个 M 点相同，则最近一个 M 点的前一个点为当前点的前一个点\n    if (segments[lastStartMovePointIndex] && isSamePoint(currentPoint, segments[lastStartMovePointIndex].currentPoint)) {\n      segments[lastStartMovePointIndex].prePoint = segment.prePoint;\n    }\n    var nextPoint = nextParams ? [nextParams[nextParams.length - 2], nextParams[nextParams.length - 1]] : null;\n    segment.nextPoint = nextPoint;\n    // Add startTangent and endTangent\n    var prePoint = segment.prePoint;\n    if (['L', 'H', 'V'].includes(command)) {\n      segment.startTangent = [prePoint[0] - currentPoint[0], prePoint[1] - currentPoint[1]];\n      segment.endTangent = [currentPoint[0] - prePoint[0], currentPoint[1] - prePoint[1]];\n    } else if (command === 'Q') {\n      // 二次贝塞尔曲线只有一个控制点\n      var cp = [params[1], params[2]];\n      // 二次贝塞尔曲线的终点为 currentPoint\n      segment.startTangent = [prePoint[0] - cp[0], prePoint[1] - cp[1]];\n      segment.endTangent = [currentPoint[0] - cp[0], currentPoint[1] - cp[1]];\n    } else if (command === 'T') {\n      var preSegment = segments[i - 1];\n      var _cp = toSymmetry(preSegment.currentPoint, prePoint);\n      if (preSegment.command === 'Q') {\n        segment.command = 'Q';\n        segment.startTangent = [prePoint[0] - _cp[0], prePoint[1] - _cp[1]];\n        segment.endTangent = [currentPoint[0] - _cp[0], currentPoint[1] - _cp[1]];\n      } else {\n        // @ts-ignore\n        segment.command = 'TL';\n        segment.startTangent = [prePoint[0] - currentPoint[0], prePoint[1] - currentPoint[1]];\n        segment.endTangent = [currentPoint[0] - prePoint[0], currentPoint[1] - prePoint[1]];\n      }\n    } else if (command === 'C') {\n      // 三次贝塞尔曲线有两个控制点\n      var cp1 = [params[1], params[2]];\n      var cp2 = [params[3], params[4]];\n      segment.startTangent = [prePoint[0] - cp1[0], prePoint[1] - cp1[1]];\n      segment.endTangent = [currentPoint[0] - cp2[0], currentPoint[1] - cp2[1]];\n\n      // horizontal line, eg. ['C', 100, 100, 100, 100, 200, 200]\n      if (segment.startTangent[0] === 0 && segment.startTangent[1] === 0) {\n        segment.startTangent = [cp1[0] - cp2[0], cp1[1] - cp2[1]];\n      }\n      if (segment.endTangent[0] === 0 && segment.endTangent[1] === 0) {\n        segment.endTangent = [cp2[0] - cp1[0], cp2[1] - cp1[1]];\n      }\n    } else if (command === 'S') {\n      var _preSegment = segments[i - 1];\n      var _cp2 = toSymmetry(_preSegment.currentPoint, prePoint);\n      var _cp3 = [params[1], params[2]];\n      if (_preSegment.command === 'C') {\n        segment.command = 'C'; // 将 S 命令变换为 C 命令\n        segment.startTangent = [prePoint[0] - _cp2[0], prePoint[1] - _cp2[1]];\n        segment.endTangent = [currentPoint[0] - _cp3[0], currentPoint[1] - _cp3[1]];\n      } else {\n        // @ts-ignore\n        segment.command = 'SQ'; // 将 S 命令变换为 SQ 命令\n        segment.startTangent = [prePoint[0] - _cp3[0], prePoint[1] - _cp3[1]];\n        segment.endTangent = [currentPoint[0] - _cp3[0], currentPoint[1] - _cp3[1]];\n      }\n    } else if (command === 'A') {\n      var _getTangentAtRatio = getTangentAtRatio(segment, 0),\n        dx1 = _getTangentAtRatio.x,\n        dy1 = _getTangentAtRatio.y;\n      var _getTangentAtRatio2 = getTangentAtRatio(segment, 1, false),\n        dx2 = _getTangentAtRatio2.x,\n        dy2 = _getTangentAtRatio2.y;\n      segment.startTangent = [dx1, dy1];\n      segment.endTangent = [dx2, dy2];\n    }\n    segments.push(segment);\n  }\n  return segments;\n}\n\n/**\n * Use length instead of ratio\n */\nfunction getTangentAtRatio(segment, ratio) {\n  var sign = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var _segment$arcParams = segment.arcParams,\n    _segment$arcParams$rx = _segment$arcParams.rx,\n    rx = _segment$arcParams$rx === void 0 ? 0 : _segment$arcParams$rx,\n    _segment$arcParams$ry = _segment$arcParams.ry,\n    ry = _segment$arcParams$ry === void 0 ? 0 : _segment$arcParams$ry,\n    xRotation = _segment$arcParams.xRotation,\n    arcFlag = _segment$arcParams.arcFlag,\n    sweepFlag = _segment$arcParams.sweepFlag;\n  var p1 = pointOnEllipticalArc({\n    x: segment.prePoint[0],\n    y: segment.prePoint[1]\n  }, rx, ry, xRotation, !!arcFlag, !!sweepFlag, {\n    x: segment.currentPoint[0],\n    y: segment.currentPoint[1]\n  }, ratio);\n  var p2 = pointOnEllipticalArc({\n    x: segment.prePoint[0],\n    y: segment.prePoint[1]\n  }, rx, ry, xRotation, !!arcFlag, !!sweepFlag, {\n    x: segment.currentPoint[0],\n    y: segment.currentPoint[1]\n  }, sign ? ratio + 0.005 : ratio - 0.005);\n  var xDist = p2.x - p1.x;\n  var yDist = p2.y - p1.y;\n  var dist = Math.sqrt(xDist * xDist + yDist * yDist);\n  return {\n    x: -xDist / dist,\n    y: -yDist / dist\n  };\n}\n\n// 向量长度\nfunction vMag(v) {\n  return Math.sqrt(v[0] * v[0] + v[1] * v[1]);\n}\n\n// u.v/|u||v|，计算夹角的余弦值\nfunction vRatio(u, v) {\n  // 当存在一个向量的长度为 0 时，夹角也为 0，即夹角的余弦值为 1\n  return vMag(u) * vMag(v) ? (u[0] * v[0] + u[1] * v[1]) / (vMag(u) * vMag(v)) : 1;\n}\n\n// 向量角度\nfunction vAngle(u, v) {\n  return (u[0] * v[1] < u[1] * v[0] ? -1 : 1) * Math.acos(vRatio(u, v));\n}\nfunction getArcParams(startPoint, params) {\n  var rx = params[1];\n  var ry = params[2];\n  var xRotation = mod(deg2rad(params[3]), Math.PI * 2);\n  var arcFlag = params[4];\n  var sweepFlag = params[5];\n  // 弧形起点坐标\n  var x1 = startPoint[0];\n  var y1 = startPoint[1];\n  // 弧形终点坐标\n  var x2 = params[6];\n  var y2 = params[7];\n  var xp = Math.cos(xRotation) * (x1 - x2) / 2.0 + Math.sin(xRotation) * (y1 - y2) / 2.0;\n  var yp = -1 * Math.sin(xRotation) * (x1 - x2) / 2.0 + Math.cos(xRotation) * (y1 - y2) / 2.0;\n  var lambda = xp * xp / (rx * rx) + yp * yp / (ry * ry);\n  if (lambda > 1) {\n    rx *= Math.sqrt(lambda);\n    ry *= Math.sqrt(lambda);\n  }\n  var diff = rx * rx * (yp * yp) + ry * ry * (xp * xp);\n  var f = diff ? Math.sqrt((rx * rx * (ry * ry) - diff) / diff) : 1;\n  if (arcFlag === sweepFlag) {\n    f *= -1;\n  }\n  if (isNaN(f)) {\n    f = 0;\n  }\n\n  // 旋转前的起点坐标，且当长半轴和短半轴的长度为 0 时，坐标按 (0, 0) 处理\n  var cxp = ry ? f * rx * yp / ry : 0;\n  var cyp = rx ? f * -ry * xp / rx : 0;\n\n  // 椭圆圆心坐标\n  var cx = (x1 + x2) / 2.0 + Math.cos(xRotation) * cxp - Math.sin(xRotation) * cyp;\n  var cy = (y1 + y2) / 2.0 + Math.sin(xRotation) * cxp + Math.cos(xRotation) * cyp;\n\n  // 起始点的单位向量\n  var u = [(xp - cxp) / rx, (yp - cyp) / ry];\n  // 终止点的单位向量\n  var v = [(-1 * xp - cxp) / rx, (-1 * yp - cyp) / ry];\n  // 计算起始点和圆心的连线，与 x 轴正方向的夹角\n  var theta = vAngle([1, 0], u);\n\n  // 计算圆弧起始点和终止点与椭圆圆心连线的夹角\n  var dTheta = vAngle(u, v);\n  if (vRatio(u, v) <= -1) {\n    dTheta = Math.PI;\n  }\n  if (vRatio(u, v) >= 1) {\n    dTheta = 0;\n  }\n  if (sweepFlag === 0 && dTheta > 0) {\n    dTheta -= 2 * Math.PI;\n  }\n  if (sweepFlag === 1 && dTheta < 0) {\n    dTheta += 2 * Math.PI;\n  }\n  return {\n    cx: cx,\n    cy: cy,\n    // 弧形的起点和终点相同时，长轴和短轴的长度按 0 处理\n    rx: isSamePoint(startPoint, [x2, y2]) ? 0 : rx,\n    ry: isSamePoint(startPoint, [x2, y2]) ? 0 : ry,\n    startAngle: theta,\n    endAngle: theta + dTheta,\n    xRotation: xRotation,\n    arcFlag: arcFlag,\n    sweepFlag: sweepFlag\n  };\n}\nfunction commandsToPathString(commands, object, transform) {\n  return commands.reduce(function (prev, cur) {\n    var path = '';\n    if (cur[0] === 'M' || cur[0] === 'L') {\n      var p = vec3.fromValues(cur[1], cur[2], 0);\n      if (transform) {\n        vec3.transformMat4(p, p, transform);\n      }\n      path = \"\".concat(cur[0]).concat(p[0], \",\").concat(p[1]);\n    } else if (cur[0] === 'Z') {\n      path = cur[0];\n    } else if (cur[0] === 'C') {\n      var p1 = vec3.fromValues(cur[1], cur[2], 0);\n      var p2 = vec3.fromValues(cur[3], cur[4], 0);\n      var p3 = vec3.fromValues(cur[5], cur[6], 0);\n      if (transform) {\n        vec3.transformMat4(p1, p1, transform);\n        vec3.transformMat4(p2, p2, transform);\n        vec3.transformMat4(p3, p3, transform);\n      }\n      path = \"\".concat(cur[0]).concat(p1[0], \",\").concat(p1[1], \",\").concat(p2[0], \",\").concat(p2[1], \",\").concat(p3[0], \",\").concat(p3[1]);\n    } else if (cur[0] === 'A') {\n      var c = vec3.fromValues(cur[6], cur[7], 0);\n      if (transform) {\n        vec3.transformMat4(c, c, transform);\n      }\n      path = \"\".concat(cur[0]).concat(cur[1], \",\").concat(cur[2], \",\").concat(cur[3], \",\").concat(cur[4], \",\").concat(cur[5], \",\").concat(c[0], \",\").concat(c[1]);\n    } else if (cur[0] === 'Q') {\n      var _p = vec3.fromValues(cur[1], cur[2], 0);\n      var _p2 = vec3.fromValues(cur[3], cur[4], 0);\n      if (transform) {\n        vec3.transformMat4(_p, _p, transform);\n        vec3.transformMat4(_p2, _p2, transform);\n      }\n      path = \"\".concat(cur[0]).concat(cur[1], \",\").concat(cur[2], \",\").concat(cur[3], \",\").concat(cur[4], \"}\");\n    }\n    return prev += path;\n  }, '');\n}\nfunction lineToCommands(x1, y1, x2, y2) {\n  return [['M', x1, y1], ['L', x2, y2]];\n}\nfunction ellipseToCommands(rx, ry, cx, cy) {\n  var factor = (-1 + Math.sqrt(2)) / 3 * 4;\n  var dx = rx * factor;\n  var dy = ry * factor;\n  var left = cx - rx;\n  var right = cx + rx;\n  var top = cy - ry;\n  var bottom = cy + ry;\n  return [['M', left, cy], ['C', left, cy - dy, cx - dx, top, cx, top], ['C', cx + dx, top, right, cy - dy, right, cy], ['C', right, cy + dy, cx + dx, bottom, cx, bottom], ['C', cx - dx, bottom, left, cy + dy, left, cy], ['Z']];\n}\nfunction polygonToCommands(points, closed) {\n  var result = points.map(function (point, i) {\n    return [i === 0 ? 'M' : 'L', point[0], point[1]];\n  });\n  if (closed) {\n    result.push(['Z']);\n  }\n  return result;\n}\nfunction rectToCommands(width, height, x, y, radius) {\n  // @see https://gist.github.com/danielpquinn/dd966af424030d47e476\n  if (radius) {\n    var _radius = _slicedToArray(radius, 4),\n      tlr = _radius[0],\n      trr = _radius[1],\n      brr = _radius[2],\n      blr = _radius[3];\n    var signX = width > 0 ? 1 : -1;\n    var signY = height > 0 ? 1 : -1;\n    // sweep-flag @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Tutorial/Paths#arcs\n    var sweepFlag = signX + signY !== 0 ? 1 : 0;\n    return [['M', signX * tlr + x, y], ['L', width - signX * trr + x, y], trr ? ['A', trr, trr, 0, 0, sweepFlag, width + x, signY * trr + y] : null, ['L', width + x, height - signY * brr + y], brr ? ['A', brr, brr, 0, 0, sweepFlag, width + x - signX * brr, height + y] : null, ['L', x + signX * blr, height + y], blr ? ['A', blr, blr, 0, 0, sweepFlag, x, height + y - signY * blr] : null, ['L', x, signY * tlr + y], tlr ? ['A', tlr, tlr, 0, 0, sweepFlag, signX * tlr + x, y] : null, ['Z']].filter(function (command) {\n      return command;\n    });\n  }\n  return [['M', x, y], ['L', x + width, y], ['L', x + width, y + height], ['L', x, y + height], ['Z']];\n}\n\n/**\n * convert object to path, should account for:\n * * transform & origin\n * * lineWidth\n */\nfunction convertToPath(object) {\n  var transform = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : object.getLocalTransform();\n  var commands = [];\n  switch (object.nodeName) {\n    case Shape.LINE:\n      var _parsedStyle = object.parsedStyle,\n        _parsedStyle$x = _parsedStyle.x1,\n        x1 = _parsedStyle$x === void 0 ? 0 : _parsedStyle$x,\n        _parsedStyle$y = _parsedStyle.y1,\n        y1 = _parsedStyle$y === void 0 ? 0 : _parsedStyle$y,\n        _parsedStyle$x2 = _parsedStyle.x2,\n        x2 = _parsedStyle$x2 === void 0 ? 0 : _parsedStyle$x2,\n        _parsedStyle$y2 = _parsedStyle.y2,\n        y2 = _parsedStyle$y2 === void 0 ? 0 : _parsedStyle$y2;\n      commands = lineToCommands(x1, y1, x2, y2);\n      break;\n    case Shape.CIRCLE:\n      {\n        var _parsedStyle2 = object.parsedStyle,\n          _parsedStyle2$r = _parsedStyle2.r,\n          r = _parsedStyle2$r === void 0 ? 0 : _parsedStyle2$r,\n          _parsedStyle2$cx = _parsedStyle2.cx,\n          cx = _parsedStyle2$cx === void 0 ? 0 : _parsedStyle2$cx,\n          _parsedStyle2$cy = _parsedStyle2.cy,\n          cy = _parsedStyle2$cy === void 0 ? 0 : _parsedStyle2$cy;\n        commands = ellipseToCommands(r, r, cx, cy);\n        break;\n      }\n    case Shape.ELLIPSE:\n      {\n        var _parsedStyle3 = object.parsedStyle,\n          _parsedStyle3$rx = _parsedStyle3.rx,\n          rx = _parsedStyle3$rx === void 0 ? 0 : _parsedStyle3$rx,\n          _parsedStyle3$ry = _parsedStyle3.ry,\n          ry = _parsedStyle3$ry === void 0 ? 0 : _parsedStyle3$ry,\n          _parsedStyle3$cx = _parsedStyle3.cx,\n          _cx = _parsedStyle3$cx === void 0 ? 0 : _parsedStyle3$cx,\n          _parsedStyle3$cy = _parsedStyle3.cy,\n          _cy = _parsedStyle3$cy === void 0 ? 0 : _parsedStyle3$cy;\n        commands = ellipseToCommands(rx, ry, _cx, _cy);\n        break;\n      }\n    case Shape.POLYLINE:\n    case Shape.POLYGON:\n      var points = object.parsedStyle.points;\n      commands = polygonToCommands(points.points, object.nodeName === Shape.POLYGON);\n      break;\n    case Shape.RECT:\n      var _parsedStyle4 = object.parsedStyle,\n        _parsedStyle4$width = _parsedStyle4.width,\n        width = _parsedStyle4$width === void 0 ? 0 : _parsedStyle4$width,\n        _parsedStyle4$height = _parsedStyle4.height,\n        height = _parsedStyle4$height === void 0 ? 0 : _parsedStyle4$height,\n        _parsedStyle4$x = _parsedStyle4.x,\n        x = _parsedStyle4$x === void 0 ? 0 : _parsedStyle4$x,\n        _parsedStyle4$y = _parsedStyle4.y,\n        y = _parsedStyle4$y === void 0 ? 0 : _parsedStyle4$y,\n        radius = _parsedStyle4.radius;\n      var hasRadius = radius && radius.some(function (r) {\n        return r !== 0;\n      });\n      commands = rectToCommands(width, height, x, y, hasRadius && radius.map(function (r) {\n        return clamp(r, 0, Math.min(Math.abs(width) / 2, Math.abs(height) / 2));\n      }));\n      break;\n    case Shape.PATH:\n      var absolutePath = object.parsedStyle.d.absolutePath;\n      commands = _toConsumableArray(absolutePath);\n      break;\n  }\n  if (commands.length) {\n    return commandsToPathString(commands, object, transform);\n  }\n}\nfunction translatePathToString(absolutePath) {\n  var startOffsetX = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var startOffsetY = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var endOffsetX = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n  var endOffsetY = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n  var newValue = absolutePath.map(function (params, i) {\n    var command = params[0];\n    var nextSegment = absolutePath[i + 1];\n    var useStartOffset = i === 0 && (startOffsetX !== 0 || startOffsetY !== 0);\n    var useEndOffset = (i === absolutePath.length - 1 || nextSegment && (nextSegment[0] === 'M' || nextSegment[0] === 'Z')) && endOffsetX !== 0 && endOffsetY !== 0;\n    switch (command) {\n      case 'M':\n        // Use start marker offset\n        if (useStartOffset) {\n          return \"M \".concat(params[1] + startOffsetX, \",\").concat(params[2] + startOffsetY, \" L \").concat(params[1], \",\").concat(params[2]);\n        }\n        return \"M \".concat(params[1], \",\").concat(params[2]);\n      case 'L':\n        return \"L \".concat(params[1] + (useEndOffset ? endOffsetX : 0), \",\").concat(params[2] + (useEndOffset ? endOffsetY : 0));\n      case 'Q':\n        return \"Q \".concat(params[1], \" \").concat(params[2], \",\").concat(params[3], \" \").concat(params[4]).concat(useEndOffset ? \" L \".concat(params[3] + endOffsetX, \",\").concat(params[4] + endOffsetY) : '');\n      case 'C':\n        return \"C \".concat(params[1], \" \").concat(params[2], \",\").concat(params[3], \" \").concat(params[4], \",\").concat(params[5], \" \").concat(params[6]).concat(useEndOffset ? \" L \".concat(params[5] + endOffsetX, \",\").concat(params[6] + endOffsetY) : '');\n      case 'A':\n        return \"A \".concat(params[1], \" \").concat(params[2], \" \").concat(params[3], \" \").concat(params[4], \" \").concat(params[5], \" \").concat(params[6], \" \").concat(params[7]).concat(useEndOffset ? \" L \".concat(params[6] + endOffsetX, \",\").concat(params[7] + endOffsetY) : '');\n      case 'Z':\n        return 'Z';\n      default:\n        return null;\n    }\n  }).filter(function (item) {\n    return item !== null;\n  }).join(' ');\n  if (~newValue.indexOf('NaN')) {\n    return '';\n  }\n  return newValue;\n}\n\nvar internalParsePath = function internalParsePath(path) {\n  // empty path\n  if (path === '' || Array.isArray(path) && path.length === 0) {\n    return {\n      absolutePath: [],\n      hasArc: false,\n      segments: [],\n      polygons: [],\n      polylines: [],\n      curve: null,\n      totalLength: 0,\n      rect: {\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0\n      }\n    };\n  }\n  var absolutePath;\n  try {\n    absolutePath = normalizePath(path);\n  } catch (_unused) {\n    absolutePath = normalizePath('');\n    console.error(\"[g]: Invalid SVG Path definition: \".concat(path));\n  }\n  removeRedundantMCommand(absolutePath);\n  var hasArc = hasArcOrBezier(absolutePath);\n  var _extractPolygons = extractPolygons(absolutePath),\n    polygons = _extractPolygons.polygons,\n    polylines = _extractPolygons.polylines;\n\n  // for later use\n  var segments = path2Segments(absolutePath);\n\n  // Only calculate bbox here since we don't need length now.\n  var _getPathBBox = getPathBBox(segments, 0),\n    x = _getPathBBox.x,\n    y = _getPathBBox.y,\n    width = _getPathBBox.width,\n    height = _getPathBBox.height;\n  return {\n    absolutePath: absolutePath,\n    hasArc: hasArc,\n    segments: segments,\n    polygons: polygons,\n    polylines: polylines,\n    // curve,\n    // Delay the calculation of length.\n    totalLength: 0,\n    rect: {\n      x: Number.isFinite(x) ? x : 0,\n      y: Number.isFinite(y) ? y : 0,\n      width: Number.isFinite(width) ? width : 0,\n      height: Number.isFinite(height) ? height : 0\n    }\n  };\n};\nvar memoizedParsePath = memoize(internalParsePath);\nfunction parsePath(path) {\n  return isString(path) ? memoizedParsePath(path) : internalParsePath(path);\n}\nfunction mergePaths(left, right, object) {\n  var curve1 = left.curve;\n  var curve2 = right.curve;\n  if (!curve1 || curve1.length === 0) {\n    // convert to curves to do morphing & picking later\n    // @see http://thednp.github.io/kute.js/svgCubicMorph.html\n    curve1 = path2Curve(left.absolutePath, false);\n    left.curve = curve1;\n  }\n  if (!curve2 || curve2.length === 0) {\n    curve2 = path2Curve(right.absolutePath, false);\n    right.curve = curve2;\n  }\n  var curves = [curve1, curve2];\n  if (curve1.length !== curve2.length) {\n    curves = equalizeSegments(curve1, curve2);\n  }\n  var curve0 = getDrawDirection(curves[0]) !== getDrawDirection(curves[1]) ? reverseCurve(curves[0]) : clonePath(curves[0]);\n  return [curve0, getRotatedCurve(curves[1], curve0), function (pathArray) {\n    // need converting to path string?\n    return pathArray;\n  }];\n}\n\n/**\n * @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute/points\n *\n * @example\n * points=\"100,10 250,150 200,110\"\n */\nfunction parsePoints(pointsOrStr, object) {\n  var points;\n  if (isString(pointsOrStr)) {\n    points = pointsOrStr.split(' ').map(function (pointStr) {\n      var _pointStr$split = pointStr.split(','),\n        _pointStr$split2 = _slicedToArray(_pointStr$split, 2),\n        x = _pointStr$split2[0],\n        y = _pointStr$split2[1];\n      return [Number(x), Number(y)];\n    });\n  } else {\n    points = pointsOrStr;\n  }\n  return {\n    points: points,\n    totalLength: 0,\n    segments: []\n  };\n}\nfunction mergePoints(left, right) {\n  return [left.points, right.points, function (points) {\n    return points;\n  }];\n}\n\n// eg. { t: 'scale', d: [CSSUnitValue(1), CSSUnitValue(2)] }\n\nvar _ = null;\nvar TRANSFORM_REGEXP = /\\s*(\\w+)\\(([^)]*)\\)/g;\nfunction cast(pattern) {\n  return function (contents) {\n    var i = 0;\n    return pattern.map(function (x) {\n      return x === _ ? contents[i++] : x;\n    });\n  };\n}\nfunction id(x) {\n  return x;\n}\n\n// type: [argTypes, convertTo3D, convertTo2D]\n// In the argument types string, lowercase characters represent optional arguments\nvar transformFunctions = {\n  // @ts-ignore\n  matrix: ['NNNNNN', [_, _, 0, 0, _, _, 0, 0, 0, 0, 1, 0, _, _, 0, 1], id],\n  matrix3d: ['NNNNNNNNNNNNNNNN', id],\n  rotate: ['A'],\n  rotateX: ['A'],\n  rotateY: ['A'],\n  rotateZ: ['A'],\n  rotate3d: ['NNNA'],\n  perspective: ['L'],\n  scale: ['Nn', cast([_, _, new CSSUnitValue(1)]), id],\n  scaleX: ['N', cast([_, new CSSUnitValue(1), new CSSUnitValue(1)]), cast([_, new CSSUnitValue(1)])],\n  scaleY: ['N', cast([new CSSUnitValue(1), _, new CSSUnitValue(1)]), cast([new CSSUnitValue(1), _])],\n  scaleZ: ['N', cast([new CSSUnitValue(1), new CSSUnitValue(1), _])],\n  scale3d: ['NNN', id],\n  skew: ['Aa', null, id],\n  skewX: ['A', null, cast([_, Odeg])],\n  skewY: ['A', null, cast([Odeg, _])],\n  translate: ['Tt', cast([_, _, Opx]), id],\n  translateX: ['T', cast([_, Opx, Opx]), cast([_, Opx])],\n  translateY: ['T', cast([Opx, _, Opx]), cast([Opx, _])],\n  translateZ: ['L', cast([Opx, Opx, _])],\n  translate3d: ['TTL', id]\n};\nfunction parseArrayTransform(transform) {\n  var result = [];\n  var length = transform.length;\n  for (var i = 0; i < length; i++) {\n    var item = transform[i];\n    var name = item[0];\n    var args = item.slice(1);\n    // infer default value\n    if (name === 'translate' || name === 'skew') {\n      if (args.length === 1) args.push(0);\n    } else if (name === 'scale') {\n      if (args.length === 1) args.push(args[0]);\n    }\n    var functionData = transformFunctions[name];\n    if (!functionData) return [];\n    var parsedArgs = args.map(function (value) {\n      return getOrCreateUnitValue(value);\n    });\n    result.push({\n      t: name,\n      d: parsedArgs\n    });\n  }\n  return result;\n}\n\n/**\n * none\n * scale(1) scale(1, 2)\n * scaleX(1)\n */\nfunction parseTransform(transform) {\n  if (Array.isArray(transform)) {\n    return parseArrayTransform(transform);\n  }\n  transform = (transform || 'none').trim();\n  if (transform === 'none') {\n    return [];\n  }\n  var result = [];\n  var match;\n  var prevLastIndex = 0;\n  TRANSFORM_REGEXP.lastIndex = 0;\n  while (match = TRANSFORM_REGEXP.exec(transform)) {\n    if (match.index !== prevLastIndex) {\n      return [];\n    }\n    prevLastIndex = match.index + match[0].length;\n    var functionName = match[1]; // scale\n    var functionData = transformFunctions[functionName]; // scale(1, 2)\n    if (!functionData) {\n      // invalid, eg. scale()\n      return [];\n    }\n    var args = match[2].split(','); // 1,2\n    var argTypes = functionData[0]; // Nn\n    if (argTypes.length < args.length) {\n      // scale(N, n)\n      return [];\n    }\n    var parsedArgs = [];\n    for (var i = 0; i < argTypes.length; i++) {\n      var arg = args[i];\n      var type = argTypes[i];\n      var parsedArg = void 0;\n      if (!arg) {\n        // @ts-ignore\n        parsedArg = {\n          a: Odeg,\n          n: parsedArgs[0],\n          t: Opx\n        }[type];\n      } else {\n        // @ts-ignore\n        parsedArg = {\n          A: function A(s) {\n            return s.trim() === '0' ? Odeg : parseAngle(s);\n          },\n          N: parseNumber,\n          T: parseLengthOrPercentage,\n          L: parseLength\n        }[type.toUpperCase()](arg);\n      }\n      if (parsedArg === undefined) {\n        return [];\n      }\n      parsedArgs.push(parsedArg);\n    }\n    result.push({\n      t: functionName,\n      d: parsedArgs\n    }); // { t: scale, d: [1, 2] }\n\n    if (TRANSFORM_REGEXP.lastIndex === transform.length) {\n      return result;\n    }\n  }\n  return [];\n}\nfunction parseTransformUnmemoize(transform) {\n  if (Array.isArray(transform)) {\n    return parseArrayTransform(transform);\n  }\n  transform = (transform || 'none').trim();\n  if (transform === 'none') {\n    return [];\n  }\n  var result = [];\n  var match;\n  var prevLastIndex = 0;\n  TRANSFORM_REGEXP.lastIndex = 0;\n  while (match = TRANSFORM_REGEXP.exec(transform)) {\n    if (match.index !== prevLastIndex) {\n      return [];\n    }\n    prevLastIndex = match.index + match[0].length;\n    var functionName = match[1]; // scale\n    var functionData = transformFunctions[functionName]; // scale(1, 2)\n    if (!functionData) {\n      // invalid, eg. scale()\n      return [];\n    }\n    var args = match[2].split(','); // 1,2\n    var argTypes = functionData[0]; // Nn\n    if (argTypes.length < args.length) {\n      // scale(N, n)\n      return [];\n    }\n    var parsedArgs = [];\n    for (var i = 0; i < argTypes.length; i++) {\n      var arg = args[i];\n      var type = argTypes[i];\n      var parsedArg = void 0;\n      if (!arg) {\n        // @ts-ignore\n        parsedArg = {\n          a: Odeg,\n          n: parsedArgs[0],\n          t: Opx\n        }[type];\n      } else {\n        // @ts-ignore\n        parsedArg = {\n          A: function A(s) {\n            return s.trim() === '0' ? Odeg : parseAngleUnmemoize(s);\n          },\n          N: parseNumberUnmemoize,\n          T: parseLengthOrPercentageUnmemoize,\n          L: parseLengthUnmemoize\n        }[type.toUpperCase()](arg);\n      }\n      if (parsedArg === undefined) {\n        return [];\n      }\n      parsedArgs.push(parsedArg);\n    }\n    result.push({\n      t: functionName,\n      d: parsedArgs\n    }); // { t: scale, d: [1, 2] }\n\n    if (TRANSFORM_REGEXP.lastIndex === transform.length) {\n      return result;\n    }\n  }\n  return [];\n}\nfunction convertItemToMatrix(item) {\n  var x;\n  var y;\n  var z;\n  var angle;\n  switch (item.t) {\n    case 'rotateX':\n      angle = deg2rad(convertAngleUnit(item.d[0]));\n      return [1, 0, 0, 0, 0, Math.cos(angle), Math.sin(angle), 0, 0, -Math.sin(angle), Math.cos(angle), 0, 0, 0, 0, 1];\n    case 'rotateY':\n      angle = deg2rad(convertAngleUnit(item.d[0]));\n      return [Math.cos(angle), 0, -Math.sin(angle), 0, 0, 1, 0, 0, Math.sin(angle), 0, Math.cos(angle), 0, 0, 0, 0, 1];\n    case 'rotate':\n    case 'rotateZ':\n      angle = deg2rad(convertAngleUnit(item.d[0]));\n      return [Math.cos(angle), Math.sin(angle), 0, 0, -Math.sin(angle), Math.cos(angle), 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n    case 'rotate3d':\n      x = item.d[0].value;\n      y = item.d[1].value;\n      z = item.d[2].value;\n      angle = deg2rad(convertAngleUnit(item.d[3]));\n      var sqrLength = x * x + y * y + z * z;\n      if (sqrLength === 0) {\n        x = 1;\n        y = 0;\n        z = 0;\n      } else if (sqrLength !== 1) {\n        var length = Math.sqrt(sqrLength);\n        x /= length;\n        y /= length;\n        z /= length;\n      }\n      var s = Math.sin(angle / 2);\n      var sc = s * Math.cos(angle / 2);\n      var sq = s * s;\n      return [1 - 2 * (y * y + z * z) * sq, 2 * (x * y * sq + z * sc), 2 * (x * z * sq - y * sc), 0, 2 * (x * y * sq - z * sc), 1 - 2 * (x * x + z * z) * sq, 2 * (y * z * sq + x * sc), 0, 2 * (x * z * sq + y * sc), 2 * (y * z * sq - x * sc), 1 - 2 * (x * x + y * y) * sq, 0, 0, 0, 0, 1];\n    case 'scale':\n      return [item.d[0].value, 0, 0, 0, 0, item.d[1].value, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n    case 'scaleX':\n      return [item.d[0].value, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n    case 'scaleY':\n      return [1, 0, 0, 0, 0, item.d[0].value, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n    case 'scaleZ':\n      return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, item.d[0].value, 0, 0, 0, 0, 1];\n    case 'scale3d':\n      return [item.d[0].value, 0, 0, 0, 0, item.d[1].value, 0, 0, 0, 0, item.d[2].value, 0, 0, 0, 0, 1];\n    case 'skew':\n      var xAngle = deg2rad(convertAngleUnit(item.d[0]));\n      var yAngle = deg2rad(convertAngleUnit(item.d[1]));\n      return [1, Math.tan(yAngle), 0, 0, Math.tan(xAngle), 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n    case 'skewX':\n      angle = deg2rad(convertAngleUnit(item.d[0]));\n      return [1, 0, 0, 0, Math.tan(angle), 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n    case 'skewY':\n      angle = deg2rad(convertAngleUnit(item.d[0]));\n      return [1, Math.tan(angle), 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n    case 'translate':\n      // TODO: pass target\n      x = convertPercentUnit(item.d[0], 0, null) || 0;\n      y = convertPercentUnit(item.d[1], 0, null) || 0;\n      return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, x, y, 0, 1];\n    case 'translateX':\n      x = convertPercentUnit(item.d[0], 0, null) || 0;\n      return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, x, 0, 0, 1];\n    case 'translateY':\n      y = convertPercentUnit(item.d[0], 0, null) || 0;\n      return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, y, 0, 1];\n    case 'translateZ':\n      z = convertPercentUnit(item.d[0], 0, null) || 0;\n      return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, z, 1];\n    case 'translate3d':\n      x = convertPercentUnit(item.d[0], 0, null) || 0;\n      y = convertPercentUnit(item.d[1], 0, null) || 0;\n      z = convertPercentUnit(item.d[2], 0, null) || 0;\n      return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, x, y, z, 1];\n    case 'perspective':\n      var t = convertPercentUnit(item.d[0], 0, null) || 0;\n      var p = t ? -1 / t : 0;\n      return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, p, 0, 0, 0, 1];\n    case 'matrix':\n      return [item.d[0].value, item.d[1].value, 0, 0, item.d[2].value, item.d[3].value, 0, 0, 0, 0, 1, 0, item.d[4].value, item.d[5].value, 0, 1];\n    case 'matrix3d':\n      return item.d.map(function (d) {\n        return d.value;\n      });\n  }\n}\nfunction multiplyMatrices(a, b) {\n  return [a[0] * b[0] + a[4] * b[1] + a[8] * b[2] + a[12] * b[3], a[1] * b[0] + a[5] * b[1] + a[9] * b[2] + a[13] * b[3], a[2] * b[0] + a[6] * b[1] + a[10] * b[2] + a[14] * b[3], a[3] * b[0] + a[7] * b[1] + a[11] * b[2] + a[15] * b[3], a[0] * b[4] + a[4] * b[5] + a[8] * b[6] + a[12] * b[7], a[1] * b[4] + a[5] * b[5] + a[9] * b[6] + a[13] * b[7], a[2] * b[4] + a[6] * b[5] + a[10] * b[6] + a[14] * b[7], a[3] * b[4] + a[7] * b[5] + a[11] * b[6] + a[15] * b[7], a[0] * b[8] + a[4] * b[9] + a[8] * b[10] + a[12] * b[11], a[1] * b[8] + a[5] * b[9] + a[9] * b[10] + a[13] * b[11], a[2] * b[8] + a[6] * b[9] + a[10] * b[10] + a[14] * b[11], a[3] * b[8] + a[7] * b[9] + a[11] * b[10] + a[15] * b[11], a[0] * b[12] + a[4] * b[13] + a[8] * b[14] + a[12] * b[15], a[1] * b[12] + a[5] * b[13] + a[9] * b[14] + a[13] * b[15], a[2] * b[12] + a[6] * b[13] + a[10] * b[14] + a[14] * b[15], a[3] * b[12] + a[7] * b[13] + a[11] * b[14] + a[15] * b[15]];\n}\nfunction convertToMatrix(transformList) {\n  if (transformList.length === 0) {\n    return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n  }\n  return transformList.map(convertItemToMatrix).reduce(multiplyMatrices);\n}\nfunction makeMatrixDecomposition(transformList) {\n  var translate = [0, 0, 0];\n  var scale = [1, 1, 1];\n  var skew = [0, 0, 0];\n  var perspective = [0, 0, 0, 1];\n  var quaternion = [0, 0, 0, 1];\n  decomposeMat4(\n  // @ts-ignore\n  convertToMatrix(transformList), translate, scale, skew, perspective, quaternion);\n  return [[translate, scale, skew, quaternion, perspective]];\n}\nvar composeMatrix = function () {\n  function multiply(a, b) {\n    var result = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]];\n    for (var i = 0; i < 4; i++) {\n      for (var j = 0; j < 4; j++) {\n        for (var k = 0; k < 4; k++) {\n          result[i][j] += b[i][k] * a[k][j];\n        }\n      }\n    }\n    return result;\n  }\n  function is2D(m) {\n    return m[0][2] === 0 && m[0][3] === 0 && m[1][2] === 0 && m[1][3] === 0 && m[2][0] === 0 && m[2][1] === 0 && m[2][2] === 1 && m[2][3] === 0 && m[3][2] === 0 && m[3][3] === 1;\n  }\n  function composeMatrix(translate, scale, skew, quat, perspective) {\n    var matrix = [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]];\n    for (var i = 0; i < 4; i++) {\n      matrix[i][3] = perspective[i];\n    }\n    for (var _i = 0; _i < 3; _i++) {\n      for (var j = 0; j < 3; j++) {\n        matrix[3][_i] += translate[j] * matrix[j][_i];\n      }\n    }\n    var x = quat[0];\n    var y = quat[1];\n    var z = quat[2];\n    var w = quat[3];\n    var rotMatrix = [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]];\n    rotMatrix[0][0] = 1 - 2 * (y * y + z * z);\n    rotMatrix[0][1] = 2 * (x * y - z * w);\n    rotMatrix[0][2] = 2 * (x * z + y * w);\n    rotMatrix[1][0] = 2 * (x * y + z * w);\n    rotMatrix[1][1] = 1 - 2 * (x * x + z * z);\n    rotMatrix[1][2] = 2 * (y * z - x * w);\n    rotMatrix[2][0] = 2 * (x * z - y * w);\n    rotMatrix[2][1] = 2 * (y * z + x * w);\n    rotMatrix[2][2] = 1 - 2 * (x * x + y * y);\n    matrix = multiply(matrix, rotMatrix);\n    var temp = [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]];\n    if (skew[2]) {\n      temp[2][1] = skew[2];\n      matrix = multiply(matrix, temp);\n    }\n    if (skew[1]) {\n      temp[2][1] = 0;\n      temp[2][0] = skew[0];\n      matrix = multiply(matrix, temp);\n    }\n    if (skew[0]) {\n      temp[2][0] = 0;\n      temp[1][0] = skew[0];\n      matrix = multiply(matrix, temp);\n    }\n    for (var _i2 = 0; _i2 < 3; _i2++) {\n      for (var _j = 0; _j < 3; _j++) {\n        matrix[_i2][_j] *= scale[_i2];\n      }\n    }\n    if (is2D(matrix)) {\n      return [matrix[0][0], matrix[0][1], matrix[1][0], matrix[1][1], matrix[3][0], matrix[3][1]];\n    }\n    return matrix[0].concat(matrix[1], matrix[2], matrix[3]);\n  }\n  return composeMatrix;\n}();\nfunction numberToLongString(x) {\n  return x.toFixed(6).replace('.000000', '');\n}\nfunction mergeMatrices(left, right) {\n  var leftArgs;\n  var rightArgs;\n  // @ts-ignore\n  if (left.decompositionPair !== right) {\n    // @ts-ignore\n    left.decompositionPair = right;\n    // @ts-ignore\n    leftArgs = makeMatrixDecomposition(left);\n  }\n  // @ts-ignore\n  if (right.decompositionPair !== left) {\n    // @ts-ignore\n    right.decompositionPair = left;\n    // @ts-ignore\n    rightArgs = makeMatrixDecomposition(right);\n  }\n  if (leftArgs[0] === null || rightArgs[0] === null) return [\n  // @ts-ignore\n  [false],\n  // @ts-ignore\n  [true],\n  // @ts-ignore\n  function (x) {\n    return x ? right[0].d : left[0].d;\n  }];\n  leftArgs[0].push(0);\n  rightArgs[0].push(1);\n  return [leftArgs, rightArgs,\n  // @ts-ignore\n  function (list) {\n    // @ts-ignore\n    var q = quat(leftArgs[0][3], rightArgs[0][3], list[5]);\n    var mat = composeMatrix(list[0], list[1], list[2], q, list[4]);\n    var stringifiedArgs = mat.map(numberToLongString).join(',');\n    return stringifiedArgs;\n  }];\n}\nfunction dot(v1, v2) {\n  var result = 0;\n  for (var i = 0; i < v1.length; i++) {\n    result += v1[i] * v2[i];\n  }\n  return result;\n}\nfunction quat(fromQ, toQ, f) {\n  var product = dot(fromQ, toQ);\n  product = clamp(product, -1.0, 1.0);\n  var quat = [];\n  if (product === 1.0) {\n    quat = fromQ;\n  } else {\n    var theta = Math.acos(product);\n    var w = Math.sin(f * theta) * 1 / Math.sqrt(1 - product * product);\n    for (var i = 0; i < 4; i++) {\n      quat.push(fromQ[i] * (Math.cos(f * theta) - product * w) + toQ[i] * w);\n    }\n  }\n  return quat;\n}\n\n// scaleX/Y/Z -> scale\nfunction typeTo2D(type) {\n  return type.replace(/[XY]/, '');\n}\n\n// scaleX/Y/Z -> scale3d\nfunction typeTo3D(type) {\n  return type.replace(/(X|Y|Z|3d)?$/, '3d');\n}\nvar isMatrixOrPerspective = function isMatrixOrPerspective(lt, rt) {\n  return lt === 'perspective' && rt === 'perspective' || (lt === 'matrix' || lt === 'matrix3d') && (rt === 'matrix' || rt === 'matrix3d');\n};\nfunction mergeTransforms(left, right, target) {\n  var flipResults = false;\n  // padding empty transform, eg. merge 'scale(10)' with 'none' -> scale(1)\n  if (!left.length || !right.length) {\n    if (!left.length) {\n      flipResults = true;\n      left = right;\n      right = [];\n    }\n    var _loop = function _loop() {\n      var _left$i = left[i],\n        type = _left$i.t,\n        args = _left$i.d;\n      // none -> scale(1)/translateX(0)\n      var defaultValue = type.substring(0, 5) === 'scale' ? 1 : 0;\n      right.push({\n        t: type,\n        d: args.map(function (arg) {\n          if (typeof arg === 'number') {\n            return getOrCreateUnitValue(defaultValue);\n          }\n          return getOrCreateUnitValue(defaultValue, arg.unit);\n          //   {\n          //     unit: arg.unit,\n          //     value: defaultValue,\n          //   };\n        })\n      });\n    };\n    for (var i = 0; i < left.length; i++) {\n      _loop();\n    }\n  }\n  var leftResult = [];\n  var rightResult = [];\n  var types = [];\n\n  // merge matrix() with matrix3d()\n  if (left.length !== right.length) {\n    var merged = mergeMatrices(left, right);\n    // @ts-ignore\n    leftResult = [merged[0]];\n    // @ts-ignore\n    rightResult = [merged[1]];\n    types = [['matrix', [merged[2]]]];\n  } else {\n    for (var _i3 = 0; _i3 < left.length; _i3++) {\n      var leftType = left[_i3].t;\n      var rightType = right[_i3].t;\n      var leftArgs = left[_i3].d;\n      var rightArgs = right[_i3].d;\n      var leftFunctionData = transformFunctions[leftType];\n      var rightFunctionData = transformFunctions[rightType];\n      var type = void 0;\n      if (isMatrixOrPerspective(leftType, rightType)) {\n        var _merged = mergeMatrices([left[_i3]], [right[_i3]]);\n        // @ts-ignore\n        leftResult.push(_merged[0]);\n        // @ts-ignore\n        rightResult.push(_merged[1]);\n        types.push(['matrix', [_merged[2]]]);\n        continue;\n      } else if (leftType === rightType) {\n        type = leftType;\n      } else if (leftFunctionData[2] && rightFunctionData[2] && typeTo2D(leftType) === typeTo2D(rightType)) {\n        type = typeTo2D(leftType);\n        // @ts-ignore\n        leftArgs = leftFunctionData[2](leftArgs);\n        // @ts-ignore\n        rightArgs = rightFunctionData[2](rightArgs);\n      } else if (leftFunctionData[1] && rightFunctionData[1] && typeTo3D(leftType) === typeTo3D(rightType)) {\n        type = typeTo3D(leftType);\n        // @ts-ignore\n        leftArgs = leftFunctionData[1](leftArgs);\n        // @ts-ignore\n        rightArgs = rightFunctionData[1](rightArgs);\n      } else {\n        var _merged2 = mergeMatrices(left, right);\n        // @ts-ignore\n        leftResult = [_merged2[0]];\n        // @ts-ignore\n        rightResult = [_merged2[1]];\n        types = [['matrix', [_merged2[2]]]];\n        break;\n      }\n      var leftArgsCopy = [];\n      var rightArgsCopy = [];\n      var stringConversions = [];\n      for (var j = 0; j < leftArgs.length; j++) {\n        // const merge = leftArgs[j].unit === UnitType.kNumber ? mergeDimensions : mergeDimensions;\n        var _merged3 = mergeDimensions(leftArgs[j], rightArgs[j], target, false, j);\n        leftArgsCopy[j] = _merged3[0];\n        rightArgsCopy[j] = _merged3[1];\n        stringConversions.push(_merged3[2]);\n      }\n      leftResult.push(leftArgsCopy);\n      rightResult.push(rightArgsCopy);\n      types.push([type, stringConversions]);\n    }\n  }\n  if (flipResults) {\n    var tmp = leftResult;\n    leftResult = rightResult;\n    rightResult = tmp;\n  }\n  return [leftResult, rightResult, function (list) {\n    return list.map(function (args, i) {\n      var stringifiedArgs = args.map(function (arg, j) {\n        return types[i][1][j](arg);\n      }).join(',');\n      if (types[i][0] === 'matrix' && stringifiedArgs.split(',').length === 16) {\n        types[i][0] = 'matrix3d';\n      }\n      if (types[i][0] === 'matrix3d' && stringifiedArgs.split(',').length === 6) {\n        types[i][0] = 'matrix';\n      }\n      return \"\".concat(types[i][0], \"(\").concat(stringifiedArgs, \")\");\n    }).join(' ');\n  }];\n}\n\n/**\n * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/transform-origin\n * eg. 'center' 'top left' '50px 50px'\n */\nvar parseTransformOrigin = memoize(function (value) {\n  if (isString(value)) {\n    if (value === 'text-anchor') {\n      return [getOrCreateUnitValue(0, 'px'), getOrCreateUnitValue(0, 'px')];\n    }\n    var values = value.split(' ');\n    if (values.length === 1) {\n      if (values[0] === 'top' || values[0] === 'bottom') {\n        // 'top' -> 'center top'\n        values[1] = values[0];\n        values[0] = 'center';\n      } else {\n        // '50px' -> '50px center'\n        values[1] = 'center';\n      }\n    }\n    if (values.length !== 2) {\n      return null;\n    }\n\n    // eg. center bottom\n    return [parseLengthOrPercentage(convertKeyword2Percent(values[0])), parseLengthOrPercentage(convertKeyword2Percent(values[1]))];\n  }\n  return [getOrCreateUnitValue(value[0] || 0, 'px'), getOrCreateUnitValue(value[1] || 0, 'px')];\n});\nfunction convertKeyword2Percent(keyword) {\n  if (keyword === 'center') {\n    return '50%';\n  }\n  if (keyword === 'left' || keyword === 'top') {\n    return '0%';\n  }\n  if (keyword === 'right' || keyword === 'bottom') {\n    return '100%';\n  }\n  return keyword;\n}\n\n/**\n * Blink used them in code generation(css_properties.json5)\n */\nvar BUILT_IN_PROPERTIES = [{\n  /**\n   * used in CSS Layout API\n   * eg. `display: 'flex'`\n   */\n  n: 'display',\n  k: ['none']\n}, {\n  /**\n   * range [0.0, 1.0]\n   * @see https://developer.mozilla.org/en-US/docs/Web/CSS/opacity\n   */\n  n: 'opacity',\n  \"int\": true,\n  inh: true,\n  d: '1',\n  syntax: PropertySyntax.OPACITY_VALUE\n}, {\n  /**\n   * inheritable, range [0.0, 1.0]\n   * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/fill-opacity\n   * @see https://svgwg.org/svg2-draft/painting.html#FillOpacity\n   */\n  n: 'fillOpacity',\n  \"int\": true,\n  inh: true,\n  d: '1',\n  syntax: PropertySyntax.OPACITY_VALUE\n}, {\n  /**\n   * inheritable, range [0.0, 1.0]\n   * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-opacity\n   * @see https://svgwg.org/svg2-draft/painting.html#StrokeOpacity\n   */\n  n: 'strokeOpacity',\n  \"int\": true,\n  inh: true,\n  d: '1',\n  syntax: PropertySyntax.OPACITY_VALUE\n}, {\n  /**\n   * background-color is not inheritable\n   * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Fills_and_Strokes\n   */\n  n: 'fill',\n  \"int\": true,\n  k: ['none'],\n  d: 'none',\n  syntax: PropertySyntax.PAINT\n}, {\n  n: 'fillRule',\n  k: ['nonzero', 'evenodd'],\n  d: 'nonzero'\n},\n/**\n * default to none\n * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke#usage_notes\n */\n{\n  n: 'stroke',\n  \"int\": true,\n  k: ['none'],\n  d: 'none',\n  syntax: PropertySyntax.PAINT,\n  /**\n   * Stroke 'none' won't affect geometry but others will.\n   */\n  l: true\n}, {\n  n: 'shadowType',\n  k: ['inner', 'outer', 'both'],\n  d: 'outer',\n  l: true\n}, {\n  n: 'shadowColor',\n  \"int\": true,\n  syntax: PropertySyntax.COLOR\n}, {\n  n: 'shadowOffsetX',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n}, {\n  n: 'shadowOffsetY',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n}, {\n  n: 'shadowBlur',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.SHADOW_BLUR\n}, {\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-width\n   */\n  n: 'lineWidth',\n  \"int\": true,\n  inh: true,\n  d: '1',\n  l: true,\n  a: ['strokeWidth'],\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n}, {\n  n: 'increasedLineWidthForHitTesting',\n  inh: true,\n  d: '0',\n  l: true,\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n}, {\n  n: 'lineJoin',\n  inh: true,\n  l: true,\n  a: ['strokeLinejoin'],\n  k: ['miter', 'bevel', 'round'],\n  d: 'miter'\n}, {\n  n: 'lineCap',\n  inh: true,\n  l: true,\n  a: ['strokeLinecap'],\n  k: ['butt', 'round', 'square'],\n  d: 'butt'\n}, {\n  n: 'lineDash',\n  \"int\": true,\n  inh: true,\n  k: ['none'],\n  a: ['strokeDasharray'],\n  syntax: PropertySyntax.LENGTH_PERCENTAGE_12\n}, {\n  n: 'lineDashOffset',\n  \"int\": true,\n  inh: true,\n  d: '0',\n  a: ['strokeDashoffset'],\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n}, {\n  n: 'offsetPath',\n  syntax: PropertySyntax.DEFINED_PATH\n}, {\n  n: 'offsetDistance',\n  \"int\": true,\n  syntax: PropertySyntax.OFFSET_DISTANCE\n}, {\n  n: 'dx',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n}, {\n  n: 'dy',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n}, {\n  n: 'zIndex',\n  ind: true,\n  \"int\": true,\n  d: '0',\n  k: ['auto'],\n  syntax: PropertySyntax.Z_INDEX\n}, {\n  n: 'visibility',\n  k: ['visible', 'hidden'],\n  ind: true,\n  inh: true,\n  /**\n   * support interpolation\n   * @see https://developer.mozilla.org/en-US/docs/Web/CSS/visibility#interpolation\n   */\n  \"int\": true,\n  d: 'visible'\n}, {\n  n: 'pointerEvents',\n  inh: true,\n  k: ['none', 'auto', 'stroke', 'fill', 'painted', 'visible', 'visiblestroke', 'visiblefill', 'visiblepainted',\n  // 'bounding-box',\n  'all'],\n  d: 'auto'\n}, {\n  n: 'filter',\n  ind: true,\n  l: true,\n  k: ['none'],\n  d: 'none',\n  syntax: PropertySyntax.FILTER\n}, {\n  n: 'clipPath',\n  syntax: PropertySyntax.DEFINED_PATH\n}, {\n  n: 'textPath',\n  syntax: PropertySyntax.DEFINED_PATH\n}, {\n  n: 'textPathSide',\n  k: ['left', 'right'],\n  d: 'left'\n}, {\n  n: 'textPathStartOffset',\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n}, {\n  n: 'transform',\n  p: 100,\n  \"int\": true,\n  k: ['none'],\n  d: 'none',\n  syntax: PropertySyntax.TRANSFORM\n}, {\n  n: 'transformOrigin',\n  p: 100,\n  d: '0 0',\n  // // int: true,\n  // d: (nodeName: string) => {\n  //   if (nodeName === Shape.CIRCLE || nodeName === Shape.ELLIPSE) {\n  //     return 'center';\n  //   }\n  //   if (nodeName === Shape.TEXT) {\n  //     return 'text-anchor';\n  //   }\n  //   return 'left top';\n  // },\n  l: true,\n  syntax: PropertySyntax.TRANSFORM_ORIGIN\n}, {\n  n: 'cx',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.COORDINATE\n}, {\n  n: 'cy',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.COORDINATE\n}, {\n  n: 'cz',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.COORDINATE\n}, {\n  n: 'r',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n}, {\n  n: 'rx',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n}, {\n  n: 'ry',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n},\n// Rect Image Group\n{\n  // x in local space\n  n: 'x',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.COORDINATE\n}, {\n  // y in local space\n  n: 'y',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.COORDINATE\n}, {\n  // z in local space\n  n: 'z',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.COORDINATE\n}, {\n  n: 'width',\n  \"int\": true,\n  l: true,\n  /**\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/width\n   */\n  k: ['auto', 'fit-content', 'min-content', 'max-content'],\n  d: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n}, {\n  n: 'height',\n  \"int\": true,\n  l: true,\n  /**\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/height\n   */\n  k: ['auto', 'fit-content', 'min-content', 'max-content'],\n  d: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n}, {\n  n: 'radius',\n  \"int\": true,\n  l: true,\n  d: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE_14\n},\n// Line\n{\n  n: 'x1',\n  \"int\": true,\n  l: true,\n  syntax: PropertySyntax.COORDINATE\n}, {\n  n: 'y1',\n  \"int\": true,\n  l: true,\n  syntax: PropertySyntax.COORDINATE\n}, {\n  n: 'z1',\n  \"int\": true,\n  l: true,\n  syntax: PropertySyntax.COORDINATE\n}, {\n  n: 'x2',\n  \"int\": true,\n  l: true,\n  syntax: PropertySyntax.COORDINATE\n}, {\n  n: 'y2',\n  \"int\": true,\n  l: true,\n  syntax: PropertySyntax.COORDINATE\n}, {\n  n: 'z2',\n  \"int\": true,\n  l: true,\n  syntax: PropertySyntax.COORDINATE\n},\n// Path\n{\n  n: 'd',\n  \"int\": true,\n  l: true,\n  d: '',\n  syntax: PropertySyntax.PATH,\n  p: 50\n},\n// Polyline & Polygon\n{\n  n: 'points',\n  /**\n   * support interpolation\n   */\n  \"int\": true,\n  l: true,\n  syntax: PropertySyntax.LIST_OF_POINTS,\n  p: 50\n},\n// Text\n{\n  n: 'text',\n  l: true,\n  d: '',\n  syntax: PropertySyntax.TEXT,\n  p: 50\n}, {\n  n: 'textTransform',\n  l: true,\n  inh: true,\n  k: ['capitalize', 'uppercase', 'lowercase', 'none'],\n  d: 'none',\n  syntax: PropertySyntax.TEXT_TRANSFORM,\n  p: 51 // it must get parsed after text\n}, {\n  n: 'font',\n  l: true\n}, {\n  n: 'fontSize',\n  \"int\": true,\n  inh: true,\n  /**\n   * @see https://www.w3schools.com/css/css_font_size.asp\n   */\n  d: '16px',\n  l: true,\n  syntax: PropertySyntax.LENGTH_PERCENTAGE\n}, {\n  n: 'fontFamily',\n  l: true,\n  inh: true,\n  d: 'sans-serif'\n}, {\n  n: 'fontStyle',\n  l: true,\n  inh: true,\n  k: ['normal', 'italic', 'oblique'],\n  d: 'normal'\n}, {\n  n: 'fontWeight',\n  l: true,\n  inh: true,\n  k: ['normal', 'bold', 'bolder', 'lighter'],\n  d: 'normal'\n}, {\n  n: 'fontVariant',\n  l: true,\n  inh: true,\n  k: ['normal', 'small-caps'],\n  d: 'normal'\n}, {\n  n: 'lineHeight',\n  l: true,\n  syntax: PropertySyntax.LENGTH,\n  \"int\": true,\n  d: '0'\n}, {\n  n: 'letterSpacing',\n  l: true,\n  syntax: PropertySyntax.LENGTH,\n  \"int\": true,\n  d: '0'\n}, {\n  n: 'miterLimit',\n  l: true,\n  syntax: PropertySyntax.NUMBER,\n  d: function d(nodeName) {\n    if (nodeName === Shape.PATH || nodeName === Shape.POLYGON || nodeName === Shape.POLYLINE) {\n      return '4';\n    }\n    return '10';\n  }\n}, {\n  n: 'wordWrap',\n  l: true\n}, {\n  n: 'wordWrapWidth',\n  l: true\n}, {\n  n: 'maxLines',\n  l: true\n}, {\n  n: 'textOverflow',\n  l: true,\n  d: 'clip'\n}, {\n  n: 'leading',\n  l: true\n}, {\n  n: 'textBaseline',\n  l: true,\n  inh: true,\n  k: ['top', 'hanging', 'middle', 'alphabetic', 'ideographic', 'bottom'],\n  d: 'alphabetic'\n}, {\n  n: 'textAlign',\n  l: true,\n  inh: true,\n  k: ['start', 'center', 'middle', 'end', 'left', 'right'],\n  d: 'start'\n},\n// {\n//   n: 'whiteSpace',\n//   l: true,\n// },\n{\n  n: 'markerStart',\n  syntax: PropertySyntax.MARKER\n}, {\n  n: 'markerEnd',\n  syntax: PropertySyntax.MARKER\n}, {\n  n: 'markerMid',\n  syntax: PropertySyntax.MARKER\n}, {\n  n: 'markerStartOffset',\n  syntax: PropertySyntax.LENGTH,\n  l: true,\n  \"int\": true,\n  d: '0'\n}, {\n  n: 'markerEndOffset',\n  syntax: PropertySyntax.LENGTH,\n  l: true,\n  \"int\": true,\n  d: '0'\n}];\nvar GEOMETRY_ATTRIBUTE_NAMES = BUILT_IN_PROPERTIES.filter(function (n) {\n  return !!n.l;\n}).map(function (n) {\n  return n.n;\n});\nvar propertyMetadataCache = {};\nvar DefaultStyleValueRegistry = /*#__PURE__*/function () {\n  function DefaultStyleValueRegistry(runtime) {\n    var _this = this;\n    _classCallCheck(this, DefaultStyleValueRegistry);\n    this.runtime = runtime;\n    BUILT_IN_PROPERTIES.forEach(function (property) {\n      _this.registerMetadata(property);\n    });\n  }\n  return _createClass(DefaultStyleValueRegistry, [{\n    key: \"registerMetadata\",\n    value: function registerMetadata(metadata) {\n      [metadata.n].concat(_toConsumableArray(metadata.a || [])).forEach(function (name) {\n        propertyMetadataCache[name] = metadata;\n      });\n    }\n  }, {\n    key: \"getPropertySyntax\",\n    value: function getPropertySyntax(syntax) {\n      return this.runtime.CSSPropertySyntaxFactory[syntax];\n    }\n\n    /**\n     * * parse value, eg.\n     * fill: 'red' => CSSRGB\n     * translateX: '10px' => CSSUnitValue { unit: 'px', value: 10 }\n     * fontSize: '2em' => { unit: 'px', value: 32 }\n     *\n     * * calculate used value\n     * * post process\n     */\n  }, {\n    key: \"processProperties\",\n    value: function processProperties(object, attributes) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n        skipUpdateAttribute: false,\n        skipParse: false,\n        forceUpdateGeometry: false,\n        usedAttributes: [],\n        memoize: true\n      };\n      Object.assign(object.attributes, attributes);\n\n      // clipPath\n      var oldClipPath = object.parsedStyle.clipPath;\n      var oldOffsetPath = object.parsedStyle.offsetPath;\n      Object.assign(object.parsedStyle, attributes);\n      var needUpdateGeometry = !!options.forceUpdateGeometry;\n      if (!needUpdateGeometry && GEOMETRY_ATTRIBUTE_NAMES.some(function (name) {\n        return name in attributes;\n      })) {\n        needUpdateGeometry = true;\n      }\n      if (attributes.fill) {\n        object.parsedStyle.fill = parseColor(attributes.fill);\n      }\n      if (attributes.stroke) {\n        object.parsedStyle.stroke = parseColor(attributes.stroke);\n      }\n      if (attributes.shadowColor) {\n        object.parsedStyle.shadowColor = parseColor(attributes.shadowColor);\n      }\n      if (attributes.filter) {\n        object.parsedStyle.filter = parseFilter(attributes.filter);\n      }\n      // Rect\n      // @ts-ignore\n      if (!isNil(attributes.radius)) {\n        // @ts-ignore\n        object.parsedStyle.radius = parseDimensionArrayFormat(\n        // @ts-ignore\n        attributes.radius, 4);\n      }\n      // Polyline\n      if (!isNil(attributes.lineDash)) {\n        object.parsedStyle.lineDash = parseDimensionArrayFormat(attributes.lineDash, 2);\n      }\n      // @ts-ignore\n      if (attributes.points) {\n        // @ts-ignore\n        object.parsedStyle.points = parsePoints(attributes.points);\n      }\n      // Path\n      // @ts-ignore\n      if (attributes.d === '') {\n        object.parsedStyle.d = _objectSpread({}, EMPTY_PARSED_PATH);\n      }\n      // @ts-ignore\n      if (attributes.d) {\n        object.parsedStyle.d = parsePath(\n        // @ts-ignore\n        attributes.d);\n      }\n      // Text\n      if (attributes.textTransform) {\n        this.runtime.CSSPropertySyntaxFactory[PropertySyntax.TEXT_TRANSFORM].calculator(null, null, {\n          value: attributes.textTransform\n        }, object, null);\n      }\n      if (!isUndefined(attributes.clipPath)) {\n        this.runtime.CSSPropertySyntaxFactory[PropertySyntax.DEFINED_PATH].calculator('clipPath', oldClipPath, attributes.clipPath, object, this.runtime);\n      }\n      if (attributes.offsetPath) {\n        this.runtime.CSSPropertySyntaxFactory[PropertySyntax.DEFINED_PATH].calculator('offsetPath', oldOffsetPath, attributes.offsetPath, object, this.runtime);\n      }\n      if (attributes.transform) {\n        object.parsedStyle.transform = parseTransform(attributes.transform);\n      }\n      if (attributes.transformOrigin) {\n        object.parsedStyle.transformOrigin = parseTransformOrigin(attributes.transformOrigin);\n      }\n      // Marker\n      // @ts-ignore\n      if (attributes.markerStart) {\n        object.parsedStyle.markerStart = this.runtime.CSSPropertySyntaxFactory[PropertySyntax.MARKER].calculator(null,\n        // @ts-ignore\n        attributes.markerStart,\n        // @ts-ignore\n        attributes.markerStart, null, null);\n      }\n      // @ts-ignore\n      if (attributes.markerEnd) {\n        object.parsedStyle.markerEnd = this.runtime.CSSPropertySyntaxFactory[PropertySyntax.MARKER].calculator(null,\n        // @ts-ignore\n        attributes.markerEnd,\n        // @ts-ignore\n        attributes.markerEnd, null, null);\n      }\n      // @ts-ignore\n      if (attributes.markerMid) {\n        object.parsedStyle.markerMid = this.runtime.CSSPropertySyntaxFactory[PropertySyntax.MARKER].calculator('',\n        // @ts-ignore\n        attributes.markerMid,\n        // @ts-ignore\n        attributes.markerMid, null, null);\n      }\n      if (!isNil(attributes.zIndex)) {\n        this.runtime.CSSPropertySyntaxFactory[PropertySyntax.Z_INDEX].postProcessor(object);\n      }\n      if (!isNil(attributes.offsetDistance)) {\n        this.runtime.CSSPropertySyntaxFactory[PropertySyntax.OFFSET_DISTANCE].postProcessor(object);\n      }\n      if (attributes.transform) {\n        this.runtime.CSSPropertySyntaxFactory[PropertySyntax.TRANSFORM].postProcessor(object);\n      }\n      if (attributes.transformOrigin) {\n        this.runtime.CSSPropertySyntaxFactory[PropertySyntax.TRANSFORM_ORIGIN].postProcessor(object);\n      }\n      if (needUpdateGeometry) {\n        object.geometry.dirty = true;\n        object.renderable.boundsDirty = true;\n        object.renderable.renderBoundsDirty = true;\n        if (!options.forceUpdateGeometry) {\n          this.runtime.sceneGraphService.dirtifyToRoot(object);\n        }\n      }\n    }\n\n    /**\n     * update geometry when relative props changed,\n     * eg. r of Circle, width/height of Rect\n     */\n  }, {\n    key: \"updateGeometry\",\n    value: function updateGeometry(object) {\n      var nodeName = object.nodeName;\n      var geometryUpdater = this.runtime.geometryUpdaterFactory[nodeName];\n      if (geometryUpdater) {\n        var geometry = object.geometry;\n        if (!geometry.contentBounds) {\n          geometry.contentBounds = new AABB();\n        }\n        if (!geometry.renderBounds) {\n          geometry.renderBounds = new AABB();\n        }\n        var parsedStyle = object.parsedStyle;\n        var _geometryUpdater$upda = geometryUpdater.update(parsedStyle, object),\n          _geometryUpdater$upda2 = _geometryUpdater$upda.cx,\n          cx = _geometryUpdater$upda2 === void 0 ? 0 : _geometryUpdater$upda2,\n          _geometryUpdater$upda3 = _geometryUpdater$upda.cy,\n          cy = _geometryUpdater$upda3 === void 0 ? 0 : _geometryUpdater$upda3,\n          _geometryUpdater$upda4 = _geometryUpdater$upda.cz,\n          cz = _geometryUpdater$upda4 === void 0 ? 0 : _geometryUpdater$upda4,\n          _geometryUpdater$upda5 = _geometryUpdater$upda.hwidth,\n          hwidth = _geometryUpdater$upda5 === void 0 ? 0 : _geometryUpdater$upda5,\n          _geometryUpdater$upda6 = _geometryUpdater$upda.hheight,\n          hheight = _geometryUpdater$upda6 === void 0 ? 0 : _geometryUpdater$upda6,\n          _geometryUpdater$upda7 = _geometryUpdater$upda.hdepth,\n          hdepth = _geometryUpdater$upda7 === void 0 ? 0 : _geometryUpdater$upda7;\n        // init with content box\n        var halfExtents = [Math.abs(hwidth), Math.abs(hheight), hdepth];\n        // anchor is center by default, don't account for lineWidth here\n        var stroke = parsedStyle.stroke,\n          _parsedStyle$lineWidt = parsedStyle.lineWidth,\n          lineWidth = _parsedStyle$lineWidt === void 0 ? 1 : _parsedStyle$lineWidt,\n          _parsedStyle$increase = parsedStyle.increasedLineWidthForHitTesting,\n          increasedLineWidthForHitTesting = _parsedStyle$increase === void 0 ? 0 : _parsedStyle$increase,\n          _parsedStyle$shadowTy = parsedStyle.shadowType,\n          shadowType = _parsedStyle$shadowTy === void 0 ? 'outer' : _parsedStyle$shadowTy,\n          shadowColor = parsedStyle.shadowColor,\n          _parsedStyle$filter = parsedStyle.filter,\n          filter = _parsedStyle$filter === void 0 ? [] : _parsedStyle$filter,\n          transformOrigin = parsedStyle.transformOrigin;\n        var center = [cx, cy, cz];\n        // update geometry's AABB\n        geometry.contentBounds.update(center, halfExtents);\n        // @see https://github.molgen.mpg.de/git-mirror/cairo/blob/master/src/cairo-stroke-style.c#L97..L128\n        var expansion = nodeName === Shape.POLYLINE || nodeName === Shape.POLYGON || nodeName === Shape.PATH ? Math.SQRT2 : 0.5;\n        // append border only if stroke existed\n        var hasStroke = stroke && !stroke.isNone;\n        if (hasStroke) {\n          var halfLineWidth = ((lineWidth || 0) + (increasedLineWidthForHitTesting || 0)) * expansion;\n          halfExtents[0] += halfLineWidth;\n          halfExtents[1] += halfLineWidth;\n        }\n        geometry.renderBounds.update(center, halfExtents);\n        // account for shadow, only support constant value now\n        if (shadowColor && shadowType && shadowType !== 'inner') {\n          var _geometry$renderBound = geometry.renderBounds,\n            min = _geometry$renderBound.min,\n            max = _geometry$renderBound.max;\n          var shadowBlur = parsedStyle.shadowBlur,\n            shadowOffsetX = parsedStyle.shadowOffsetX,\n            shadowOffsetY = parsedStyle.shadowOffsetY;\n          var shadowBlurInPixels = shadowBlur || 0;\n          var shadowOffsetXInPixels = shadowOffsetX || 0;\n          var shadowOffsetYInPixels = shadowOffsetY || 0;\n          var shadowLeft = min[0] - shadowBlurInPixels + shadowOffsetXInPixels;\n          var shadowRight = max[0] + shadowBlurInPixels + shadowOffsetXInPixels;\n          var shadowTop = min[1] - shadowBlurInPixels + shadowOffsetYInPixels;\n          var shadowBottom = max[1] + shadowBlurInPixels + shadowOffsetYInPixels;\n          min[0] = Math.min(min[0], shadowLeft);\n          max[0] = Math.max(max[0], shadowRight);\n          min[1] = Math.min(min[1], shadowTop);\n          max[1] = Math.max(max[1], shadowBottom);\n          geometry.renderBounds.setMinMax(min, max);\n        }\n        // account for filter, eg. blur(5px), drop-shadow()\n        filter.forEach(function (_ref) {\n          var name = _ref.name,\n            params = _ref.params;\n          if (name === 'blur') {\n            var blurRadius = params[0].value;\n            geometry.renderBounds.update(geometry.renderBounds.center, vec3.add(geometry.renderBounds.halfExtents, geometry.renderBounds.halfExtents, [blurRadius, blurRadius, 0]));\n          } else if (name === 'drop-shadow') {\n            var _shadowOffsetX = params[0].value;\n            var _shadowOffsetY = params[1].value;\n            var _shadowBlur = params[2].value;\n            var _geometry$renderBound2 = geometry.renderBounds,\n              _min = _geometry$renderBound2.min,\n              _max = _geometry$renderBound2.max;\n            var _shadowLeft = _min[0] - _shadowBlur + _shadowOffsetX;\n            var _shadowRight = _max[0] + _shadowBlur + _shadowOffsetX;\n            var _shadowTop = _min[1] - _shadowBlur + _shadowOffsetY;\n            var _shadowBottom = _max[1] + _shadowBlur + _shadowOffsetY;\n            _min[0] = Math.min(_min[0], _shadowLeft);\n            _max[0] = Math.max(_max[0], _shadowRight);\n            _min[1] = Math.min(_min[1], _shadowTop);\n            _max[1] = Math.max(_max[1], _shadowBottom);\n            geometry.renderBounds.setMinMax(_min, _max);\n          }\n        });\n        object.geometry.dirty = false;\n\n        // @see https://github.com/antvis/g/issues/957\n        var flipY = hwidth < 0;\n        var flipX = hheight < 0;\n        // set transform origin\n        var usedOriginXValue = (flipY ? -1 : 1) * (transformOrigin ? convertPercentUnit(transformOrigin[0], 0, object, true) : 0);\n        var usedOriginYValue = (flipX ? -1 : 1) * (transformOrigin ? convertPercentUnit(transformOrigin[1], 1, object, true) : 0);\n        if (usedOriginXValue || usedOriginYValue) {\n          object.setOrigin(usedOriginXValue, usedOriginYValue);\n        }\n      }\n    }\n  }, {\n    key: \"updateSizeAttenuation\",\n    value: function updateSizeAttenuation(node, zoom) {\n      if (node.style.isSizeAttenuation) {\n        if (!node.style.rawLineWidth) {\n          node.style.rawLineWidth = node.style.lineWidth;\n        }\n        node.style.lineWidth = (node.style.rawLineWidth || 1) / zoom;\n        if (node.nodeName === Shape.CIRCLE) {\n          if (!node.style.rawR) {\n            node.style.rawR = node.style.r;\n          }\n          node.style.r = (node.style.rawR || 1) / zoom;\n        }\n      } else {\n        if (node.style.rawLineWidth) {\n          node.style.lineWidth = node.style.rawLineWidth;\n          delete node.style.rawLineWidth;\n        }\n        if (node.nodeName === Shape.CIRCLE) {\n          if (node.style.rawR) {\n            node.style.r = node.style.rawR;\n            delete node.style.rawR;\n          }\n        }\n      }\n    }\n  }]);\n}();\n\nvar CSSPropertyAngle = /*#__PURE__*/function () {\n  function CSSPropertyAngle() {\n    _classCallCheck(this, CSSPropertyAngle);\n    this.mixer = mergeNumbers;\n  }\n  return _createClass(CSSPropertyAngle, [{\n    key: \"calculator\",\n    value: function calculator(name, oldParsed, parsed, object) {\n      return convertAngleUnit(parsed);\n    }\n  }]);\n}();\n\n/**\n * clipPath / textPath / offsetPath\n */\nvar CSSPropertyClipPath = /*#__PURE__*/function () {\n  function CSSPropertyClipPath() {\n    _classCallCheck(this, CSSPropertyClipPath);\n  }\n  return _createClass(CSSPropertyClipPath, [{\n    key: \"calculator\",\n    value: function calculator(name, oldPath, newPath, object, runtime) {\n      // unset\n      if (newPath instanceof CSSKeywordValue) {\n        newPath = null;\n      }\n      runtime.sceneGraphService.updateDisplayObjectDependency(name, oldPath, newPath, object);\n      if (name === 'clipPath') {\n        // should affect children\n        object.forEach(function (leaf) {\n          if (leaf.childNodes.length === 0) {\n            runtime.sceneGraphService.dirtifyToRoot(leaf);\n          }\n        });\n      }\n      return newPath;\n    }\n  }]);\n}();\n\nvar CSSPropertyColor = /*#__PURE__*/function () {\n  function CSSPropertyColor() {\n    _classCallCheck(this, CSSPropertyColor);\n    this.parser = parseColor;\n    this.mixer = mergeColors;\n  }\n  return _createClass(CSSPropertyColor, [{\n    key: \"calculator\",\n    value: function calculator(name, oldParsed, parsed, object) {\n      if (parsed instanceof CSSKeywordValue) {\n        // 'unset' 'none'\n        return parsed.value === 'none' ? noneColor : transparentColor;\n      }\n      return parsed;\n    }\n  }]);\n}();\n\nvar CSSPropertyFilter = /*#__PURE__*/function () {\n  function CSSPropertyFilter() {\n    _classCallCheck(this, CSSPropertyFilter);\n  }\n  return _createClass(CSSPropertyFilter, [{\n    key: \"calculator\",\n    value: function calculator(name, oldParsed, parsed) {\n      // unset or none\n      if (parsed instanceof CSSKeywordValue) {\n        return [];\n      }\n      return parsed;\n    }\n  }]);\n}();\n\nfunction getFontSize(object) {\n  var _ref = object.parsedStyle,\n    fontSize = _ref.fontSize;\n  return isNil(fontSize) ? null : fontSize;\n}\n\n/**\n * <length> & <percentage>\n */\nvar CSSPropertyLengthOrPercentage = /*#__PURE__*/function () {\n  function CSSPropertyLengthOrPercentage() {\n    _classCallCheck(this, CSSPropertyLengthOrPercentage);\n    this.mixer = mergeNumbers;\n  }\n  return _createClass(CSSPropertyLengthOrPercentage, [{\n    key: \"calculator\",\n    value:\n    /**\n     * according to parent's bounds\n     *\n     * @example\n     * CSS.percent(50) -> CSS.px(0.5 * parent.width)\n     */\n    function calculator(name, oldParsed, computed, object, runtime) {\n      if (isNumber(computed)) {\n        return computed;\n      }\n      if (CSSUnitValue.isRelativeUnit(computed.unit)) {\n        if (computed.unit === UnitType.kPercentage) {\n          // TODO: merge dimensions\n          return 0;\n        }\n        if (computed.unit === UnitType.kEms) {\n          if (object.parentNode) {\n            var fontSize = getFontSize(object.parentNode);\n            if (fontSize) {\n              fontSize *= computed.value;\n              return fontSize;\n            }\n          }\n          return 0;\n        }\n        if (computed.unit === UnitType.kRems) {\n          var _object$ownerDocument;\n          if (object !== null && object !== void 0 && (_object$ownerDocument = object.ownerDocument) !== null && _object$ownerDocument !== void 0 && _object$ownerDocument.documentElement) {\n            var _fontSize = getFontSize(object.ownerDocument.documentElement);\n            if (_fontSize) {\n              _fontSize *= computed.value;\n              return _fontSize;\n            }\n          }\n          return 0;\n        }\n      } else {\n        // remove listener if exists\n        // registry.unregisterParentGeometryBoundsChangedHandler(object, name);\n\n        // return absolute value\n        return computed.value;\n      }\n    }\n  }]);\n}();\n\n/**\n * format to Tuple2<CSSUnitValue>\n *\n * @example\n * rect.style.lineDash = 10;\n * rect.style.lineDash = [10, 10];\n * rect.style.lineDash = '10 10';\n */\nvar CSSPropertyLengthOrPercentage12 = /*#__PURE__*/function () {\n  function CSSPropertyLengthOrPercentage12() {\n    _classCallCheck(this, CSSPropertyLengthOrPercentage12);\n    this.mixer = mergeNumberLists;\n  }\n  return _createClass(CSSPropertyLengthOrPercentage12, [{\n    key: \"calculator\",\n    value: function calculator(name, oldParsed, computed) {\n      return computed.map(function (c) {\n        return c.value;\n      });\n    }\n  }]);\n}();\n\n/**\n * used in rounded rect\n *\n * @example\n * rect.style.radius = 10;\n * rect.style.radius = '10 10';\n * rect.style.radius = '10 10 10 10';\n */\nvar CSSPropertyLengthOrPercentage14 = /*#__PURE__*/function () {\n  function CSSPropertyLengthOrPercentage14() {\n    _classCallCheck(this, CSSPropertyLengthOrPercentage14);\n    this.mixer = mergeNumberLists;\n  }\n  return _createClass(CSSPropertyLengthOrPercentage14, [{\n    key: \"calculator\",\n    value: function calculator(name, oldParsed, computed) {\n      return computed.map(function (c) {\n        return c.value;\n      });\n    }\n  }]);\n}();\n\nvar CSSPropertyMarker = /*#__PURE__*/function () {\n  function CSSPropertyMarker() {\n    _classCallCheck(this, CSSPropertyMarker);\n  }\n  return _createClass(CSSPropertyMarker, [{\n    key: \"calculator\",\n    value: function calculator(name, oldMarker, newMarker, object) {\n      var _newMarker;\n      // unset\n      if (newMarker instanceof CSSKeywordValue) {\n        newMarker = null;\n      }\n      var cloned = (_newMarker = newMarker) === null || _newMarker === void 0 ? void 0 : _newMarker.cloneNode(true);\n      if (cloned) {\n        // FIXME: SVG should not inherit parent's style, add a flag here\n        cloned.style.isMarker = true;\n      }\n      return cloned;\n    }\n  }]);\n}();\n\nvar CSSPropertyNumber = /*#__PURE__*/function () {\n  function CSSPropertyNumber() {\n    _classCallCheck(this, CSSPropertyNumber);\n    this.mixer = mergeNumbers;\n  }\n  return _createClass(CSSPropertyNumber, [{\n    key: \"calculator\",\n    value: function calculator(name, oldParsed, computed) {\n      return computed.value;\n    }\n  }]);\n}();\n\nvar CSSPropertyOffsetDistance = /*#__PURE__*/function () {\n  function CSSPropertyOffsetDistance() {\n    _classCallCheck(this, CSSPropertyOffsetDistance);\n    this.mixer = clampedMergeNumbers(0, 1);\n  }\n  return _createClass(CSSPropertyOffsetDistance, [{\n    key: \"calculator\",\n    value: function calculator(name, oldParsed, computed) {\n      return computed.value;\n    }\n  }, {\n    key: \"postProcessor\",\n    value: function postProcessor(object) {\n      var _object$parsedStyle = object.parsedStyle,\n        offsetPath = _object$parsedStyle.offsetPath,\n        offsetDistance = _object$parsedStyle.offsetDistance;\n      if (!offsetPath) {\n        return;\n      }\n      var nodeName = offsetPath.nodeName;\n      if (nodeName === Shape.LINE || nodeName === Shape.PATH || nodeName === Shape.POLYLINE) {\n        // set position in world space\n        var point = offsetPath.getPoint(offsetDistance);\n        if (point) {\n          object.setLocalPosition(point.x, point.y);\n        }\n      }\n    }\n  }]);\n}();\n\n/**\n * opacity\n */\nvar CSSPropertyOpacity = /*#__PURE__*/function () {\n  function CSSPropertyOpacity() {\n    _classCallCheck(this, CSSPropertyOpacity);\n    this.mixer = clampedMergeNumbers(0, 1);\n  }\n  return _createClass(CSSPropertyOpacity, [{\n    key: \"calculator\",\n    value: function calculator(name, oldParsed, computed) {\n      return computed.value;\n    }\n  }]);\n}();\n\nvar CSSPropertyPath = /*#__PURE__*/function () {\n  function CSSPropertyPath() {\n    _classCallCheck(this, CSSPropertyPath);\n    /**\n     * path2Curve\n     */\n    this.parser = parsePath;\n    this.mixer = mergePaths;\n  }\n  return _createClass(CSSPropertyPath, [{\n    key: \"calculator\",\n    value: function calculator(name, oldParsed, parsed) {\n      // unset\n      if (parsed instanceof CSSKeywordValue && parsed.value === 'unset') {\n        return {\n          absolutePath: [],\n          hasArc: false,\n          segments: [],\n          polygons: [],\n          polylines: [],\n          curve: null,\n          totalLength: 0,\n          rect: new Rectangle(0, 0, 0, 0)\n        };\n      }\n      return parsed;\n    }\n  }]);\n}();\n\nvar CSSPropertyPoints = /*#__PURE__*/_createClass(function CSSPropertyPoints() {\n  _classCallCheck(this, CSSPropertyPoints);\n  this.mixer = mergePoints;\n});\n\nvar CSSPropertyShadowBlur = /*#__PURE__*/function (_CSSPropertyLengthOrP) {\n  function CSSPropertyShadowBlur() {\n    var _this;\n    _classCallCheck(this, CSSPropertyShadowBlur);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, CSSPropertyShadowBlur, [].concat(args));\n    _this.mixer = clampedMergeNumbers(0, Infinity);\n    return _this;\n  }\n  _inherits(CSSPropertyShadowBlur, _CSSPropertyLengthOrP);\n  return _createClass(CSSPropertyShadowBlur);\n}(CSSPropertyLengthOrPercentage);\n\nvar CSSPropertyText = /*#__PURE__*/function () {\n  function CSSPropertyText() {\n    _classCallCheck(this, CSSPropertyText);\n  }\n  return _createClass(CSSPropertyText, [{\n    key: \"calculator\",\n    value: function calculator(name, oldParsed, parsed, object) {\n      if (parsed instanceof CSSKeywordValue) {\n        if (parsed.value === 'unset') {\n          return '';\n        }\n        return parsed.value;\n      }\n\n      // allow number as valid text content\n      return \"\".concat(parsed);\n    }\n  }, {\n    key: \"postProcessor\",\n    value: function postProcessor(object) {\n      object.nodeValue = \"\".concat(object.parsedStyle.text) || '';\n    }\n  }]);\n}();\n\n/**\n * it must transform after text get parsed\n * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/text-transform\n */\nvar CSSPropertyTextTransform = /*#__PURE__*/function () {\n  function CSSPropertyTextTransform() {\n    _classCallCheck(this, CSSPropertyTextTransform);\n  }\n  return _createClass(CSSPropertyTextTransform, [{\n    key: \"calculator\",\n    value: function calculator(name, oldParsed, parsed, object) {\n      var rawText = object.getAttribute('text');\n      if (rawText) {\n        var transformedText = rawText;\n        if (parsed.value === 'capitalize') {\n          transformedText = rawText.charAt(0).toUpperCase() + rawText.slice(1);\n        } else if (parsed.value === 'lowercase') {\n          transformedText = rawText.toLowerCase();\n        } else if (parsed.value === 'uppercase') {\n          transformedText = rawText.toUpperCase();\n        }\n        object.parsedStyle.text = transformedText;\n      }\n      return parsed.value;\n    }\n  }]);\n}();\n\nvar definedProps = function definedProps(obj) {\n  return Object.fromEntries(Object.entries(obj).filter(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n      v = _ref2[1];\n    return v !== undefined;\n  }));\n};\n\nvar CANVAS_Map = new WeakMap();\n\n/**\n * destroy existed canvas with the same id\n */\nfunction cleanExistedCanvas(container, canvas, cleanUp) {\n  if (container) {\n    var $dom = typeof container === 'string' ? document.getElementById(container) : container;\n    if (CANVAS_Map.has($dom)) CANVAS_Map.get($dom).destroy(cleanUp);\n    CANVAS_Map.set($dom, canvas);\n  }\n}\nvar isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n\nfunction isElement(target) {\n  return !!target.getAttribute;\n}\nfunction sortedIndex(array, value) {\n  var low = 0;\n  var high = array.length;\n  while (low < high) {\n    var mid = low + high >>> 1;\n    if (sortByZIndex(array[mid], value) < 0) {\n      low = mid + 1;\n    } else {\n      high = mid;\n    }\n  }\n  return low;\n}\nfunction sortByZIndex(o1, o2) {\n  var zIndex1 = Number(o1.parsedStyle.zIndex || 0);\n  var zIndex2 = Number(o2.parsedStyle.zIndex || 0);\n  if (zIndex1 === zIndex2) {\n    var parent = o1.parentNode;\n    if (parent) {\n      var children = parent.childNodes || [];\n      return children.indexOf(o1) - children.indexOf(o2);\n    }\n  }\n  return zIndex1 - zIndex2;\n}\nfunction findClosestClipPathTarget(object) {\n  var el = object;\n  do {\n    var _el$parsedStyle;\n    var clipPath = (_el$parsedStyle = el.parsedStyle) === null || _el$parsedStyle === void 0 ? void 0 : _el$parsedStyle.clipPath;\n    if (clipPath) return el;\n    el = el.parentElement;\n  } while (el !== null);\n  return null;\n}\nvar PX_SUFFIX = 'px';\nfunction setDOMSize($el, width, height) {\n  if (isBrowser && $el.style) {\n    $el.style.width = width + PX_SUFFIX;\n    $el.style.height = height + PX_SUFFIX;\n  }\n}\nfunction getStyle($el, property) {\n  if (isBrowser) {\n    return document.defaultView.getComputedStyle($el, null).getPropertyValue(property);\n  }\n}\nfunction getWidth($el) {\n  var width = getStyle($el, 'width');\n  if (width === 'auto') {\n    return $el.offsetWidth;\n  }\n  return parseFloat(width);\n}\nfunction getHeight($el) {\n  var height = getStyle($el, 'height');\n  if (height === 'auto') {\n    return $el.offsetHeight;\n  }\n  return parseFloat(height);\n}\n\n// borrow from hammer.js\nvar MOUSE_POINTER_ID = 1;\nvar TOUCH_TO_POINTER = {\n  touchstart: 'pointerdown',\n  touchend: 'pointerup',\n  touchendoutside: 'pointerupoutside',\n  touchmove: 'pointermove',\n  touchcancel: 'pointercancel'\n};\nvar clock = typeof performance === 'object' && performance.now ? performance : Date;\n\nfunction isInFragment(node) {\n  if (node.nodeName === Shape.FRAGMENT) return true;\n  return node.getRootNode().nodeName === Shape.FRAGMENT;\n}\n\nfunction isFillOrStrokeAffected() {\n  var pointerEvents = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'auto';\n  var fill = arguments.length > 1 ? arguments[1] : undefined;\n  var stroke = arguments.length > 2 ? arguments[2] : undefined;\n  // account for pointerEvents\n  // @see https://developer.mozilla.org/en-US/docs/Web/CSS/pointer-events\n\n  var hasFill = false;\n  var hasStroke = false;\n  var isFillOtherThanNone = !!fill && !fill.isNone;\n  var isStrokeOtherThanNone = !!stroke && !stroke.isNone;\n  if (pointerEvents === 'visiblepainted' || pointerEvents === 'painted' || pointerEvents === 'auto') {\n    hasFill = isFillOtherThanNone;\n    hasStroke = isStrokeOtherThanNone;\n  } else if (pointerEvents === 'visiblefill' || pointerEvents === 'fill') {\n    hasFill = true;\n  } else if (pointerEvents === 'visiblestroke' || pointerEvents === 'stroke') {\n    hasStroke = true;\n  } else if (pointerEvents === 'visible' || pointerEvents === 'all') {\n    // The values of the fill and stroke do not affect event processing.\n    hasFill = true;\n    hasStroke = true;\n  }\n  return [hasFill, hasStroke];\n}\n\n/**\n * Thanks for following contributor of codes\n * https://gist.github.com/1866474\n * http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n * http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating\n * https://github.com/Financial-Times/polyfill-library/blob/master/polyfills/requestAnimationFrame/polyfill.js\n * */\n\nvar uId = 1;\nvar uniqueId = function uniqueId() {\n  return uId++;\n};\n\n// We use `self` instead of `window` for `WebWorker` support.\nvar root =\n// eslint-disable-next-line no-nested-ternary\ntypeof self === 'object' && self.self === self ? self :\n// @ts-ignore\ntypeof global === 'object' && global.global === global ?\n// @ts-ignore\nglobal : {};\nvar nowOffset = Date.now();\n\n// use performance api if exist, otherwise use Date.now.\n// Date.now polyfill required.\nvar pnow = function pnow() {\n  if (root.performance && typeof root.performance.now === 'function') {\n    return root.performance.now();\n  }\n\n  // fallback\n  return Date.now() - nowOffset;\n};\nvar reservedCBs = {};\nvar lastTime = Date.now();\nvar polyfillRaf = function polyfillRaf(callback) {\n  if (typeof callback !== 'function') {\n    throw new TypeError(\"\".concat(callback, \" is not a function\"));\n  }\n  var currentTime = Date.now();\n  var gap = currentTime - lastTime;\n  var delay = gap > 16 ? 0 : 16 - gap;\n  var id = uniqueId();\n  reservedCBs[id] = callback;\n\n  // keys(reservedCBs).length > 1 의미는 이미 setTimeout 이 걸려있는 경우.\n  // 함께 callback 이 실행될 수 있게 reservedCBs 에만 추가해주고 return\n  if (Object.keys(reservedCBs).length > 1) return id;\n  setTimeout(function () {\n    lastTime = currentTime;\n    var copied = reservedCBs;\n    reservedCBs = {};\n    Object.keys(copied).forEach(function (key) {\n      return copied[key](pnow());\n    });\n  }, delay);\n  return id;\n};\nvar polyfillCaf = function polyfillCaf(id) {\n  delete reservedCBs[id];\n};\nvar vendorPrefixes = ['', 'webkit', 'moz', 'ms', 'o'];\nvar getRequestAnimationFrame = function getRequestAnimationFrame(vp) {\n  if (typeof vp !== 'string') return polyfillRaf;\n  if (vp === '') return root.requestAnimationFrame;\n  return root[\"\".concat(vp, \"RequestAnimationFrame\")];\n};\nvar getCancelAnimationFrame = function getCancelAnimationFrame(vp) {\n  if (typeof vp !== 'string') return polyfillCaf;\n  if (vp === '') return root.cancelAnimationFrame;\n  return root[\"\".concat(vp, \"CancelAnimationFrame\")] || root[\"\".concat(vp, \"CancelRequestAnimationFrame\")];\n};\nvar find = function find(arr, predicate) {\n  var i = 0;\n  while (arr[i] !== undefined) {\n    if (predicate(arr[i])) return arr[i];\n    i += 1;\n  }\n};\nvar vp = find(vendorPrefixes, function (vp) {\n  return !!getRequestAnimationFrame(vp);\n});\nvar raf = getRequestAnimationFrame(vp);\nvar caf = getCancelAnimationFrame(vp);\nroot.requestAnimationFrame = raf;\nroot.cancelAnimationFrame = caf;\n\nvar AsyncParallelHook = /*#__PURE__*/function () {\n  function AsyncParallelHook() {\n    _classCallCheck(this, AsyncParallelHook);\n    this.callbacks = [];\n  }\n  return _createClass(AsyncParallelHook, [{\n    key: \"getCallbacksNum\",\n    value: function getCallbacksNum() {\n      return this.callbacks.length;\n    }\n  }, {\n    key: \"tapPromise\",\n    value: function tapPromise(options, fn) {\n      this.callbacks.push(fn);\n    }\n  }, {\n    key: \"promise\",\n    value: function promise() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      return Promise.all(this.callbacks.map(function (callback) {\n        return callback.apply(void 0, args);\n      }));\n    }\n  }]);\n}();\n\nvar AsyncSeriesWaterfallHook = /*#__PURE__*/function () {\n  function AsyncSeriesWaterfallHook() {\n    _classCallCheck(this, AsyncSeriesWaterfallHook);\n    this.callbacks = [];\n  }\n  return _createClass(AsyncSeriesWaterfallHook, [{\n    key: \"tapPromise\",\n    value: function tapPromise(options, fn) {\n      this.callbacks.push(fn);\n    }\n  }, {\n    key: \"promise\",\n    value: function () {\n      var _promise = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var _this$callbacks,\n          result,\n          i,\n          callback,\n          _args = arguments;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              if (!this.callbacks.length) {\n                _context.next = 14;\n                break;\n              }\n              _context.next = 3;\n              return (_this$callbacks = this.callbacks)[0].apply(_this$callbacks, _args);\n            case 3:\n              result = _context.sent;\n              i = 0;\n            case 5:\n              if (!(i < this.callbacks.length - 1)) {\n                _context.next = 13;\n                break;\n              }\n              callback = this.callbacks[i]; // @ts-ignore\n              // eslint-disable-next-line no-await-in-loop\n              _context.next = 9;\n              return callback(result);\n            case 9:\n              result = _context.sent;\n            case 10:\n              i++;\n              _context.next = 5;\n              break;\n            case 13:\n              return _context.abrupt(\"return\", result);\n            case 14:\n              return _context.abrupt(\"return\", null);\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function promise() {\n        return _promise.apply(this, arguments);\n      }\n      return promise;\n    }()\n  }]);\n}();\n\nvar SyncHook = /*#__PURE__*/function () {\n  function SyncHook() {\n    _classCallCheck(this, SyncHook);\n    this.callbacks = [];\n  }\n  return _createClass(SyncHook, [{\n    key: \"tap\",\n    value: function tap(options, fn) {\n      this.callbacks.push(fn);\n    }\n  }, {\n    key: \"call\",\n    value: function call() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      /* eslint-disable-next-line prefer-rest-params */\n      var argsArr = arguments;\n      this.callbacks.forEach(function (callback) {\n        /* eslint-disable-next-line prefer-spread */\n        callback.apply(undefined, argsArr);\n      });\n    }\n  }]);\n}();\n\nvar SyncWaterfallHook = /*#__PURE__*/function () {\n  function SyncWaterfallHook() {\n    _classCallCheck(this, SyncWaterfallHook);\n    this.callbacks = [];\n  }\n  return _createClass(SyncWaterfallHook, [{\n    key: \"tap\",\n    value: function tap(options, fn) {\n      this.callbacks.push(fn);\n    }\n  }, {\n    key: \"call\",\n    value: function call() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      if (this.callbacks.length) {\n        /* eslint-disable-next-line prefer-rest-params */\n        var argsArr = arguments;\n        /* eslint-disable-next-line prefer-spread */\n        var result = this.callbacks[0].apply(undefined, argsArr);\n        for (var i = 0; i < this.callbacks.length - 1; i++) {\n          var callback = this.callbacks[i];\n          // @ts-ignore\n          result = callback(result);\n        }\n        return result;\n      }\n      return null;\n    }\n  }]);\n}();\n\nvar genericFontFamilies = ['serif', 'sans-serif', 'monospace', 'cursive', 'fantasy', 'system-ui'];\nvar stringRegExp = /([\\\"\\'])[^\\'\\\"]+\\1/;\nfunction toFontString(attributes) {\n  var _attributes$fontSize = attributes.fontSize,\n    fontSize = _attributes$fontSize === void 0 ? 16 : _attributes$fontSize,\n    _attributes$fontFamil = attributes.fontFamily,\n    fontFamily = _attributes$fontFamil === void 0 ? 'sans-serif' : _attributes$fontFamil,\n    _attributes$fontStyle = attributes.fontStyle,\n    fontStyle = _attributes$fontStyle === void 0 ? 'normal' : _attributes$fontStyle,\n    _attributes$fontVaria = attributes.fontVariant,\n    fontVariant = _attributes$fontVaria === void 0 ? 'normal' : _attributes$fontVaria,\n    _attributes$fontWeigh = attributes.fontWeight,\n    fontWeight = _attributes$fontWeigh === void 0 ? 'normal' : _attributes$fontWeigh;\n\n  // build canvas api font setting from individual components. Convert a numeric this.fontSize to px\n  // const fontSizeString: string = isNumber(fontSize) ? `${fontSize}px` : fontSize.toString();\n  var fontSizeString = isNumber(fontSize) && \"\".concat(fontSize, \"px\") || '16px';\n  // Clean-up fontFamily property by quoting each font name\n  // this will support font names with spaces\n\n  var fontFamilies = fontFamily.split(',');\n  for (var i = fontFamilies.length - 1; i >= 0; i--) {\n    // Trim any extra white-space\n    var _fontFamily = fontFamilies[i].trim();\n    // Check if font already contains strings\n    if (!stringRegExp.test(_fontFamily) && genericFontFamilies.indexOf(_fontFamily) < 0) {\n      _fontFamily = \"\\\"\".concat(_fontFamily, \"\\\"\");\n    }\n    fontFamilies[i] = _fontFamily;\n  }\n  return \"\".concat(fontStyle, \" \").concat(fontVariant, \" \").concat(fontWeight, \" \").concat(fontSizeString, \" \").concat(fontFamilies.join(','));\n}\n\nfunction createSkewMatrix(skewMatrix, skewX, skewY) {\n  // Create an identity matrix\n  mat4.identity(skewMatrix);\n  // Apply skew to the matrix\n  skewMatrix[4] = Math.tan(skewX); // Skew Y axis in X direction\n  skewMatrix[1] = Math.tan(skewY); // Skew X axis in Y direction\n\n  return skewMatrix;\n}\nvar $mat4_1 = mat4.create();\nvar $mat4_2 = mat4.create();\nvar parser = {\n  scale: function scale(d) {\n    mat4.fromScaling($mat4_1, [d[0].value, d[1].value, 1]);\n  },\n  scaleX: function scaleX(d) {\n    mat4.fromScaling($mat4_1, [d[0].value, 1, 1]);\n  },\n  scaleY: function scaleY(d) {\n    mat4.fromScaling($mat4_1, [1, d[0].value, 1]);\n  },\n  scaleZ: function scaleZ(d) {\n    mat4.fromScaling($mat4_1, [1, 1, d[0].value]);\n  },\n  scale3d: function scale3d(d) {\n    mat4.fromScaling($mat4_1, [d[0].value, d[1].value, d[2].value]);\n  },\n  translate: function translate(d) {\n    mat4.fromTranslation($mat4_1, [d[0].value, d[1].value, 0]);\n  },\n  translateX: function translateX(d) {\n    mat4.fromTranslation($mat4_1, [d[0].value, 0, 0]);\n  },\n  translateY: function translateY(d) {\n    mat4.fromTranslation($mat4_1, [0, d[0].value, 0]);\n  },\n  translateZ: function translateZ(d) {\n    mat4.fromTranslation($mat4_1, [0, 0, d[0].value]);\n  },\n  translate3d: function translate3d(d) {\n    mat4.fromTranslation($mat4_1, [d[0].value, d[1].value, d[2].value]);\n  },\n  rotate: function rotate(d) {\n    mat4.fromZRotation($mat4_1, deg2rad(convertAngleUnit(d[0])));\n  },\n  rotateX: function rotateX(d) {\n    mat4.fromXRotation($mat4_1, deg2rad(convertAngleUnit(d[0])));\n  },\n  rotateY: function rotateY(d) {\n    mat4.fromYRotation($mat4_1, deg2rad(convertAngleUnit(d[0])));\n  },\n  rotateZ: function rotateZ(d) {\n    mat4.fromZRotation($mat4_1, deg2rad(convertAngleUnit(d[0])));\n  },\n  rotate3d: function rotate3d(d) {\n    mat4.fromRotation($mat4_1, deg2rad(convertAngleUnit(d[3])), [d[0].value, d[1].value, d[2].value]);\n  },\n  skew: function skew(d) {\n    createSkewMatrix($mat4_1, deg2rad(d[0].value), deg2rad(d[1].value));\n  },\n  skewX: function skewX(d) {\n    createSkewMatrix($mat4_1, deg2rad(d[0].value), 0);\n  },\n  skewY: function skewY(d) {\n    createSkewMatrix($mat4_1, 0, deg2rad(d[0].value));\n  },\n  matrix: function matrix(d) {\n    // prettier-ignore\n    mat4.set($mat4_1, d[0].value, d[1].value, 0, 0, d[2].value, d[3].value, 0, 0, 0, 0, 1, 0, d[4].value, d[5].value, 0, 1);\n  },\n  matrix3d: function matrix3d(d) {\n    // @ts-ignore\n    mat4.set.apply(mat4, [$mat4_1].concat(_toConsumableArray(d.map(function (s) {\n      return s.value;\n    }))));\n  }\n};\nvar $vec3One$1 = vec3.fromValues(1, 1, 1);\nvar $vec3Zero$1 = vec3.create();\nvar optimizer = {\n  translate: function translate(object, d) {\n    runtime.sceneGraphService.setLocalScale(object, $vec3One$1, false);\n    runtime.sceneGraphService.setLocalEulerAngles(object, $vec3Zero$1, undefined, undefined, false);\n    runtime.sceneGraphService.setLocalPosition(object, [d[0].value, d[1].value, 0], false);\n    runtime.sceneGraphService.dirtifyLocal(object, object.transformable);\n  }\n};\nfunction parsedTransformToMat4(transform, object) {\n  if (transform.length) {\n    if (transform.length === 1 && optimizer[transform[0].t]) {\n      optimizer[transform[0].t](object, transform[0].d);\n      return;\n    }\n    var m = mat4.identity($mat4_2);\n    for (var i = 0; i < transform.length; i++) {\n      var _transform$i = transform[i],\n        t = _transform$i.t,\n        d = _transform$i.d;\n      var p = parser[t];\n      if (p) {\n        p(d);\n        mat4.mul(m, m, $mat4_1);\n      }\n    }\n    object.setLocalTransform(m);\n  } else {\n    object.resetLocalTransform();\n  }\n  return object.getLocalTransform();\n}\n\n/**\n * @see /zh/docs/api/animation#支持变换的属性\n *\n * support the following formats like CSS Transform:\n *\n * scale\n * * scale(x, y)\n * * scaleX(x)\n * * scaleY(x)\n * * scaleZ(z)\n * * scale3d(x, y, z)\n *\n * translate (unit: none, px, %(relative to its bounds))\n * * translate(x, y) eg. translate(0, 0) translate(0, 30px) translate(100%, 100%)\n * * translateX(0)\n * * translateY(0)\n * * translateZ(0)\n * * translate3d(0, 0, 0)\n *\n * rotate (unit: deg rad turn)\n * * rotate(0.5turn) rotate(30deg) rotate(1rad)\n *\n * none\n *\n * unsupported for now:\n * * calc() eg. translate(calc(100% + 10px))\n * * matrix/matrix3d()\n * * skew/skewX/skewY\n * * perspective\n */\nvar CSSPropertyTransform = /*#__PURE__*/function () {\n  function CSSPropertyTransform() {\n    _classCallCheck(this, CSSPropertyTransform);\n    this.parser = parseTransformUnmemoize;\n    this.mixer = mergeTransforms;\n  }\n  return _createClass(CSSPropertyTransform, [{\n    key: \"calculator\",\n    value: function calculator(name, oldParsed, parsed, object) {\n      // 'none'\n      if (parsed instanceof CSSKeywordValue) {\n        return [];\n      }\n      return parsed;\n    }\n  }, {\n    key: \"postProcessor\",\n    value: function postProcessor(object) {\n      parsedTransformToMat4(object.parsedStyle.transform, object);\n    }\n  }]);\n}();\n\n/**\n * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/transform-origin\n * @example\n * [10px, 10px] [10%, 10%]\n */\nvar CSSPropertyTransformOrigin = /*#__PURE__*/function () {\n  function CSSPropertyTransformOrigin() {\n    _classCallCheck(this, CSSPropertyTransformOrigin);\n  }\n  return _createClass(CSSPropertyTransformOrigin, [{\n    key: \"postProcessor\",\n    value: function postProcessor(object) {\n      var _ref = object.parsedStyle,\n        transformOrigin = _ref.transformOrigin;\n      if (transformOrigin[0].unit === UnitType.kPixels && transformOrigin[1].unit === UnitType.kPixels) {\n        object.setOrigin(transformOrigin[0].value, transformOrigin[1].value);\n      } else {\n        // Relative to geometry bounds, calculate later.\n        object.getGeometryBounds();\n      }\n    }\n  }]);\n}();\n\nvar CSSPropertyZIndex = /*#__PURE__*/function () {\n  function CSSPropertyZIndex() {\n    _classCallCheck(this, CSSPropertyZIndex);\n  }\n  return _createClass(CSSPropertyZIndex, [{\n    key: \"calculator\",\n    value: function calculator(name, oldParsed, computed, object) {\n      return computed.value;\n    }\n  }, {\n    key: \"postProcessor\",\n    value: function postProcessor(object) {\n      if (object.parentNode) {\n        var parentEntity = object.parentNode;\n        var parentRenderable = parentEntity.renderable;\n        var parentSortable = parentEntity.sortable;\n        if (parentRenderable) {\n          parentRenderable.dirty = true;\n        }\n        // need re-sort on parent\n        if (parentSortable) {\n          parentSortable.dirty = true;\n          parentSortable.dirtyReason = SortReason.Z_INDEX_CHANGED;\n        }\n      }\n    }\n  }]);\n}();\n\nvar CircleUpdater = /*#__PURE__*/function () {\n  function CircleUpdater() {\n    _classCallCheck(this, CircleUpdater);\n  }\n  return _createClass(CircleUpdater, [{\n    key: \"update\",\n    value: function update(parsedStyle, object) {\n      var _parsedStyle$cx = parsedStyle.cx,\n        cx = _parsedStyle$cx === void 0 ? 0 : _parsedStyle$cx,\n        _parsedStyle$cy = parsedStyle.cy,\n        cy = _parsedStyle$cy === void 0 ? 0 : _parsedStyle$cy,\n        _parsedStyle$r = parsedStyle.r,\n        r = _parsedStyle$r === void 0 ? 0 : _parsedStyle$r;\n      return {\n        cx: cx,\n        cy: cy,\n        hwidth: r,\n        hheight: r\n      };\n    }\n  }]);\n}();\n\nvar EllipseUpdater = /*#__PURE__*/function () {\n  function EllipseUpdater() {\n    _classCallCheck(this, EllipseUpdater);\n  }\n  return _createClass(EllipseUpdater, [{\n    key: \"update\",\n    value: function update(parsedStyle, object) {\n      var _parsedStyle$cx = parsedStyle.cx,\n        cx = _parsedStyle$cx === void 0 ? 0 : _parsedStyle$cx,\n        _parsedStyle$cy = parsedStyle.cy,\n        cy = _parsedStyle$cy === void 0 ? 0 : _parsedStyle$cy,\n        _parsedStyle$rx = parsedStyle.rx,\n        rx = _parsedStyle$rx === void 0 ? 0 : _parsedStyle$rx,\n        _parsedStyle$ry = parsedStyle.ry,\n        ry = _parsedStyle$ry === void 0 ? 0 : _parsedStyle$ry;\n      return {\n        cx: cx,\n        cy: cy,\n        hwidth: rx,\n        hheight: ry\n      };\n    }\n  }]);\n}();\n\nvar LineUpdater = /*#__PURE__*/function () {\n  function LineUpdater() {\n    _classCallCheck(this, LineUpdater);\n  }\n  return _createClass(LineUpdater, [{\n    key: \"update\",\n    value: function update(parsedStyle) {\n      var x1 = parsedStyle.x1,\n        y1 = parsedStyle.y1,\n        x2 = parsedStyle.x2,\n        y2 = parsedStyle.y2;\n      var minX = Math.min(x1, x2);\n      var maxX = Math.max(x1, x2);\n      var minY = Math.min(y1, y2);\n      var maxY = Math.max(y1, y2);\n      var width = maxX - minX;\n      var height = maxY - minY;\n      var hwidth = width / 2;\n      var hheight = height / 2;\n      return {\n        cx: minX + hwidth,\n        cy: minY + hheight,\n        hwidth: hwidth,\n        hheight: hheight\n      };\n    }\n  }]);\n}();\n\nvar PathUpdater = /*#__PURE__*/function () {\n  function PathUpdater() {\n    _classCallCheck(this, PathUpdater);\n  }\n  return _createClass(PathUpdater, [{\n    key: \"update\",\n    value: function update(parsedStyle) {\n      var d = parsedStyle.d;\n      var _d$rect = d.rect,\n        x = _d$rect.x,\n        y = _d$rect.y,\n        width = _d$rect.width,\n        height = _d$rect.height;\n      var hwidth = width / 2;\n      var hheight = height / 2;\n      return {\n        cx: x + hwidth,\n        cy: y + hheight,\n        hwidth: hwidth,\n        hheight: hheight\n      };\n    }\n  }]);\n}();\n\nvar PolylineUpdater = /*#__PURE__*/function () {\n  function PolylineUpdater() {\n    _classCallCheck(this, PolylineUpdater);\n  }\n  return _createClass(PolylineUpdater, [{\n    key: \"update\",\n    value: function update(parsedStyle) {\n      if (parsedStyle.points && isArray(parsedStyle.points.points)) {\n        var points = parsedStyle.points.points;\n\n        // FIXME: account for miter lineJoin\n        var minX = Math.min.apply(Math, _toConsumableArray(points.map(function (point) {\n          return point[0];\n        })));\n        var maxX = Math.max.apply(Math, _toConsumableArray(points.map(function (point) {\n          return point[0];\n        })));\n        var minY = Math.min.apply(Math, _toConsumableArray(points.map(function (point) {\n          return point[1];\n        })));\n        var maxY = Math.max.apply(Math, _toConsumableArray(points.map(function (point) {\n          return point[1];\n        })));\n        var width = maxX - minX;\n        var height = maxY - minY;\n        var hwidth = width / 2;\n        var hheight = height / 2;\n        return {\n          cx: minX + hwidth,\n          cy: minY + hheight,\n          hwidth: hwidth,\n          hheight: hheight\n        };\n      }\n      return {\n        cx: 0,\n        cy: 0,\n        hwidth: 0,\n        hheight: 0\n      };\n    }\n  }]);\n}();\n\nvar RectUpdater = /*#__PURE__*/function () {\n  function RectUpdater() {\n    _classCallCheck(this, RectUpdater);\n  }\n  return _createClass(RectUpdater, [{\n    key: \"update\",\n    value: function update(parsedStyle, object) {\n      var _parsedStyle$x = parsedStyle.x,\n        x = _parsedStyle$x === void 0 ? 0 : _parsedStyle$x,\n        _parsedStyle$y = parsedStyle.y,\n        y = _parsedStyle$y === void 0 ? 0 : _parsedStyle$y,\n        src = parsedStyle.src,\n        _parsedStyle$width = parsedStyle.width,\n        width = _parsedStyle$width === void 0 ? 0 : _parsedStyle$width,\n        _parsedStyle$height = parsedStyle.height,\n        height = _parsedStyle$height === void 0 ? 0 : _parsedStyle$height;\n      var contentWidth = width;\n      var contentHeight = height;\n\n      // resize with HTMLImageElement's size\n      if (src && !isString(src)) {\n        if (!contentWidth) {\n          contentWidth = src.width;\n          parsedStyle.width = contentWidth;\n        }\n        if (!contentHeight) {\n          contentHeight = src.height;\n          parsedStyle.height = contentHeight;\n        }\n      }\n      return {\n        cx: x + contentWidth / 2,\n        cy: y + contentHeight / 2,\n        hwidth: contentWidth / 2,\n        hheight: contentHeight / 2\n      };\n    }\n  }]);\n}();\n\nvar TextUpdater = /*#__PURE__*/function () {\n  function TextUpdater(globalRuntime) {\n    _classCallCheck(this, TextUpdater);\n    this.globalRuntime = globalRuntime;\n  }\n  return _createClass(TextUpdater, [{\n    key: \"isReadyToMeasure\",\n    value: function isReadyToMeasure(parsedStyle, object) {\n      var text = parsedStyle.text;\n      return text;\n    }\n  }, {\n    key: \"update\",\n    value: function update(parsedStyle, object) {\n      var _object$ownerDocument;\n      var text = parsedStyle.text,\n        _parsedStyle$textAlig = parsedStyle.textAlign,\n        textAlign = _parsedStyle$textAlig === void 0 ? 'start' : _parsedStyle$textAlig,\n        _parsedStyle$lineWidt = parsedStyle.lineWidth,\n        lineWidth = _parsedStyle$lineWidt === void 0 ? 1 : _parsedStyle$lineWidt,\n        _parsedStyle$textBase = parsedStyle.textBaseline,\n        textBaseline = _parsedStyle$textBase === void 0 ? 'alphabetic' : _parsedStyle$textBase,\n        _parsedStyle$dx = parsedStyle.dx,\n        dx = _parsedStyle$dx === void 0 ? 0 : _parsedStyle$dx,\n        _parsedStyle$dy = parsedStyle.dy,\n        dy = _parsedStyle$dy === void 0 ? 0 : _parsedStyle$dy,\n        _parsedStyle$x = parsedStyle.x,\n        x = _parsedStyle$x === void 0 ? 0 : _parsedStyle$x,\n        _parsedStyle$y = parsedStyle.y,\n        y = _parsedStyle$y === void 0 ? 0 : _parsedStyle$y;\n      if (!this.isReadyToMeasure(parsedStyle, object)) {\n        parsedStyle.metrics = {\n          font: '',\n          width: 0,\n          height: 0,\n          lines: [],\n          lineWidths: [],\n          lineHeight: 0,\n          maxLineWidth: 0,\n          fontProperties: {\n            ascent: 0,\n            descent: 0,\n            fontSize: 0\n          },\n          lineMetrics: []\n        };\n        return {\n          hwidth: 0,\n          hheight: 0,\n          cx: 0,\n          cy: 0\n        };\n      }\n      var _ref = (object === null || object === void 0 || (_object$ownerDocument = object.ownerDocument) === null || _object$ownerDocument === void 0 || (_object$ownerDocument = _object$ownerDocument.defaultView) === null || _object$ownerDocument === void 0 ? void 0 : _object$ownerDocument.getConfig()) || {},\n        offscreenCanvas = _ref.offscreenCanvas;\n      var metrics = this.globalRuntime.textService.measureText(text, parsedStyle, offscreenCanvas);\n      parsedStyle.metrics = metrics;\n      var width = metrics.width,\n        height = metrics.height;\n      var hwidth = width / 2;\n      var hheight = height / 2;\n\n      // default 'left'\n      var lineXOffset = x + hwidth;\n      if (textAlign === 'center' || textAlign === 'middle') {\n        lineXOffset += lineWidth / 2 - hwidth;\n      } else if (textAlign === 'right' || textAlign === 'end') {\n        lineXOffset += lineWidth - hwidth * 2;\n      }\n      var lineYOffset = y - hheight;\n      if (textBaseline === 'middle') {\n        lineYOffset += hheight;\n      } else if (textBaseline === 'top' || textBaseline === 'hanging') {\n        lineYOffset += hheight * 2;\n      } else if (textBaseline === 'alphabetic') ; else if (textBaseline === 'bottom' || textBaseline === 'ideographic') {\n        lineYOffset += 0;\n      }\n      // TODO: ideographic & bottom\n\n      if (dx) {\n        lineXOffset += dx;\n      }\n      if (dy) {\n        lineYOffset += dy;\n      }\n      return {\n        cx: lineXOffset,\n        cy: lineYOffset,\n        hwidth: hwidth,\n        hheight: hheight\n      };\n    }\n  }]);\n}();\n\nvar GroupUpdater = /*#__PURE__*/function () {\n  function GroupUpdater() {\n    _classCallCheck(this, GroupUpdater);\n  }\n  return _createClass(GroupUpdater, [{\n    key: \"update\",\n    value: function update(parsedStyle, object) {\n      return {\n        cx: 0,\n        cy: 0,\n        hwidth: 0,\n        hheight: 0\n      };\n    }\n  }]);\n}();\n\nvar HTMLUpdater = /*#__PURE__*/function () {\n  function HTMLUpdater() {\n    _classCallCheck(this, HTMLUpdater);\n  }\n  return _createClass(HTMLUpdater, [{\n    key: \"update\",\n    value: function update(parsedStyle, object) {\n      var _parsedStyle$x = parsedStyle.x,\n        x = _parsedStyle$x === void 0 ? 0 : _parsedStyle$x,\n        _parsedStyle$y = parsedStyle.y,\n        y = _parsedStyle$y === void 0 ? 0 : _parsedStyle$y,\n        _parsedStyle$width = parsedStyle.width,\n        width = _parsedStyle$width === void 0 ? 0 : _parsedStyle$width,\n        _parsedStyle$height = parsedStyle.height,\n        height = _parsedStyle$height === void 0 ? 0 : _parsedStyle$height;\n      return {\n        cx: x + width / 2,\n        cy: y + height / 2,\n        hwidth: width / 2,\n        hheight: height / 2\n      };\n    }\n  }]);\n}();\n\nfunction isFederatedEvent(value) {\n  return !!value.type;\n}\n\n/**\n * An DOM-compatible synthetic event implementation that is \"forwarded\" on behalf of an original\n * FederatedEvent or native Event.\n */\nvar FederatedEvent = /*#__PURE__*/function () {\n  /**\n   * The event boundary which manages this event. Propagation can only occur\n   *  within the boundary's jurisdiction.\n   */\n  function FederatedEvent(manager) {\n    _classCallCheck(this, FederatedEvent);\n    /**\n     * The propagation phase.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Event/eventPhase\n     */\n    this.eventPhase = FederatedEvent.prototype.NONE;\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Event/bubbles\n     */\n    this.bubbles = true;\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Event/cancelBubble\n     */\n    this.cancelBubble = true;\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Event/cancelable\n     */\n    this.cancelable = false;\n    /** Flags whether the default response of the user agent was prevent through this event. */\n    this.defaultPrevented = false;\n    /** Flags whether propagation was stopped. */\n    this.propagationStopped = false;\n    /** Flags whether propagation was immediately stopped. */\n    this.propagationImmediatelyStopped = false;\n    /**\n     * The coordinates of the evnet relative to the nearest DOM layer.\n     * This is a non-standard property.\n     */\n    this.layer = new Point();\n    /**\n     * The coordinates of the event relative to the DOM document.\n     * This is a non-standard property.\n     * relative to the DOM document.\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/MouseEvent/pageX\n     */\n    this.page = new Point();\n    /**\n     * relative to Canvas, origin is left-top\n     */\n    this.canvas = new Point();\n    /**\n     * relative to Viewport, account for Camera\n     */\n    this.viewport = new Point();\n    this.composed = false;\n    this.NONE = 0;\n    this.CAPTURING_PHASE = 1;\n    this.AT_TARGET = 2;\n    this.BUBBLING_PHASE = 3;\n    this.manager = manager;\n  }\n  return _createClass(FederatedEvent, [{\n    key: \"name\",\n    get:\n    /**\n     * The type of event, supports the following:\n     * * pointerdown\n     * * touchstart\n     * * mousedown\n     * * rightdown\n     * * ...\n     */\n\n    /**\n     * @deprecated\n     */\n    function get() {\n      return this.type;\n    }\n  }, {\n    key: \"layerX\",\n    get: function get() {\n      return this.layer.x;\n    }\n  }, {\n    key: \"layerY\",\n    get: function get() {\n      return this.layer.y;\n    }\n  }, {\n    key: \"pageX\",\n    get: function get() {\n      return this.page.x;\n    }\n  }, {\n    key: \"pageY\",\n    get: function get() {\n      return this.page.y;\n    }\n  }, {\n    key: \"x\",\n    get: function get() {\n      return this.canvas.x;\n    }\n  }, {\n    key: \"y\",\n    get: function get() {\n      return this.canvas.y;\n    }\n  }, {\n    key: \"canvasX\",\n    get: function get() {\n      return this.canvas.x;\n    }\n  }, {\n    key: \"canvasY\",\n    get: function get() {\n      return this.canvas.y;\n    }\n  }, {\n    key: \"viewportX\",\n    get: function get() {\n      return this.viewport.x;\n    }\n  }, {\n    key: \"viewportY\",\n    get: function get() {\n      return this.viewport.y;\n    }\n  }, {\n    key: \"composedPath\",\n    value:\n    /**\n     * The propagation path for this event\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Event/composedPath\n     *\n     * So composedPath()[0] represents the original target.\n     * @see https://polymer-library.polymer-project.org/3.0/docs/devguide/events#retargeting\n     */\n    function composedPath() {\n      if (this.manager && (!this.path || this.path[0] !== this.target)) {\n        this.path = this.target ? this.manager.propagationPath(this.target) : [];\n      }\n      return this.path;\n    }\n    /**\n     * @deprecated\n     */\n  }, {\n    key: \"propagationPath\",\n    get: function get() {\n      return this.composedPath();\n    }\n\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Event/preventDefault\n     */\n  }, {\n    key: \"preventDefault\",\n    value: function preventDefault() {\n      if (this.nativeEvent instanceof Event && this.nativeEvent.cancelable) {\n        this.nativeEvent.preventDefault();\n      }\n      this.defaultPrevented = true;\n    }\n\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Event/stopImmediatePropagation\n     */\n  }, {\n    key: \"stopImmediatePropagation\",\n    value: function stopImmediatePropagation() {\n      this.propagationImmediatelyStopped = true;\n    }\n\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Event/stopPropagation\n     */\n  }, {\n    key: \"stopPropagation\",\n    value: function stopPropagation() {\n      this.propagationStopped = true;\n    }\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/UIEvent/view\n     */\n  }, {\n    key: \"initEvent\",\n    value:\n    /**\n     * added for compatibility with DOM Event,\n     * deprecated props and methods\n     */\n    function initEvent() {}\n  }, {\n    key: \"initUIEvent\",\n    value: function initUIEvent() {}\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }]);\n}();\n\nvar FederatedMouseEvent = /*#__PURE__*/function (_ref) {\n  function FederatedMouseEvent() {\n    var _this;\n    _classCallCheck(this, FederatedMouseEvent);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, FederatedMouseEvent, [].concat(args));\n    /** Whether the \"alt\" key was pressed when this mouse event occurred. */\n    /** The specific button that was pressed in this mouse event. */\n    /** The button depressed when this event occurred. */\n    /** Whether the \"control\" key was pressed when this mouse event occurred. */\n    /** Whether the \"meta\" key was pressed when this mouse event occurred. */\n    /** This is currently not implemented in the Federated Events API. */\n    // @ts-ignore\n    /** Whether the \"shift\" key was pressed when this mouse event occurred. */\n    /**\n     * The coordinates of the mouse event relative to the canvas.\n     */\n    _this.client = new Point();\n    /**\n     * The movement in this pointer relative to the last `mousemove` event.\n     */\n    _this.movement = new Point();\n    /**\n     * The offset of the pointer coordinates w.r.t. target DisplayObject in world space. This is\n     * not supported at the moment.\n     */\n    _this.offset = new Point();\n    /**\n     * The pointer coordinates in world space.\n     */\n    _this.global = new Point();\n    /**\n     * The pointer coordinates in sceen space.\n     */\n    _this.screen = new Point();\n    return _this;\n  }\n  _inherits(FederatedMouseEvent, _ref);\n  return _createClass(FederatedMouseEvent, [{\n    key: \"clientX\",\n    get: function get() {\n      return this.client.x;\n    }\n  }, {\n    key: \"clientY\",\n    get: function get() {\n      return this.client.y;\n    }\n  }, {\n    key: \"movementX\",\n    get: function get() {\n      return this.movement.x;\n    }\n  }, {\n    key: \"movementY\",\n    get: function get() {\n      return this.movement.y;\n    }\n  }, {\n    key: \"offsetX\",\n    get: function get() {\n      return this.offset.x;\n    }\n  }, {\n    key: \"offsetY\",\n    get: function get() {\n      return this.offset.y;\n    }\n  }, {\n    key: \"globalX\",\n    get: function get() {\n      return this.global.x;\n    }\n  }, {\n    key: \"globalY\",\n    get: function get() {\n      return this.global.y;\n    }\n  }, {\n    key: \"screenX\",\n    get: function get() {\n      return this.screen.x;\n    }\n  }, {\n    key: \"screenY\",\n    get: function get() {\n      return this.screen.y;\n    }\n  }, {\n    key: \"getModifierState\",\n    value: function getModifierState(key) {\n      return 'getModifierState' in this.nativeEvent && this.nativeEvent.getModifierState(key);\n    }\n  }, {\n    key: \"initMouseEvent\",\n    value: function initMouseEvent() {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }]);\n}(FederatedEvent);\n\n// @ts-ignore\nvar FederatedPointerEvent = /*#__PURE__*/function (_FederatedMouseEvent) {\n  function FederatedPointerEvent() {\n    var _this;\n    _classCallCheck(this, FederatedPointerEvent);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, FederatedPointerEvent, [].concat(args));\n    /**\n     * The unique identifier of the pointer.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pointerId\n     */\n    /**\n     * The width of the pointer's contact along the x-axis, measured in CSS pixels.\n     * radiusX of TouchEvents will be represented by this value.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/width\n     */\n    _this.width = 0;\n    /**\n     * The height of the pointer's contact along the y-axis, measured in CSS pixels.\n     * radiusY of TouchEvents will be represented by this value.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/height\n     */\n    _this.height = 0;\n    /**\n     * Indicates whether or not the pointer device that created the event is the primary pointer.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/isPrimary\n     */\n    _this.isPrimary = false;\n    return _this;\n  }\n  _inherits(FederatedPointerEvent, _FederatedMouseEvent);\n  return _createClass(FederatedPointerEvent, [{\n    key: \"getCoalescedEvents\",\n    value:\n    /**\n     * The type of pointer that triggered the event.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pointerType\n     */\n\n    /**\n     * Pressure applied by the pointing device during the event.\n     *s\n     * A Touch's force property will be represented by this value.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pressure\n     */\n\n    /**\n     * Barrel pressure on a stylus pointer.\n     *\n     * @see https://w3c.github.io/pointerevents/#pointerevent-interface\n     */\n\n    /**\n     * The angle, in degrees, between the pointer device and the screen.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/tiltX\n     */\n\n    /**\n     * The angle, in degrees, between the pointer device and the screen.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/tiltY\n     */\n\n    /**\n     * Twist of a stylus pointer.\n     *\n     * @see https://w3c.github.io/pointerevents/#pointerevent-interface\n     */\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/getCoalescedEvents\n     */\n    function getCoalescedEvents() {\n      if (this.type === 'pointermove' || this.type === 'mousemove' || this.type === 'touchmove') {\n        // @ts-ignore\n        return [this];\n      }\n      return [];\n    }\n\n    /**\n     * @see https://chromestatus.com/feature/5765569655603200\n     */\n  }, {\n    key: \"getPredictedEvents\",\n    value: function getPredictedEvents() {\n      throw new Error('getPredictedEvents is not supported!');\n    }\n\n    /**\n     * @see https://github.com/antvis/G/issues/1115\n     * We currently reuses event objects in the event system,\n     * avoiding the creation of a large number of event objects.\n     * Reused objects are only used to carry different data,\n     * such as coordinate information, native event objects,\n     * and therefore the lifecycle is limited to the event handler,\n     * which can lead to unintended consequences if an attempt is made to cache the entire event object.\n     *\n     * Therefore, while keeping the above performance considerations in mind, it is possible to provide a clone method that creates a new object when the user really wants to cache it, e.g.\n     */\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return this.manager.clonePointerEvent(this);\n    }\n  }]);\n}(FederatedMouseEvent);\n\n// @ts-ignore\nvar FederatedWheelEvent = /*#__PURE__*/function (_FederatedMouseEvent) {\n  function FederatedWheelEvent() {\n    _classCallCheck(this, FederatedWheelEvent);\n    return _callSuper(this, FederatedWheelEvent, arguments);\n  }\n  _inherits(FederatedWheelEvent, _FederatedMouseEvent);\n  return _createClass(FederatedWheelEvent, [{\n    key: \"clone\",\n    value:\n    /**\n     * The units of `deltaX`, `deltaY`, and `deltaZ`. This is one of `DOM_DELTA_LINE`,\n     * `DOM_DELTA_PAGE`, `DOM_DELTA_PIXEL`.\n     */\n\n    /** Horizontal scroll amount */\n\n    /** Vertical scroll amount */\n\n    /** z-axis scroll amount. */\n\n    function clone() {\n      return this.manager.cloneWheelEvent(this);\n    }\n  }]);\n}(FederatedMouseEvent);\n\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/Events/Creating_and_triggering_events\n *\n * @example\n  const event = new CustomEvent('build', { detail: { prop1: 'xx' } });\n  circle.addEventListener('build', (e) => {\n    e.target; // circle\n    e.detail; // { prop1: 'xx' }\n  });\n\n  circle.dispatchEvent(event);\n */\nvar CustomEvent = /*#__PURE__*/function (_FederatedEvent) {\n  function CustomEvent(eventName, object) {\n    var _this;\n    _classCallCheck(this, CustomEvent);\n    _this = _callSuper(this, CustomEvent, [null]);\n    _this.type = eventName;\n    _this.detail = object;\n\n    // compatible with G 3.0\n    Object.assign(_this, object);\n    return _this;\n  }\n  _inherits(CustomEvent, _FederatedEvent);\n  return _createClass(CustomEvent);\n}(FederatedEvent);\n\nvar CANVAS_CACHE = new WeakMap();\n\n/**\n * Objects that can receive events and may have listeners for them.\n * eg. Element, Canvas, DisplayObject\n * @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget\n */\nvar EventTarget = /*#__PURE__*/function () {\n  function EventTarget() {\n    _classCallCheck(this, EventTarget);\n    /**\n     * event emitter\n     */\n    this.emitter = new EventEmitter();\n  }\n  return _createClass(EventTarget, [{\n    key: \"on\",\n    value:\n    /**\n     * @deprecated\n     * @alias addEventListener\n     */\n    function on(type, listener, options) {\n      this.addEventListener(type, listener, options);\n      return this;\n    }\n    /**\n     * support `capture` & `once` in options\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener\n     */\n  }, {\n    key: \"addEventListener\",\n    value: function addEventListener(type, listener, options) {\n      var capture = false;\n      var once = false;\n      if (isBoolean(options)) capture = options;else if (options) {\n        var _options$capture = options.capture;\n        capture = _options$capture === void 0 ? false : _options$capture;\n        var _options$once = options.once;\n        once = _options$once === void 0 ? false : _options$once;\n      }\n      if (capture) type += 'capture';\n      // eslint-disable-next-line @typescript-eslint/unbound-method\n      listener = isFunction(listener) ? listener : listener.handleEvent;\n      var context = isFunction(listener) ? undefined : listener;\n      if (once) this.emitter.once(type, listener, context);else this.emitter.on(type, listener, context);\n      return this;\n    }\n    /**\n     * @deprecated\n     * @alias removeEventListener\n     */\n  }, {\n    key: \"off\",\n    value: function off(type, listener, options) {\n      if (type) {\n        this.removeEventListener(type, listener, options);\n      } else {\n        // remove all listeners\n        this.removeAllEventListeners();\n      }\n      return this;\n    }\n  }, {\n    key: \"removeAllEventListeners\",\n    value: function removeAllEventListeners() {\n      var _this$emitter;\n      (_this$emitter = this.emitter) === null || _this$emitter === void 0 || _this$emitter.removeAllListeners();\n    }\n  }, {\n    key: \"removeEventListener\",\n    value: function removeEventListener(type, listener, options) {\n      var _listener;\n      if (!this.emitter) return this;\n      var capture = isBoolean(options) ? options : options === null || options === void 0 ? void 0 : options.capture;\n      if (capture) type += 'capture';\n      // eslint-disable-next-line @typescript-eslint/unbound-method\n      listener = isFunction(listener) ? listener : (_listener = listener) === null || _listener === void 0 ? void 0 : _listener.handleEvent;\n      var context = isFunction(listener) ? undefined : listener;\n      this.emitter.off(type, listener, context);\n      return this;\n    }\n    /**\n     * @deprecated\n     * @alias dispatchEvent\n     */\n  }, {\n    key: \"emit\",\n    value: function emit(eventName, object) {\n      this.dispatchEvent(new CustomEvent(eventName, object));\n    }\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/dispatchEvent\n     */\n  }, {\n    key: \"dispatchEvent\",\n    value: function dispatchEvent(e) {\n      var skipPropagate = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var canvas = CANVAS_CACHE.get(this);\n      if (!canvas) {\n        var _ownerDocument;\n        // @ts-expect-error document may be defined in inherited class\n        if (this.document) canvas = this;\n        // @ts-expect-error defaultView may be defined in inherited class\n        else if (this.defaultView) canvas = this.defaultView;else canvas = (_ownerDocument = this.ownerDocument) === null || _ownerDocument === void 0 ? void 0 : _ownerDocument.defaultView;\n        if (canvas) CANVAS_CACHE.set(this, canvas);\n      }\n      if (canvas) {\n        e.manager = canvas.getEventService();\n        if (!e.manager) return false;\n        e.defaultPrevented = false;\n        if (e.path) e.path.length = 0;\n        // @ts-ignore\n        else e.page = [];\n        if (!skipPropagate) e.target = this;\n        e.manager.dispatchEvent(e, e.type, skipPropagate);\n      }\n      return !e.defaultPrevented;\n    }\n  }]);\n}();\n\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Node\n */\nvar Node = /*#__PURE__*/function (_EventTarget) {\n  function Node() {\n    var _this;\n    _classCallCheck(this, Node);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, Node, [].concat(args));\n    _this.shadow = false;\n    /**\n     * points to canvas.document\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/ownerDocument\n     */\n    _this.ownerDocument = null;\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/isConnected\n     * @example\n        circle.isConnected; // false\n        canvas.appendChild(circle);\n        circle.isConnected; // true\n     */\n    _this.isConnected = false;\n    /**\n     * Returns node's node document's document base URL.\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node\n     */\n    _this.baseURI = '';\n    /**\n     * Returns the children.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/childNodes\n     */\n    _this.childNodes = [];\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/nodeType\n     */\n    _this.nodeType = 0;\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/nodeName\n     */\n    _this.nodeName = '';\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/nodeValue\n     */\n    _this.nodeValue = null;\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/ParentNode\n     */\n    _this.parentNode = null;\n    return _this;\n  }\n  _inherits(Node, _EventTarget);\n  return _createClass(Node, [{\n    key: \"textContent\",\n    get:\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/textContent\n     */\n    function get() {\n      var out = '';\n      if (this.nodeName === Shape.TEXT) {\n        // @ts-ignore\n        out += this.style.text;\n      }\n      var _iterator = _createForOfIteratorHelper(this.childNodes),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _child = _step.value;\n          if (_child.nodeName === Shape.TEXT) {\n            out += _child.nodeValue;\n          } else {\n            out += _child.textContent;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      return out;\n    },\n    set: function set(content) {\n      var _this2 = this;\n      // remove all children\n      this.childNodes.slice().forEach(function (child) {\n        _this2.removeChild(child);\n      });\n      if (this.nodeName === Shape.TEXT) {\n        // @ts-ignore\n        this.style.text = \"\".concat(content);\n      }\n    }\n\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/getRootNode\n     */\n  }, {\n    key: \"getRootNode\",\n    value: function getRootNode() {\n      var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      if (this.parentNode) {\n        return this.parentNode.getRootNode(opts);\n      }\n      if (opts.composed && this.host) {\n        return this.host.getRootNode(opts);\n      }\n      return this;\n    }\n  }, {\n    key: \"hasChildNodes\",\n    value: function hasChildNodes() {\n      return this.childNodes.length > 0;\n    }\n  }, {\n    key: \"isDefaultNamespace\",\n    value: function isDefaultNamespace(namespace) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"lookupNamespaceURI\",\n    value: function lookupNamespaceURI(prefix) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"lookupPrefix\",\n    value: function lookupPrefix(namespace) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"normalize\",\n    value: function normalize() {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/isEqualNode\n     */\n  }, {\n    key: \"isEqualNode\",\n    value: function isEqualNode(otherNode) {\n      // TODO: compare 2 nodes, not sameness\n      return this === otherNode;\n    }\n  }, {\n    key: \"isSameNode\",\n    value: function isSameNode(otherNode) {\n      return this.isEqualNode(otherNode);\n    }\n  }, {\n    key: \"parent\",\n    get:\n    /**\n     * @deprecated\n     * @alias parentNode\n     */\n    function get() {\n      return this.parentNode;\n    }\n  }, {\n    key: \"parentElement\",\n    get: function get() {\n      return null;\n    }\n  }, {\n    key: \"nextSibling\",\n    get: function get() {\n      return null;\n    }\n  }, {\n    key: \"previousSibling\",\n    get: function get() {\n      return null;\n    }\n  }, {\n    key: \"firstChild\",\n    get: function get() {\n      return this.childNodes.length > 0 ? this.childNodes[0] : null;\n    }\n  }, {\n    key: \"lastChild\",\n    get: function get() {\n      return this.childNodes.length > 0 ? this.childNodes[this.childNodes.length - 1] : null;\n    }\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/compareDocumentPosition\n     * @see https://github.com/b-fuze/deno-dom/blob/master/src/dom/node.ts#L338\n     */\n  }, {\n    key: \"compareDocumentPosition\",\n    value: function compareDocumentPosition(other) {\n      if (other === this) {\n        // same node\n        return 0;\n      }\n\n      // if (!(other instanceof Node)) {\n      //   throw new TypeError(\n      //     'Node.compareDocumentPosition: Argument 1 does not implement interface Node.',\n      //   );\n      // }\n\n      var node1Root = other;\n      // eslint-disable-next-line @typescript-eslint/no-this-alias\n      var node2Root = this;\n      var node1Hierarchy = [node1Root];\n      var node2Hierarchy = [node2Root];\n      while ((_node1Root$parentNode = node1Root.parentNode) !== null && _node1Root$parentNode !== void 0 ? _node1Root$parentNode : node2Root.parentNode) {\n        var _node1Root$parentNode;\n        node1Root = node1Root.parentNode ? (node1Hierarchy.push(node1Root.parentNode), node1Root.parentNode) : node1Root;\n        node2Root = node2Root.parentNode ? (node2Hierarchy.push(node2Root.parentNode), node2Root.parentNode) : node2Root;\n      }\n\n      // Check if they don't share the same root node\n      if (node1Root !== node2Root) {\n        return Node.DOCUMENT_POSITION_DISCONNECTED | Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC | Node.DOCUMENT_POSITION_PRECEDING;\n      }\n      var longerHierarchy = node1Hierarchy.length > node2Hierarchy.length ? node1Hierarchy : node2Hierarchy;\n      var shorterHierarchy = longerHierarchy === node1Hierarchy ? node2Hierarchy : node1Hierarchy;\n\n      // Check if either is a container of the other\n      if (longerHierarchy[longerHierarchy.length - shorterHierarchy.length] === shorterHierarchy[0]) {\n        return longerHierarchy === node1Hierarchy ?\n        // other is a child of this\n        Node.DOCUMENT_POSITION_CONTAINED_BY | Node.DOCUMENT_POSITION_FOLLOWING :\n        // this is a child of other\n        Node.DOCUMENT_POSITION_CONTAINS | Node.DOCUMENT_POSITION_PRECEDING;\n      }\n\n      // Find their first common ancestor and see whether they\n      // are preceding or following\n      var longerStart = longerHierarchy.length - shorterHierarchy.length;\n      for (var i = shorterHierarchy.length - 1; i >= 0; i--) {\n        var shorterHierarchyNode = shorterHierarchy[i];\n        var longerHierarchyNode = longerHierarchy[longerStart + i];\n\n        // We found the first common ancestor\n        if (longerHierarchyNode !== shorterHierarchyNode) {\n          var siblings = shorterHierarchyNode.parentNode.childNodes;\n          if (siblings.indexOf(shorterHierarchyNode) < siblings.indexOf(longerHierarchyNode)) {\n            // Shorter is before longer\n            if (shorterHierarchy === node1Hierarchy) {\n              // Other is before this\n              return Node.DOCUMENT_POSITION_PRECEDING;\n            }\n            // This is before other\n            return Node.DOCUMENT_POSITION_FOLLOWING;\n          }\n          // Longer is before shorter\n          if (longerHierarchy === node1Hierarchy) {\n            // Other is before this\n            return Node.DOCUMENT_POSITION_PRECEDING;\n          }\n          // Other is after this\n          return Node.DOCUMENT_POSITION_FOLLOWING;\n        }\n      }\n      return Node.DOCUMENT_POSITION_FOLLOWING;\n    }\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/cloneNode\n     */\n  }, {\n    key: \"contain\",\n    value:\n    /**\n     * @deprecated\n     * @alias contains\n     */\n    function contain(other) {\n      return this.contains(other);\n    }\n  }, {\n    key: \"contains\",\n    value: function contains(other) {\n      // the node itself, one of its direct children\n      var tmp = other;\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Node/contains\n      while (tmp && this !== tmp) {\n        tmp = tmp.parentNode;\n      }\n      return !!tmp;\n    }\n  }, {\n    key: \"getAncestor\",\n    value: function getAncestor(n) {\n      // eslint-disable-next-line @typescript-eslint/no-this-alias\n      var temp = this;\n      while (n > 0 && temp) {\n        temp = temp.parentNode;\n        n--;\n      }\n      return temp;\n    }\n\n    /**\n     * iterate current node and its descendants\n     * @param callback - callback to execute for each node, return false to break\n     * @param assigned - whether to iterate assigned nodes\n     */\n  }, {\n    key: \"forEach\",\n    value: function forEach(callback) {\n      var result = callback(this);\n      if (result !== false) {\n        var nodes = this.childNodes;\n        var length = nodes.length;\n        for (var i = 0; i < length; i++) {\n          nodes[i].forEach(callback);\n        }\n      }\n    }\n  }], [{\n    key: \"isNode\",\n    value: function isNode(target) {\n      return !!target.childNodes;\n    }\n  }]);\n}(EventTarget);\n/**\n * Both nodes are in different documents or different trees in the same document.\n */\nNode.DOCUMENT_POSITION_DISCONNECTED = 1;\n/**\n * otherNode precedes the node in either a pre-order depth-first traversal\n * of a tree containing both (e.g., as an ancestor or previous sibling or a descendant of a previous sibling or previous sibling of an ancestor) or (if they are disconnected) in an arbitrary but consistent ordering.\n */\nNode.DOCUMENT_POSITION_PRECEDING = 2;\n/**\n * otherNode follows the node in either a pre-order depth-first traversal of a tree containing both (e.g., as a descendant or following sibling or a descendant of a following sibling or following sibling of an ancestor) or (if they are disconnected) in an arbitrary but consistent ordering.\n */\nNode.DOCUMENT_POSITION_FOLLOWING = 4;\n/**\n * otherNode is an ancestor of the node.\n */\nNode.DOCUMENT_POSITION_CONTAINS = 8;\n/**\n * otherNode is a descendant of the node.\n */\nNode.DOCUMENT_POSITION_CONTAINED_BY = 16;\n/**\n * The result relies upon arbitrary and/or implementation-specific behavior and is not guaranteed to be portable.\n */\nNode.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC = 32;\n\nvar PROPAGATION_LIMIT = 2048;\nvar EventService = /*#__PURE__*/function () {\n  function EventService(globalRuntime, context) {\n    var _this = this;\n    _classCallCheck(this, EventService);\n    this.emitter = new EventEmitter();\n    /**\n     * Store HTML elements in current canvas.\n     */\n    this.nativeHTMLMap = new WeakMap();\n    this.cursor = 'default';\n    this.mappingTable = {};\n    this.mappingState = {\n      trackingData: {}\n    };\n    this.eventPool = new Map();\n    this.tmpMatrix = mat4.create();\n    this.tmpVec3 = vec3.create();\n    this.onPointerDown = function (from) {\n      var e = _this.createPointerEvent(from);\n      _this.dispatchEvent(e, 'pointerdown');\n      if (e.pointerType === 'touch') {\n        _this.dispatchEvent(e, 'touchstart');\n      } else if (e.pointerType === 'mouse' || e.pointerType === 'pen') {\n        var isRightButton = e.button === 2;\n        _this.dispatchEvent(e, isRightButton ? 'rightdown' : 'mousedown');\n      }\n      var trackingData = _this.trackingData(from.pointerId);\n      trackingData.pressTargetsByButton[from.button] = e.composedPath();\n      _this.freeEvent(e);\n    };\n    this.onPointerUp = function (from) {\n      var now = clock.now();\n      var e = _this.createPointerEvent(from, undefined, undefined, _this.context.config.alwaysTriggerPointerEventOnCanvas ? _this.rootTarget : undefined);\n      _this.dispatchEvent(e, 'pointerup');\n      if (e.pointerType === 'touch') {\n        _this.dispatchEvent(e, 'touchend');\n      } else if (e.pointerType === 'mouse' || e.pointerType === 'pen') {\n        var isRightButton = e.button === 2;\n        _this.dispatchEvent(e, isRightButton ? 'rightup' : 'mouseup');\n      }\n      var trackingData = _this.trackingData(from.pointerId);\n      var pressTarget = _this.findMountedTarget(trackingData.pressTargetsByButton[from.button]);\n      var clickTarget = pressTarget;\n\n      // pointerupoutside only bubbles. It only bubbles upto the parent that doesn't contain\n      // the pointerup location.\n      if (pressTarget && !e.composedPath().includes(pressTarget)) {\n        var currentTarget = pressTarget;\n        while (currentTarget && !e.composedPath().includes(currentTarget)) {\n          e.currentTarget = currentTarget;\n          _this.notifyTarget(e, 'pointerupoutside');\n          if (e.pointerType === 'touch') {\n            _this.notifyTarget(e, 'touchendoutside');\n          } else if (e.pointerType === 'mouse' || e.pointerType === 'pen') {\n            var _isRightButton = e.button === 2;\n            _this.notifyTarget(e, _isRightButton ? 'rightupoutside' : 'mouseupoutside');\n          }\n          if (Node.isNode(currentTarget)) {\n            currentTarget = currentTarget.parentNode;\n          }\n        }\n        delete trackingData.pressTargetsByButton[from.button];\n\n        // currentTarget is the most specific ancestor holding both the pointerdown and pointerup\n        // targets. That is - it's our click target!\n        clickTarget = currentTarget;\n      }\n      if (clickTarget) {\n        var _e$detail;\n        var clickEvent = _this.clonePointerEvent(e, 'click');\n        clickEvent.target = clickTarget;\n        clickEvent.path = [];\n        if (!trackingData.clicksByButton[from.button]) {\n          trackingData.clicksByButton[from.button] = {\n            clickCount: 0,\n            target: clickEvent.target,\n            timeStamp: now\n          };\n        }\n        var canvas = _this.context.renderingContext.root.ownerDocument.defaultView;\n        var clickHistory = trackingData.clicksByButton[from.button];\n        if (clickHistory.target === clickEvent.target && now - clickHistory.timeStamp < canvas.dblClickSpeed) {\n          ++clickHistory.clickCount;\n        } else {\n          clickHistory.clickCount = 1;\n        }\n        clickHistory.target = clickEvent.target;\n        clickHistory.timeStamp = now;\n        clickEvent.detail = clickHistory.clickCount;\n\n        // @see https://github.com/antvis/G/issues/1091\n        if (!((_e$detail = e.detail) !== null && _e$detail !== void 0 && _e$detail.preventClick)) {\n          if (!_this.context.config.useNativeClickEvent && (clickEvent.pointerType === 'mouse' || clickEvent.pointerType === 'touch')) {\n            _this.dispatchEvent(clickEvent, 'click');\n          }\n          _this.dispatchEvent(clickEvent, 'pointertap');\n        }\n        _this.freeEvent(clickEvent);\n      }\n      _this.freeEvent(e);\n    };\n    this.onPointerMove = function (from) {\n      var e = _this.createPointerEvent(from, undefined, undefined, _this.context.config.alwaysTriggerPointerEventOnCanvas ? _this.rootTarget : undefined);\n      var isMouse = e.pointerType === 'mouse' || e.pointerType === 'pen';\n      var trackingData = _this.trackingData(from.pointerId);\n      var outTarget = _this.findMountedTarget(trackingData.overTargets);\n\n      // First pointerout/pointerleave\n      if (trackingData.overTargets && outTarget !== e.target) {\n        // pointerout always occurs on the overTarget when the pointer hovers over another element.\n        var outType = from.type === 'mousemove' ? 'mouseout' : 'pointerout';\n        var outEvent = _this.createPointerEvent(from, outType, outTarget || undefined);\n        _this.dispatchEvent(outEvent, 'pointerout');\n        if (isMouse) _this.dispatchEvent(outEvent, 'mouseout');\n\n        // If the pointer exits overTarget and its descendants, then a pointerleave event is also fired. This event\n        // is dispatched to all ancestors that no longer capture the pointer.\n        if (!e.composedPath().includes(outTarget)) {\n          var leaveEvent = _this.createPointerEvent(from, 'pointerleave', outTarget || undefined);\n          leaveEvent.eventPhase = leaveEvent.AT_TARGET;\n          while (leaveEvent.target && !e.composedPath().includes(leaveEvent.target)) {\n            leaveEvent.currentTarget = leaveEvent.target;\n            _this.notifyTarget(leaveEvent);\n            if (isMouse) {\n              _this.notifyTarget(leaveEvent, 'mouseleave');\n            }\n            if (Node.isNode(leaveEvent.target)) {\n              leaveEvent.target = leaveEvent.target.parentNode;\n            }\n          }\n          _this.freeEvent(leaveEvent);\n        }\n        _this.freeEvent(outEvent);\n      }\n\n      // Then pointerover\n      if (outTarget !== e.target) {\n        // pointerover always occurs on the new overTarget\n        var overType = from.type === 'mousemove' ? 'mouseover' : 'pointerover';\n        var overEvent = _this.clonePointerEvent(e, overType); // clone faster\n\n        _this.dispatchEvent(overEvent, 'pointerover');\n        if (isMouse) _this.dispatchEvent(overEvent, 'mouseover');\n\n        // Probe whether the newly hovered Node is an ancestor of the original overTarget.\n        var overTargetAncestor = outTarget && Node.isNode(outTarget) && outTarget.parentNode;\n        while (overTargetAncestor && overTargetAncestor !== (Node.isNode(_this.rootTarget) && _this.rootTarget.parentNode)) {\n          if (overTargetAncestor === e.target) break;\n          overTargetAncestor = overTargetAncestor.parentNode;\n        }\n\n        // The pointer has entered a non-ancestor of the original overTarget. This means we need a pointerentered\n        // event.\n        var didPointerEnter = !overTargetAncestor || overTargetAncestor === (Node.isNode(_this.rootTarget) && _this.rootTarget.parentNode);\n        if (didPointerEnter) {\n          var enterEvent = _this.clonePointerEvent(e, 'pointerenter');\n          enterEvent.eventPhase = enterEvent.AT_TARGET;\n          while (enterEvent.target && enterEvent.target !== outTarget && enterEvent.target !== (Node.isNode(_this.rootTarget) && _this.rootTarget.parentNode)) {\n            enterEvent.currentTarget = enterEvent.target;\n            _this.notifyTarget(enterEvent);\n            if (isMouse) _this.notifyTarget(enterEvent, 'mouseenter');\n            if (Node.isNode(enterEvent.target)) {\n              enterEvent.target = enterEvent.target.parentNode;\n            }\n          }\n          _this.freeEvent(enterEvent);\n        }\n        _this.freeEvent(overEvent);\n      }\n\n      // Then pointermove\n      _this.dispatchEvent(e, 'pointermove');\n      if (e.pointerType === 'touch') _this.dispatchEvent(e, 'touchmove');\n      if (isMouse) {\n        _this.dispatchEvent(e, 'mousemove');\n        _this.cursor = _this.getCursor(e.target);\n      }\n      trackingData.overTargets = e.composedPath();\n      _this.freeEvent(e);\n    };\n    this.onPointerOut = function (from) {\n      var trackingData = _this.trackingData(from.pointerId);\n      if (trackingData.overTargets) {\n        var isMouse = from.pointerType === 'mouse' || from.pointerType === 'pen';\n        var outTarget = _this.findMountedTarget(trackingData.overTargets);\n\n        // pointerout first\n        var outEvent = _this.createPointerEvent(from, 'pointerout', outTarget || undefined);\n        _this.dispatchEvent(outEvent);\n        if (isMouse) _this.dispatchEvent(outEvent, 'mouseout');\n\n        // pointerleave(s) are also dispatched b/c the pointer must've left rootTarget and its descendants to\n        // get an upstream pointerout event (upstream events do not know rootTarget has descendants).\n        var leaveEvent = _this.createPointerEvent(from, 'pointerleave', outTarget || undefined);\n        leaveEvent.eventPhase = leaveEvent.AT_TARGET;\n        while (leaveEvent.target && leaveEvent.target !== (Node.isNode(_this.rootTarget) && _this.rootTarget.parentNode)) {\n          leaveEvent.currentTarget = leaveEvent.target;\n          _this.notifyTarget(leaveEvent);\n          if (isMouse) {\n            _this.notifyTarget(leaveEvent, 'mouseleave');\n          }\n          if (Node.isNode(leaveEvent.target)) {\n            leaveEvent.target = leaveEvent.target.parentNode;\n          }\n        }\n        trackingData.overTargets = null;\n        _this.freeEvent(outEvent);\n        _this.freeEvent(leaveEvent);\n      }\n      _this.cursor = null;\n    };\n    this.onPointerOver = function (from) {\n      var trackingData = _this.trackingData(from.pointerId);\n      var e = _this.createPointerEvent(from);\n      var isMouse = e.pointerType === 'mouse' || e.pointerType === 'pen';\n      _this.dispatchEvent(e, 'pointerover');\n      if (isMouse) _this.dispatchEvent(e, 'mouseover');\n      if (e.pointerType === 'mouse') _this.cursor = _this.getCursor(e.target);\n\n      // pointerenter events must be fired since the pointer entered from upstream.\n      var enterEvent = _this.clonePointerEvent(e, 'pointerenter');\n      enterEvent.eventPhase = enterEvent.AT_TARGET;\n      while (enterEvent.target && enterEvent.target !== (Node.isNode(_this.rootTarget) && _this.rootTarget.parentNode)) {\n        enterEvent.currentTarget = enterEvent.target;\n        _this.notifyTarget(enterEvent);\n        if (isMouse) {\n          // mouseenter should not bubble\n          // @see https://developer.mozilla.org/en-US/docs/Web/API/Element/mouseenter_event#usage_notes\n          _this.notifyTarget(enterEvent, 'mouseenter');\n        }\n        if (Node.isNode(enterEvent.target)) {\n          enterEvent.target = enterEvent.target.parentNode;\n        }\n      }\n      trackingData.overTargets = e.composedPath();\n      _this.freeEvent(e);\n      _this.freeEvent(enterEvent);\n    };\n    this.onPointerUpOutside = function (from) {\n      var trackingData = _this.trackingData(from.pointerId);\n      var pressTarget = _this.findMountedTarget(trackingData.pressTargetsByButton[from.button]);\n      var e = _this.createPointerEvent(from);\n      if (pressTarget) {\n        var currentTarget = pressTarget;\n        while (currentTarget) {\n          e.currentTarget = currentTarget;\n          _this.notifyTarget(e, 'pointerupoutside');\n          if (e.pointerType === 'touch') ; else if (e.pointerType === 'mouse' || e.pointerType === 'pen') {\n            _this.notifyTarget(e, e.button === 2 ? 'rightupoutside' : 'mouseupoutside');\n          }\n          if (Node.isNode(currentTarget)) {\n            currentTarget = currentTarget.parentNode;\n          }\n        }\n        delete trackingData.pressTargetsByButton[from.button];\n      }\n      _this.freeEvent(e);\n    };\n    this.onWheel = function (from) {\n      var wheelEvent = _this.createWheelEvent(from);\n      _this.dispatchEvent(wheelEvent);\n      _this.freeEvent(wheelEvent);\n    };\n    this.onClick = function (from) {\n      if (_this.context.config.useNativeClickEvent) {\n        var e = _this.createPointerEvent(from);\n        _this.dispatchEvent(e);\n        _this.freeEvent(e);\n      }\n    };\n    this.onPointerCancel = function (from) {\n      var e = _this.createPointerEvent(from, undefined, undefined, _this.context.config.alwaysTriggerPointerEventOnCanvas ? _this.rootTarget : undefined);\n      _this.dispatchEvent(e);\n      _this.freeEvent(e);\n    };\n    this.globalRuntime = globalRuntime;\n    this.context = context;\n  }\n  return _createClass(EventService, [{\n    key: \"init\",\n    value: function init() {\n      this.rootTarget = this.context.renderingContext.root.parentNode; // document\n      this.addEventMapping('pointerdown', this.onPointerDown);\n      this.addEventMapping('pointerup', this.onPointerUp);\n      this.addEventMapping('pointermove', this.onPointerMove);\n      this.addEventMapping('pointerout', this.onPointerOut);\n      this.addEventMapping('pointerleave', this.onPointerOut);\n      this.addEventMapping('pointercancel', this.onPointerCancel);\n      this.addEventMapping('pointerover', this.onPointerOver);\n      this.addEventMapping('pointerupoutside', this.onPointerUpOutside);\n      this.addEventMapping('wheel', this.onWheel);\n      this.addEventMapping('click', this.onClick);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.emitter.removeAllListeners();\n      this.mappingTable = {};\n      this.mappingState = {};\n      this.eventPool.clear();\n    }\n  }, {\n    key: \"getScale\",\n    value: function getScale() {\n      var bbox = this.context.contextService.getBoundingClientRect();\n      var scaleX = 1;\n      var scaleY = 1;\n      var $el = this.context.contextService.getDomElement();\n      if ($el && bbox) {\n        var offsetWidth = $el.offsetWidth,\n          offsetHeight = $el.offsetHeight;\n        if (offsetWidth && offsetHeight) {\n          scaleX = bbox.width / offsetWidth;\n          scaleY = bbox.height / offsetHeight;\n        }\n      }\n      return {\n        scaleX: scaleX,\n        scaleY: scaleY,\n        bbox: bbox\n      };\n    }\n\n    /**\n     * Should account for CSS Transform applied on container.\n     * @see https://github.com/antvis/G/issues/1161\n     * @see https://github.com/antvis/G/issues/1677\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/MouseEvent/offsetX\n     */\n  }, {\n    key: \"client2Viewport\",\n    value: function client2Viewport(client) {\n      var _this$getScale = this.getScale(),\n        scaleX = _this$getScale.scaleX,\n        scaleY = _this$getScale.scaleY,\n        bbox = _this$getScale.bbox;\n      return new Point((client.x - ((bbox === null || bbox === void 0 ? void 0 : bbox.left) || 0)) / scaleX, (client.y - ((bbox === null || bbox === void 0 ? void 0 : bbox.top) || 0)) / scaleY);\n    }\n  }, {\n    key: \"viewport2Client\",\n    value: function viewport2Client(canvas) {\n      var _this$getScale2 = this.getScale(),\n        scaleX = _this$getScale2.scaleX,\n        scaleY = _this$getScale2.scaleY,\n        bbox = _this$getScale2.bbox;\n      return new Point((canvas.x + ((bbox === null || bbox === void 0 ? void 0 : bbox.left) || 0)) * scaleX, (canvas.y + ((bbox === null || bbox === void 0 ? void 0 : bbox.top) || 0)) * scaleY);\n    }\n  }, {\n    key: \"viewport2Canvas\",\n    value: function viewport2Canvas(_ref) {\n      var x = _ref.x,\n        y = _ref.y;\n      var canvas = this.rootTarget.defaultView;\n      var camera = canvas.getCamera();\n      var _this$context$config = this.context.config,\n        width = _this$context$config.width,\n        height = _this$context$config.height;\n      var projectionMatrixInverse = camera.getPerspectiveInverse();\n      var worldMatrix = camera.getWorldTransform();\n      var vpMatrix = mat4.multiply(this.tmpMatrix, worldMatrix, projectionMatrixInverse);\n      var viewport = vec3.set(this.tmpVec3, x / width * 2 - 1, (1 - y / height) * 2 - 1, 0);\n      vec3.transformMat4(viewport, viewport, vpMatrix);\n      return new Point(viewport[0], viewport[1]);\n    }\n  }, {\n    key: \"canvas2Viewport\",\n    value: function canvas2Viewport(canvasP) {\n      var canvas = this.rootTarget.defaultView;\n      var camera = canvas.getCamera();\n\n      // World -> Clip\n      var projectionMatrix = camera.getPerspective();\n      var viewMatrix = camera.getViewTransform();\n      var vpMatrix = mat4.multiply(this.tmpMatrix, projectionMatrix, viewMatrix);\n      var clip = vec3.set(this.tmpVec3, canvasP.x, canvasP.y, 0);\n      vec3.transformMat4(this.tmpVec3, this.tmpVec3, vpMatrix);\n\n      // Clip -> NDC -> Viewport, flip Y\n      var _this$context$config2 = this.context.config,\n        width = _this$context$config2.width,\n        height = _this$context$config2.height;\n      return new Point((clip[0] + 1) / 2 * width, (1 - (clip[1] + 1) / 2) * height);\n    }\n  }, {\n    key: \"setPickHandler\",\n    value: function setPickHandler(pickHandler) {\n      this.pickHandler = pickHandler;\n    }\n  }, {\n    key: \"addEventMapping\",\n    value: function addEventMapping(type, fn) {\n      if (!this.mappingTable[type]) {\n        this.mappingTable[type] = [];\n      }\n      this.mappingTable[type].push({\n        fn: fn,\n        priority: 0\n      });\n      this.mappingTable[type].sort(function (a, b) {\n        return a.priority - b.priority;\n      });\n    }\n  }, {\n    key: \"mapEvent\",\n    value: function mapEvent(e) {\n      if (!this.rootTarget) {\n        return;\n      }\n      var mappers = this.mappingTable[e.type];\n      if (mappers) {\n        for (var i = 0, j = mappers.length; i < j; i++) {\n          mappers[i].fn(e);\n        }\n      } else {\n        console.warn(\"[EventService]: Event mapping not defined for \".concat(e.type));\n      }\n    }\n  }, {\n    key: \"dispatchEvent\",\n    value: function dispatchEvent(e, type, skipPropagate) {\n      // Canvas should skip\n      if (!skipPropagate) {\n        e.propagationStopped = false;\n        e.propagationImmediatelyStopped = false;\n        this.propagate(e, type);\n      } else {\n        // target phase\n        e.eventPhase = e.AT_TARGET;\n        var canvas = this.rootTarget.defaultView || null;\n        e.currentTarget = canvas;\n        this.notifyListeners(e, type);\n      }\n      this.emitter.emit(type || e.type, e);\n    }\n  }, {\n    key: \"propagate\",\n    value: function propagate(e, type) {\n      if (!e.target) {\n        return;\n      }\n\n      // [target, parent, root, Canvas]\n      var composedPath = e.composedPath();\n\n      // event flow: capture -> target -> bubbling\n\n      // capture phase\n      e.eventPhase = e.CAPTURING_PHASE;\n      for (var i = composedPath.length - 1; i >= 1; i--) {\n        e.currentTarget = composedPath[i];\n        this.notifyTarget(e, type);\n        if (e.propagationStopped || e.propagationImmediatelyStopped) return;\n      }\n\n      // target phase\n      e.eventPhase = e.AT_TARGET;\n      e.currentTarget = e.target;\n      this.notifyTarget(e, type);\n      if (e.propagationStopped || e.propagationImmediatelyStopped) return;\n\n      // find current target in composed path\n      var index = composedPath.indexOf(e.currentTarget);\n\n      // bubbling phase\n      e.eventPhase = e.BUBBLING_PHASE;\n      for (var _i = index + 1; _i < composedPath.length; _i++) {\n        e.currentTarget = composedPath[_i];\n        this.notifyTarget(e, type);\n        if (e.propagationStopped || e.propagationImmediatelyStopped) return;\n      }\n    }\n  }, {\n    key: \"propagationPath\",\n    value: function propagationPath(target) {\n      var propagationPath = [target];\n      var canvas = this.rootTarget.defaultView || null;\n      if (canvas && canvas === target) {\n        propagationPath.unshift(canvas.document);\n        return propagationPath;\n      }\n      for (var i = 0; i < PROPAGATION_LIMIT && target !== this.rootTarget; i++) {\n        // if (Node.isNode(target) && !target.parentNode) {\n        //   throw new Error('Cannot find propagation path to disconnected target');\n        // }\n\n        if (Node.isNode(target) && target.parentNode) {\n          // [target, parent, parent, root]\n          propagationPath.push(target.parentNode);\n          target = target.parentNode;\n        }\n      }\n      if (canvas) {\n        // @ts-ignore\n        propagationPath.push(canvas);\n      }\n      return propagationPath;\n    }\n  }, {\n    key: \"hitTest\",\n    value: function hitTest(position) {\n      var viewportX = position.viewportX,\n        viewportY = position.viewportY;\n      var _this$context$config3 = this.context.config,\n        width = _this$context$config3.width,\n        height = _this$context$config3.height,\n        disableHitTesting = _this$context$config3.disableHitTesting;\n      // outside canvas\n      if (viewportX < 0 || viewportY < 0 || viewportX > width || viewportY > height) {\n        return null;\n      }\n      return !disableHitTesting && this.pickHandler(position) || this.rootTarget ||\n      // return Document\n      null;\n    }\n\n    /**\n     * whether the native event trigger came from Canvas,\n     * should account for HTML shape\n     */\n  }, {\n    key: \"isNativeEventFromCanvas\",\n    value: function isNativeEventFromCanvas($el, nativeEvent) {\n      var _target;\n      var target = nativeEvent === null || nativeEvent === void 0 ? void 0 : nativeEvent.target;\n      // Get event target inside a web component.\n      // @see https://stackoverflow.com/questions/57963312/get-event-target-inside-a-web-component\n      if ((_target = target) !== null && _target !== void 0 && _target.shadowRoot) {\n        target = nativeEvent.composedPath()[0];\n      }\n      if (target) {\n        // from <canvas>\n        if (target === $el) {\n          return true;\n        }\n\n        // from <svg>\n        if ($el && $el.contains) {\n          return $el.contains(target);\n        }\n      }\n      if (nativeEvent !== null && nativeEvent !== void 0 && nativeEvent.composedPath) {\n        return nativeEvent.composedPath().indexOf($el) > -1;\n      }\n\n      // account for Touch\n      return false;\n    }\n\n    /**\n     * Find HTML from composed path in native UI event.\n     */\n  }, {\n    key: \"getExistedHTML\",\n    value: function getExistedHTML(event) {\n      if (event.nativeEvent.composedPath) {\n        for (var _i2 = 0, _arr = event.nativeEvent.composedPath(); _i2 < _arr.length; _i2++) {\n          var eventTarget = _arr[_i2];\n          var existed = this.nativeHTMLMap.get(eventTarget);\n          if (existed) {\n            return existed;\n          }\n        }\n      }\n      return null;\n    }\n  }, {\n    key: \"pickTarget\",\n    value: function pickTarget(event) {\n      return this.hitTest({\n        clientX: event.clientX,\n        clientY: event.clientY,\n        viewportX: event.viewportX,\n        viewportY: event.viewportY,\n        x: event.canvasX,\n        y: event.canvasY\n      });\n    }\n  }, {\n    key: \"createPointerEvent\",\n    value: function createPointerEvent(from, type, target, fallbackTarget) {\n      var event = this.allocateEvent(FederatedPointerEvent);\n      this.copyPointerData(from, event);\n      this.copyMouseData(from, event);\n      this.copyData(from, event);\n      event.nativeEvent = from.nativeEvent;\n      event.originalEvent = from;\n      var existedHTML = this.getExistedHTML(event);\n      var $el = this.context.contextService.getDomElement();\n      event.target = target !== null && target !== void 0 ? target : existedHTML || this.isNativeEventFromCanvas($el, event.nativeEvent) && this.pickTarget(event) || fallbackTarget;\n      if (typeof type === 'string') {\n        event.type = type;\n      }\n      return event;\n    }\n  }, {\n    key: \"createWheelEvent\",\n    value: function createWheelEvent(from) {\n      var event = this.allocateEvent(FederatedWheelEvent);\n      this.copyWheelData(from, event);\n      this.copyMouseData(from, event);\n      this.copyData(from, event);\n      event.nativeEvent = from.nativeEvent;\n      event.originalEvent = from;\n      var existedHTML = this.getExistedHTML(event);\n      var $el = this.context.contextService.getDomElement();\n      event.target = existedHTML || this.isNativeEventFromCanvas($el, event.nativeEvent) && this.pickTarget(event);\n      return event;\n    }\n  }, {\n    key: \"trackingData\",\n    value: function trackingData(id) {\n      if (!this.mappingState.trackingData[id]) {\n        this.mappingState.trackingData[id] = {\n          pressTargetsByButton: {},\n          clicksByButton: {},\n          overTarget: null\n        };\n      }\n      return this.mappingState.trackingData[id];\n    }\n  }, {\n    key: \"cloneWheelEvent\",\n    value: function cloneWheelEvent(from) {\n      var event = this.allocateEvent(FederatedWheelEvent);\n      event.nativeEvent = from.nativeEvent;\n      event.originalEvent = from.originalEvent;\n      this.copyWheelData(from, event);\n      this.copyMouseData(from, event);\n      this.copyData(from, event);\n      event.target = from.target;\n      event.path = from.composedPath().slice();\n      event.type = from.type;\n      return event;\n    }\n  }, {\n    key: \"clonePointerEvent\",\n    value: function clonePointerEvent(from, type) {\n      var event = this.allocateEvent(FederatedPointerEvent);\n      event.nativeEvent = from.nativeEvent;\n      event.originalEvent = from.originalEvent;\n      this.copyPointerData(from, event);\n      this.copyMouseData(from, event);\n      this.copyData(from, event);\n      event.target = from.target;\n      event.path = from.composedPath().slice();\n      event.type = type !== null && type !== void 0 ? type : event.type;\n      return event;\n    }\n  }, {\n    key: \"copyPointerData\",\n    value: function copyPointerData(from, to) {\n      // if (\n      //   !(\n      //     from instanceof FederatedPointerEvent &&\n      //     to instanceof FederatedPointerEvent\n      //   )\n      // )\n      //   return;\n\n      to.pointerId = from.pointerId;\n      to.width = from.width;\n      to.height = from.height;\n      to.isPrimary = from.isPrimary;\n      to.pointerType = from.pointerType;\n      to.pressure = from.pressure;\n      to.tangentialPressure = from.tangentialPressure;\n      to.tiltX = from.tiltX;\n      to.tiltY = from.tiltY;\n      to.twist = from.twist;\n    }\n  }, {\n    key: \"copyMouseData\",\n    value: function copyMouseData(from, to) {\n      // if (\n      //   !(\n      //     from instanceof FederatedMouseEvent && to instanceof FederatedMouseEvent\n      //   )\n      // )\n      //   return;\n\n      to.altKey = from.altKey;\n      to.button = from.button;\n      to.buttons = from.buttons;\n      to.ctrlKey = from.ctrlKey;\n      to.metaKey = from.metaKey;\n      to.shiftKey = from.shiftKey;\n      to.client.copyFrom(from.client);\n      to.movement.copyFrom(from.movement);\n      to.canvas.copyFrom(from.canvas);\n      to.screen.copyFrom(from.screen);\n      to.global.copyFrom(from.global);\n      to.offset.copyFrom(from.offset);\n    }\n  }, {\n    key: \"copyWheelData\",\n    value: function copyWheelData(from, to) {\n      to.deltaMode = from.deltaMode;\n      to.deltaX = from.deltaX;\n      to.deltaY = from.deltaY;\n      to.deltaZ = from.deltaZ;\n    }\n  }, {\n    key: \"copyData\",\n    value: function copyData(from, to) {\n      to.isTrusted = from.isTrusted;\n      to.timeStamp = clock.now();\n      to.type = from.type;\n      to.detail = from.detail;\n      to.view = from.view;\n      to.page.copyFrom(from.page);\n      to.viewport.copyFrom(from.viewport);\n    }\n  }, {\n    key: \"allocateEvent\",\n    value: function allocateEvent(constructor) {\n      if (!this.eventPool.has(constructor)) {\n        this.eventPool.set(constructor, []);\n      }\n\n      // @ts-ignore\n      var event = this.eventPool.get(constructor).pop() || new constructor(this);\n      event.eventPhase = event.NONE;\n      event.currentTarget = null;\n      event.path = [];\n      event.target = null;\n      return event;\n    }\n  }, {\n    key: \"freeEvent\",\n    value: function freeEvent(event) {\n      if (event.manager !== this) throw new Error('It is illegal to free an event not managed by this EventBoundary!');\n      var constructor = event.constructor;\n      if (!this.eventPool.has(constructor)) {\n        this.eventPool.set(constructor, []);\n      }\n\n      // @ts-ignore\n      this.eventPool.get(constructor).push(event);\n    }\n  }, {\n    key: \"notifyTarget\",\n    value: function notifyTarget(e, type) {\n      var _type;\n      type = (_type = type) !== null && _type !== void 0 ? _type : e.type;\n      var key = e.eventPhase === e.CAPTURING_PHASE || e.eventPhase === e.AT_TARGET ? \"\".concat(type, \"capture\") : type;\n      this.notifyListeners(e, key);\n      if (e.eventPhase === e.AT_TARGET) {\n        this.notifyListeners(e, type);\n      }\n    }\n  }, {\n    key: \"notifyListeners\",\n    value: function notifyListeners(e, type) {\n      // hack EventEmitter, stops if the `propagationImmediatelyStopped` flag is set\n      // @ts-ignore\n      var emitter = e.currentTarget.emitter;\n      // @ts-ignore\n      var listeners = emitter._events[type];\n      if (!listeners) return;\n      if ('fn' in listeners) {\n        if (listeners.once) {\n          emitter.removeListener(type, listeners.fn, undefined, true);\n        }\n        listeners.fn.call(e.currentTarget || listeners.context, e);\n        // listeners.fn.call(listeners.context, e);\n      } else {\n        for (var i = 0; i < listeners.length && !e.propagationImmediatelyStopped; i++) {\n          if (listeners[i].once) {\n            emitter.removeListener(type, listeners[i].fn, undefined, true);\n          }\n          listeners[i].fn.call(e.currentTarget || listeners[i].context, e);\n          // listeners[i].fn.call(listeners[i].context, e);\n        }\n      }\n    }\n\n    /**\n     * some detached nodes may exist in propagation path, need to skip them\n     */\n  }, {\n    key: \"findMountedTarget\",\n    value: function findMountedTarget(propagationPath) {\n      if (!propagationPath) {\n        return null;\n      }\n      var currentTarget = propagationPath[propagationPath.length - 1];\n      for (var i = propagationPath.length - 2; i >= 0; i--) {\n        var target = propagationPath[i];\n        if (target === this.rootTarget || Node.isNode(target) && target.parentNode === currentTarget) {\n          currentTarget = propagationPath[i];\n        } else {\n          break;\n        }\n      }\n      return currentTarget;\n    }\n  }, {\n    key: \"getCursor\",\n    value: function getCursor(target) {\n      var tmp = target;\n      while (tmp) {\n        var cursor = isElement(tmp) && tmp.getAttribute('cursor');\n        if (cursor) {\n          return cursor;\n        }\n        tmp = Node.isNode(tmp) && tmp.parentNode;\n      }\n    }\n  }]);\n}();\n\n/**\n * used in following scenes:\n * - g `ctx.measureText`\n * - g-plugin-canvas-picker `ctx.isPointInPath`\n * - g-plugin-device-renderer `ctx.createLinearGradient` and generate texture\n *\n * @see https://blog.scottlogic.com/2020/03/19/offscreen-canvas.html\n */\nvar OffscreenCanvasCreator = /*#__PURE__*/function () {\n  function OffscreenCanvasCreator() {\n    _classCallCheck(this, OffscreenCanvasCreator);\n  }\n  return _createClass(OffscreenCanvasCreator, [{\n    key: \"getOrCreateCanvas\",\n    value: function getOrCreateCanvas(offscreenCanvas, contextAttributes) {\n      if (this.canvas) {\n        return this.canvas;\n      }\n\n      // user-defined offscreen canvas\n      if (offscreenCanvas || runtime.offscreenCanvas) {\n        this.canvas = offscreenCanvas || runtime.offscreenCanvas;\n        this.context = this.canvas.getContext('2d', _objectSpread({\n          willReadFrequently: true\n        }, contextAttributes));\n      } else {\n        try {\n          // OffscreenCanvas2D measureText can be up to 40% faster.\n          this.canvas = new window.OffscreenCanvas(0, 0);\n          this.context = this.canvas.getContext('2d', _objectSpread({\n            willReadFrequently: true\n          }, contextAttributes));\n          if (!this.context || !this.context.measureText) {\n            this.canvas = document.createElement('canvas');\n            this.context = this.canvas.getContext('2d');\n          }\n        } catch (_unused) {\n          this.canvas = document.createElement('canvas');\n          this.context = this.canvas.getContext('2d', _objectSpread({\n            willReadFrequently: true\n          }, contextAttributes));\n        }\n      }\n      this.canvas.width = 10;\n      this.canvas.height = 10;\n      return this.canvas;\n    }\n  }, {\n    key: \"getOrCreateContext\",\n    value: function getOrCreateContext(offscreenCanvas, contextAttributes) {\n      if (this.context) {\n        return this.context;\n      }\n      this.getOrCreateCanvas(offscreenCanvas, contextAttributes);\n      return this.context;\n    }\n  }], [{\n    key: \"createCanvas\",\n    value:\n    /**\n     * @returns new canvas instance\n     */\n    function createCanvas() {\n      try {\n        return new window.OffscreenCanvas(0, 0);\n      } catch (_unused2) {\n        //\n      }\n      try {\n        return document.createElement('canvas');\n      } catch (_unused3) {\n        //\n      }\n      return null;\n    }\n  }]);\n}();\n\n/**\n * why we need re-render\n */\nvar RenderReason = /*#__PURE__*/function (RenderReason) {\n  RenderReason[RenderReason[\"CAMERA_CHANGED\"] = 0] = \"CAMERA_CHANGED\";\n  RenderReason[RenderReason[\"DISPLAY_OBJECT_CHANGED\"] = 1] = \"DISPLAY_OBJECT_CHANGED\";\n  RenderReason[RenderReason[\"NONE\"] = 2] = \"NONE\";\n  return RenderReason;\n}({});\n\n/**\n * Use frame renderer implemented by `g-canvas/svg/webgl`, in every frame we do followings:\n * * update & merge dirty rectangles\n * * begin frame\n * * filter by visible\n * * sort by z-index in scene graph\n * * culling with strategies registered in `g-canvas/webgl`\n * * end frame\n */\nvar RenderingService = /*#__PURE__*/function () {\n  function RenderingService(globalRuntime, context) {\n    _classCallCheck(this, RenderingService);\n    this.inited = false;\n    this.stats = {\n      /**\n       * total display objects in scenegraph\n       */\n      total: 0,\n      /**\n       * number of display objects need to render in current frame\n       */\n      rendered: 0\n    };\n    this.zIndexCounter = 0;\n    this.hooks = {\n      /**\n       * called before any frame rendered\n       */\n      init: new SyncHook(),\n      initAsync: new AsyncParallelHook(),\n      /**\n       * only dirty object which has sth changed will be rendered\n       */\n      dirtycheck: new SyncWaterfallHook(),\n      /**\n       * do culling\n       */\n      cull: new SyncWaterfallHook(),\n      /**\n       * called at beginning of each frame, won't get called if nothing to re-render\n       */\n      beginFrame: new SyncHook(),\n      /**\n       * called before every dirty object get rendered\n       */\n      beforeRender: new SyncHook(),\n      /**\n       * called when every dirty object rendering even it's culled\n       */\n      render: new SyncHook(),\n      /**\n       * called after every dirty object get rendered\n       */\n      afterRender: new SyncHook(),\n      endFrame: new SyncHook(),\n      destroy: new SyncHook(),\n      /**\n       * use async but faster method such as GPU-based picking in `g-plugin-device-renderer`\n       */\n      pick: new AsyncSeriesWaterfallHook(),\n      /**\n       * Unsafe but sync version of pick.\n       */\n      pickSync: new SyncWaterfallHook(),\n      /**\n       * used in event system\n       */\n      pointerDown: new SyncHook(),\n      pointerUp: new SyncHook(),\n      pointerMove: new SyncHook(),\n      pointerOut: new SyncHook(),\n      pointerOver: new SyncHook(),\n      pointerWheel: new SyncHook(),\n      pointerCancel: new SyncHook(),\n      click: new SyncHook()\n    };\n    this.globalRuntime = globalRuntime;\n    this.context = context;\n  }\n  return _createClass(RenderingService, [{\n    key: \"init\",\n    value: function init(callback) {\n      var _this = this;\n      var context = _objectSpread(_objectSpread({}, this.globalRuntime), this.context);\n\n      // register rendering plugins\n      this.context.renderingPlugins.forEach(function (plugin) {\n        plugin.apply(context, _this.globalRuntime);\n      });\n      this.hooks.init.call();\n      if (this.hooks.initAsync.getCallbacksNum() === 0) {\n        this.inited = true;\n        callback();\n      } else {\n        this.hooks.initAsync.promise().then(function () {\n          _this.inited = true;\n          callback();\n        });\n      }\n    }\n  }, {\n    key: \"getStats\",\n    value: function getStats() {\n      return this.stats;\n    }\n\n    /**\n     * Meet the following conditions:\n     * * disable DirtyRectangleRendering\n     * * camera changed\n     */\n  }, {\n    key: \"disableDirtyRectangleRendering\",\n    value: function disableDirtyRectangleRendering() {\n      var renderer = this.context.config.renderer;\n      var _renderer$getConfig = renderer.getConfig(),\n        enableDirtyRectangleRendering = _renderer$getConfig.enableDirtyRectangleRendering;\n      return !enableDirtyRectangleRendering || this.context.renderingContext.renderReasons.has(RenderReason.CAMERA_CHANGED);\n    }\n  }, {\n    key: \"render\",\n    value: function render(canvasConfig, frame, rerenderCallback) {\n      var _this2 = this;\n      this.stats.total = 0;\n      this.stats.rendered = 0;\n      this.zIndexCounter = 0;\n      var renderingContext = this.context.renderingContext;\n      this.globalRuntime.sceneGraphService.syncHierarchy(renderingContext.root);\n      this.globalRuntime.sceneGraphService.triggerPendingEvents();\n      if (renderingContext.renderReasons.size && this.inited) {\n        // @ts-ignore\n        renderingContext.dirtyRectangleRenderingDisabled = this.disableDirtyRectangleRendering();\n        var onlyCameraChanged = renderingContext.renderReasons.size === 1 && renderingContext.renderReasons.has(RenderReason.CAMERA_CHANGED);\n        var shouldTriggerRenderHooks = !canvasConfig.disableRenderHooks || !(canvasConfig.disableRenderHooks && onlyCameraChanged);\n        if (shouldTriggerRenderHooks) {\n          this.renderDisplayObject(renderingContext.root, canvasConfig, renderingContext);\n        }\n        this.hooks.beginFrame.call(frame);\n        if (shouldTriggerRenderHooks) {\n          renderingContext.renderListCurrentFrame.forEach(function (object) {\n            _this2.hooks.beforeRender.call(object);\n            _this2.hooks.render.call(object);\n            _this2.hooks.afterRender.call(object);\n          });\n        }\n        this.hooks.endFrame.call(frame);\n        renderingContext.renderListCurrentFrame = [];\n        renderingContext.renderReasons.clear();\n        rerenderCallback();\n      }\n\n      // console.log('stats', this.stats);\n    }\n  }, {\n    key: \"renderDisplayObject\",\n    value: function renderDisplayObject(displayObject, canvasConfig, renderingContext) {\n      var _this3 = this;\n      var _canvasConfig$rendere = canvasConfig.renderer.getConfig(),\n        enableDirtyCheck = _canvasConfig$rendere.enableDirtyCheck,\n        enableCulling = _canvasConfig$rendere.enableCulling;\n\n      // TODO: relayout\n\n      // dirtycheck first\n      var renderable = displayObject.renderable;\n      // eslint-disable-next-line no-nested-ternary\n      var objectChanged = enableDirtyCheck ?\n      // @ts-ignore\n      renderable.dirty || renderingContext.dirtyRectangleRenderingDisabled ? displayObject : null : displayObject;\n      if (objectChanged) {\n        var objectToRender = enableCulling ? this.hooks.cull.call(objectChanged, this.context.camera) : objectChanged;\n        if (objectToRender) {\n          this.stats.rendered++;\n          renderingContext.renderListCurrentFrame.push(objectToRender);\n        }\n      }\n      displayObject.renderable.dirty = false;\n      displayObject.sortable.renderOrder = this.zIndexCounter++;\n      this.stats.total++;\n\n      // sort is very expensive, use cached result if possible\n      var sortable = displayObject.sortable;\n      if (sortable.dirty) {\n        this.sort(displayObject, sortable);\n        sortable.dirty = false;\n        sortable.dirtyChildren = [];\n        sortable.dirtyReason = undefined;\n      }\n\n      // recursive rendering its children\n      (sortable.sorted || displayObject.childNodes).forEach(function (child) {\n        _this3.renderDisplayObject(child, canvasConfig, renderingContext);\n      });\n    }\n  }, {\n    key: \"sort\",\n    value: function sort(displayObject, sortable) {\n      if (sortable.sorted && sortable.dirtyReason !== SortReason.Z_INDEX_CHANGED) {\n        // avoid re-sorting the whole children list\n        sortable.dirtyChildren.forEach(function (child) {\n          var index = displayObject.childNodes.indexOf(child);\n          if (index === -1) {\n            // remove from sorted list\n            var _index = sortable.sorted.indexOf(child);\n            if (_index >= 0) {\n              sortable.sorted.splice(_index, 1);\n            }\n          } else if (sortable.sorted.length === 0) {\n            sortable.sorted.push(child);\n          } else {\n            var _index2 = sortedIndex(sortable.sorted, child);\n            sortable.sorted.splice(_index2, 0, child);\n          }\n        });\n      } else {\n        sortable.sorted = displayObject.childNodes.slice().sort(sortByZIndex);\n      }\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.inited = false;\n      this.hooks.destroy.call();\n      this.globalRuntime.sceneGraphService.clearPendingEvents();\n    }\n  }, {\n    key: \"dirtify\",\n    value: function dirtify() {\n      // need re-render\n      this.context.renderingContext.renderReasons.add(RenderReason.DISPLAY_OBJECT_CHANGED);\n    }\n  }]);\n}();\n\nvar ATTRIBUTE_REGEXP = /\\[\\s*(.*)=(.*)\\s*\\]/;\n\n/**\n * support the following DOM API:\n * * getElementById\n * * getElementsByClassName\n * * getElementsByName\n * * getElementsByTag\n * * querySelector\n * * querySelectorAll\n */\nvar DefaultSceneGraphSelector = /*#__PURE__*/function () {\n  function DefaultSceneGraphSelector() {\n    _classCallCheck(this, DefaultSceneGraphSelector);\n  }\n  return _createClass(DefaultSceneGraphSelector, [{\n    key: \"selectOne\",\n    value: function selectOne(query, root) {\n      var _this = this;\n      if (query.startsWith('.')) {\n        return root.find(function (node) {\n          // return !node.shadow && node.id === query.substring(1);\n          return ((node === null || node === void 0 ? void 0 : node.classList) || []).indexOf(_this.getIdOrClassname(query)) > -1;\n        });\n      }\n      if (query.startsWith('#')) {\n        // getElementById('id')\n        return root.find(function (node) {\n          // return !node.shadow && node.id === query.substring(1);\n          return node.id === _this.getIdOrClassname(query);\n        });\n      }\n      if (query.startsWith('[')) {\n        var _this$getAttribute = this.getAttribute(query),\n          name = _this$getAttribute.name,\n          value = _this$getAttribute.value;\n        if (name) {\n          // getElementByName();\n          return root.find(function (node) {\n            return root !== node && (name === 'name' ? node.name === value : _this.attributeToString(node, name) === value);\n          });\n        }\n        return null;\n      }\n      // getElementsByTag('circle');\n      return root.find(function (node) {\n        return root !== node && node.nodeName === query;\n      });\n    }\n  }, {\n    key: \"selectAll\",\n    value: function selectAll(query, root) {\n      var _this2 = this;\n      // only support `[name=\"${name}\"]` `.className` `#id`\n      if (query.startsWith('.')) {\n        // getElementsByClassName('className');\n        // should not include itself\n        return root.findAll(function (node) {\n          return root !== node && ((node === null || node === void 0 ? void 0 : node.classList) || []).indexOf(_this2.getIdOrClassname(query)) > -1;\n        });\n      }\n      if (query.startsWith('#')) {\n        return root.findAll(function (node) {\n          return root !== node && node.id === _this2.getIdOrClassname(query);\n        });\n      }\n      if (query.startsWith('[')) {\n        var _this$getAttribute2 = this.getAttribute(query),\n          name = _this$getAttribute2.name,\n          value = _this$getAttribute2.value;\n        if (name) {\n          // getElementsByName();\n          return root.findAll(function (node) {\n            return root !== node && (name === 'name' ? node.name === value : _this2.attributeToString(node, name) === value);\n          });\n        }\n        return [];\n      }\n      // getElementsByTag('circle');\n      return root.findAll(function (node) {\n        return root !== node && node.nodeName === query;\n      });\n    }\n  }, {\n    key: \"is\",\n    value: function is(query, node) {\n      // a simple `matches` implementation\n      if (query.startsWith('.')) {\n        return node.className === this.getIdOrClassname(query);\n      }\n      if (query.startsWith('#')) {\n        return node.id === this.getIdOrClassname(query);\n      }\n      if (query.startsWith('[')) {\n        var _this$getAttribute3 = this.getAttribute(query),\n          name = _this$getAttribute3.name,\n          value = _this$getAttribute3.value;\n        return name === 'name' ? node.name === value : this.attributeToString(node, name) === value;\n      }\n      return node.nodeName === query;\n    }\n  }, {\n    key: \"getIdOrClassname\",\n    value: function getIdOrClassname(query) {\n      return query.substring(1);\n    }\n  }, {\n    key: \"getAttribute\",\n    value: function getAttribute(query) {\n      var matches = query.match(ATTRIBUTE_REGEXP);\n      var name = '';\n      var value = '';\n      if (matches && matches.length > 2) {\n        name = matches[1].replace(/\"/g, '');\n        value = matches[2].replace(/\"/g, '');\n      }\n      return {\n        name: name,\n        value: value\n      };\n    }\n  }, {\n    key: \"attributeToString\",\n    value: function attributeToString(node, name) {\n      if (!node.getAttribute) {\n        return '';\n      }\n      var value = node.getAttribute(name);\n      if (isNil(value)) {\n        return '';\n      }\n      if (value.toString) {\n        return value.toString();\n      }\n      return '';\n    }\n  }]);\n}();\n\n/**\n * built-in events for element\n * @see https://developer.mozilla.org/en-US/docs/Web/API/MutationEvent\n *\n * TODO: use MutationObserver instead\n * @see https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver\n */\nvar ElementEvent = /*#__PURE__*/function (ElementEvent) {\n  ElementEvent[\"REPARENT\"] = \"reparent\";\n  ElementEvent[\"DESTROY\"] = \"destroy\";\n  ElementEvent[\"ATTR_MODIFIED\"] = \"DOMAttrModified\";\n  ElementEvent[\"INSERTED\"] = \"DOMNodeInserted\";\n  ElementEvent[\"REMOVED\"] = \"removed\";\n  ElementEvent[\"MOUNTED\"] = \"DOMNodeInsertedIntoDocument\";\n  ElementEvent[\"UNMOUNTED\"] = \"DOMNodeRemovedFromDocument\";\n  ElementEvent[\"BOUNDS_CHANGED\"] = \"bounds-changed\";\n  ElementEvent[\"CULLED\"] = \"culled\";\n  return ElementEvent;\n}({});\n\n/**\n * @see https://developer.mozilla.org/zh-CN/docs/Web/API/CSSStyleDeclaration\n */\n\nvar MutationEvent = /*#__PURE__*/function (_FederatedEvent) {\n  function MutationEvent(typeArg, relatedNode, prevValue, newValue, attrName, attrChange, prevParsedValue, newParsedValue) {\n    var _this;\n    _classCallCheck(this, MutationEvent);\n    _this = _callSuper(this, MutationEvent, [null]);\n    _this.relatedNode = relatedNode;\n    _this.prevValue = prevValue;\n    _this.newValue = newValue;\n    _this.attrName = attrName;\n    _this.attrChange = attrChange;\n    _this.prevParsedValue = prevParsedValue;\n    _this.newParsedValue = newParsedValue;\n    _this.type = typeArg;\n    return _this;\n  }\n  _inherits(MutationEvent, _FederatedEvent);\n  return _createClass(MutationEvent);\n}(FederatedEvent);\nMutationEvent.ADDITION = 2;\nMutationEvent.MODIFICATION = 1;\nMutationEvent.REMOVAL = 3;\n\nfunction markRenderableDirty(e) {\n  var renderable = e.renderable;\n  if (renderable) {\n    renderable.renderBoundsDirty = true;\n    renderable.boundsDirty = true;\n  }\n}\nvar reparentEvent = new MutationEvent(ElementEvent.REPARENT, null, '', '', '', 0, '', '');\n\n// Object pooling\n/** do not modify this objects */\nvar $vec2Zero = vec2.create();\n/** do not modify this objects */\nvar $vec3Zero = vec3.create();\n/** do not modify this objects */\nvar $vec3One = vec3.fromValues(1, 1, 1);\n/** do not modify this objects */\nvar $mat4Identity = mat4.create();\n\n/** shared objects */\nvar $vec2 = vec2.create();\n/** shared objects */\nvar $vec3$1 = vec3.create();\n/** shared objects */\nvar $mat4 = mat4.create();\n/** shared objects */\nvar $quat$1 = quat$1.create();\nvar $setLocalTransform_1 = vec3.create();\nvar $setLocalTransform_2 = quat$1.create();\nvar $setLocalTransform_3 = vec3.create();\nvar $setLocalPosition = vec3.create();\nvar $setPosition_1 = vec3.create();\nvar $setPosition_ParentInvertMatrix = mat4.create();\nvar $setEulerAngles_InvParentRot = quat$1.create();\nvar $rotateLocal = quat$1.create();\nvar $rotate_ParentInvertRotation = quat$1.create();\nvar $triggerPendingEvents_detail = {\n  affectChildren: true\n};\n\n/**\n * update transform in scene graph\n *\n * @see https://community.khronos.org/t/scene-graphs/50542/7\n */\nvar DefaultSceneGraphService = /*#__PURE__*/function () {\n  function DefaultSceneGraphService(runtime) {\n    _classCallCheck(this, DefaultSceneGraphService);\n    // target -> affectChildren\n    this.pendingEvents = new Map();\n    this.boundsChangedEvent = new CustomEvent(ElementEvent.BOUNDS_CHANGED);\n    this.displayObjectDependencyMap = new WeakMap();\n    this.runtime = runtime;\n  }\n  return _createClass(DefaultSceneGraphService, [{\n    key: \"matches\",\n    value: function matches(query, root) {\n      return this.runtime.sceneGraphSelector.is(query, root);\n    }\n  }, {\n    key: \"querySelector\",\n    value: function querySelector(query, root) {\n      return this.runtime.sceneGraphSelector.selectOne(query, root);\n    }\n  }, {\n    key: \"querySelectorAll\",\n    value: function querySelectorAll(query, root) {\n      return this.runtime.sceneGraphSelector.selectAll(query, root);\n      // .filter((node) => !node.shadow);\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(child, parent, index) {\n      var _sortable$sorted;\n      var detached = false;\n      if (child.parentNode) {\n        detached = child.parentNode !== parent;\n        this.detach(child);\n      }\n      var isChildFragment = child.nodeName === Shape.FRAGMENT;\n      var isAttachToFragment = isInFragment(parent);\n      child.parentNode = parent;\n      var nodes = isChildFragment ? child.childNodes : [child];\n      if (isNumber(index)) {\n        nodes.forEach(function (node) {\n          parent.childNodes.splice(index, 0, node);\n          node.parentNode = parent;\n        });\n      } else {\n        nodes.forEach(function (node) {\n          parent.childNodes.push(node);\n          node.parentNode = parent;\n        });\n      }\n\n      // parent needs re-sort\n      var _ref = parent,\n        sortable = _ref.sortable;\n      if (sortable !== null && sortable !== void 0 && (_sortable$sorted = sortable.sorted) !== null && _sortable$sorted !== void 0 && _sortable$sorted.length || child.parsedStyle.zIndex) {\n        if (sortable.dirtyChildren.indexOf(child) === -1) {\n          sortable.dirtyChildren.push(child);\n        }\n        // if (sortable) {\n        // only child has z-Index\n        sortable.dirty = true;\n        sortable.dirtyReason = SortReason.ADDED;\n      }\n      if (isAttachToFragment) return;\n      if (isChildFragment) this.dirtifyFragment(child);else {\n        var transform = child.transformable;\n        if (transform) {\n          this.dirtifyWorld(child, transform);\n        }\n      }\n      if (detached) {\n        child.dispatchEvent(reparentEvent);\n      }\n    }\n  }, {\n    key: \"detach\",\n    value: function detach(child) {\n      if (child.parentNode) {\n        var _sortable$sorted2, _style;\n        var transform = child.transformable;\n        // if (transform) {\n        //   const worldTransform = this.getWorldTransform(child, transform);\n        //   mat4.getScaling(transform.localScale, worldTransform);\n        //   mat4.getTranslation(transform.localPosition, worldTransform);\n        //   mat4.getRotation(transform.localRotation, worldTransform);\n        //   transform.localDirtyFlag = true;\n        // }\n\n        // parent needs re-sort\n        var _ref2 = child.parentNode,\n          sortable = _ref2.sortable;\n        // if (sortable) {\n        if (sortable !== null && sortable !== void 0 && (_sortable$sorted2 = sortable.sorted) !== null && _sortable$sorted2 !== void 0 && _sortable$sorted2.length || (_style = child.style) !== null && _style !== void 0 && _style.zIndex) {\n          if (sortable.dirtyChildren.indexOf(child) === -1) {\n            sortable.dirtyChildren.push(child);\n          }\n          sortable.dirty = true;\n          sortable.dirtyReason = SortReason.REMOVED;\n        }\n        var index = child.parentNode.childNodes.indexOf(child);\n        if (index > -1) {\n          child.parentNode.childNodes.splice(index, 1);\n        }\n        if (transform) {\n          this.dirtifyWorld(child, transform);\n        }\n        child.parentNode = null;\n      }\n    }\n  }, {\n    key: \"getOrigin\",\n    value: function getOrigin(element) {\n      element.getGeometryBounds();\n      return element.transformable.origin;\n    }\n\n    /**\n     * same as pivot in Pixi.js\n     *\n     * @see https://stackoverflow.com/questions/40748452/how-to-change-css-transform-origin-but-preserve-transformation\n     */\n  }, {\n    key: \"setOrigin\",\n    value: function setOrigin(element, origin) {\n      var y = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var z = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      if (typeof origin === 'number') {\n        origin = [origin, y, z];\n      }\n      var transform = element.transformable;\n      if (origin[0] === transform.origin[0] && origin[1] === transform.origin[1] && origin[2] === transform.origin[2]) {\n        return;\n      }\n      var originVec = transform.origin;\n\n      // const delta = vec3.subtract(vec3.create(), origin, originVec);\n      // vec3.add(transform.localPosition, transform.localPosition, delta);\n\n      // update origin\n      originVec[0] = origin[0];\n      originVec[1] = origin[1];\n      originVec[2] = origin[2] || 0;\n      this.dirtifyLocal(element, transform);\n    }\n\n    /**\n     * rotate in world space\n     */\n  }, {\n    key: \"rotate\",\n    value: function rotate(element, degrees) {\n      var y = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var z = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      if (typeof degrees === 'number') {\n        degrees = vec3.fromValues(degrees, y, z);\n      }\n      var transform = element.transformable;\n      if (element.parentNode === null || !element.parentNode.transformable) {\n        this.rotateLocal(element, degrees);\n      } else {\n        var rotation = $quat$1;\n        quat$1.fromEuler(rotation, degrees[0], degrees[1], degrees[2]);\n        var rot = this.getRotation(element);\n        var parentRot = this.getRotation(element.parentNode);\n        quat$1.copy($rotate_ParentInvertRotation, parentRot);\n        quat$1.invert($rotate_ParentInvertRotation, $rotate_ParentInvertRotation);\n        quat$1.multiply(rotation, $rotate_ParentInvertRotation, rotation);\n        quat$1.multiply(transform.localRotation, rotation, rot);\n        quat$1.normalize(transform.localRotation, transform.localRotation);\n        this.dirtifyLocal(element, transform);\n      }\n    }\n\n    /**\n     * rotate in local space\n     * @see @see https://docs.microsoft.com/en-us/windows/win32/api/directxmath/nf-directxmath-xmquaternionrotationrollpitchyaw\n     */\n  }, {\n    key: \"rotateLocal\",\n    value: function rotateLocal(element, degrees) {\n      var y = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var z = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      if (typeof degrees === 'number') {\n        degrees = vec3.fromValues(degrees, y, z);\n      }\n      var transform = element.transformable;\n      quat$1.fromEuler($rotateLocal, degrees[0], degrees[1], degrees[2]);\n      quat$1.mul(transform.localRotation, transform.localRotation, $rotateLocal);\n      this.dirtifyLocal(element, transform);\n    }\n\n    /**\n     * set euler angles(degrees) in world space\n     */\n  }, {\n    key: \"setEulerAngles\",\n    value: function setEulerAngles(element, degrees) {\n      var y = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var z = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      if (typeof degrees === 'number') {\n        degrees = vec3.fromValues(degrees, y, z);\n      }\n      var transform = element.transformable;\n      if (element.parentNode === null || !element.parentNode.transformable) {\n        this.setLocalEulerAngles(element, degrees);\n      } else {\n        quat$1.fromEuler(transform.localRotation, degrees[0], degrees[1], degrees[2]);\n        var parentRotation = this.getRotation(element.parentNode);\n        quat$1.copy($setEulerAngles_InvParentRot, quat$1.invert($quat$1, parentRotation));\n        quat$1.mul(transform.localRotation, transform.localRotation, $setEulerAngles_InvParentRot);\n        this.dirtifyLocal(element, transform);\n      }\n    }\n\n    /**\n     * set euler angles(degrees) in local space\n     */\n  }, {\n    key: \"setLocalEulerAngles\",\n    value: function setLocalEulerAngles(element, degrees) {\n      var y = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var z = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      var dirtify = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : true;\n      if (typeof degrees === 'number') {\n        degrees = vec3.fromValues(degrees, y, z);\n      }\n      var transform = element.transformable;\n      quat$1.fromEuler(transform.localRotation, degrees[0], degrees[1], degrees[2]);\n      if (dirtify) {\n        this.dirtifyLocal(element, transform);\n      }\n    }\n\n    /**\n     * translate in local space\n     *\n     * @example\n     * ```\n     * translateLocal(x, y, z)\n     * translateLocal(vec3(x, y, z))\n     * ```\n     */\n  }, {\n    key: \"translateLocal\",\n    value: function translateLocal(element, translation) {\n      var y = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var z = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      if (typeof translation === 'number') {\n        translation = vec3.fromValues(translation, y, z);\n      }\n      var transform = element.transformable;\n      if (vec3.equals(translation, $vec3Zero)) return;\n      vec3.transformQuat(translation, translation, transform.localRotation);\n      vec3.add(transform.localPosition, transform.localPosition, translation);\n      this.dirtifyLocal(element, transform);\n    }\n\n    /**\n     * move to position in world space\n     *\n     * 对应 g 原版的 move/moveTo\n     * @see https://github.com/antvis/g/blob/master/packages/g-base/src/abstract/element.ts#L684-L689\n     */\n  }, {\n    key: \"setPosition\",\n    value: function setPosition(element, position) {\n      var _position$;\n      var transform = element.transformable;\n      $setPosition_1[0] = position[0];\n      $setPosition_1[1] = position[1];\n      $setPosition_1[2] = (_position$ = position[2]) !== null && _position$ !== void 0 ? _position$ : 0;\n      if (vec3.equals(this.getPosition(element), $setPosition_1)) {\n        return;\n      }\n      vec3.copy(transform.position, $setPosition_1);\n      if (element.parentNode === null || !element.parentNode.transformable) {\n        vec3.copy(transform.localPosition, $setPosition_1);\n      } else {\n        var parentTransform = element.parentNode.transformable;\n        mat4.copy($setPosition_ParentInvertMatrix, parentTransform.worldTransform);\n        mat4.invert($setPosition_ParentInvertMatrix, $setPosition_ParentInvertMatrix);\n        vec3.transformMat4(transform.localPosition, $setPosition_1, $setPosition_ParentInvertMatrix);\n      }\n      this.dirtifyLocal(element, transform);\n    }\n\n    /**\n     * move to position in local space\n     */\n  }, {\n    key: \"setLocalPosition\",\n    value: function setLocalPosition(element, position) {\n      var _position$2;\n      var dirtify = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      var transform = element.transformable;\n      $setLocalPosition[0] = position[0];\n      $setLocalPosition[1] = position[1];\n      $setLocalPosition[2] = (_position$2 = position[2]) !== null && _position$2 !== void 0 ? _position$2 : 0;\n      if (vec3.equals(transform.localPosition, $setLocalPosition)) {\n        return;\n      }\n      vec3.copy(transform.localPosition, $setLocalPosition);\n      if (dirtify) {\n        this.dirtifyLocal(element, transform);\n      }\n    }\n\n    /**\n     * scale in local space\n     */\n  }, {\n    key: \"scaleLocal\",\n    value: function scaleLocal(element, scaling) {\n      var _scaling$;\n      var transform = element.transformable;\n      vec3.multiply(transform.localScale, transform.localScale, vec3.set($vec3$1, scaling[0], scaling[1], (_scaling$ = scaling[2]) !== null && _scaling$ !== void 0 ? _scaling$ : 1));\n      this.dirtifyLocal(element, transform);\n    }\n  }, {\n    key: \"setLocalScale\",\n    value: function setLocalScale(element, scaling) {\n      var _scaling$2;\n      var dirtify = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      var transform = element.transformable;\n      vec3.set($vec3$1, scaling[0], scaling[1], (_scaling$2 = scaling[2]) !== null && _scaling$2 !== void 0 ? _scaling$2 : transform.localScale[2]);\n      if (vec3.equals($vec3$1, transform.localScale)) {\n        return;\n      }\n      vec3.copy(transform.localScale, $vec3$1);\n      if (dirtify) {\n        this.dirtifyLocal(element, transform);\n      }\n    }\n\n    /**\n     * translate in world space\n     *\n     * @example\n     * ```\n     * translate(x, y, z)\n     * translate(vec3(x, y, z))\n     * ```\n     *\n     * 对应 g 原版的 translate 2D\n     * @see https://github.com/antvis/g/blob/master/packages/g-base/src/abstract/element.ts#L665-L676\n     */\n  }, {\n    key: \"translate\",\n    value: function translate(element, translation) {\n      var y = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var z = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      if (typeof translation === 'number') {\n        translation = vec3.set($vec3$1, translation, y, z);\n      }\n      if (vec3.equals(translation, $vec3Zero)) return;\n      vec3.add($vec3$1, this.getPosition(element), translation);\n      this.setPosition(element, $vec3$1);\n    }\n  }, {\n    key: \"setRotation\",\n    value: function setRotation(element, rotation, y, z, w) {\n      var transform = element.transformable;\n      if (typeof rotation === 'number') {\n        rotation = quat$1.fromValues(rotation, y, z, w);\n      }\n      if (element.parentNode === null || !element.parentNode.transformable) {\n        this.setLocalRotation(element, rotation);\n      } else {\n        var parentRot = this.getRotation(element.parentNode);\n        quat$1.copy($quat$1, parentRot);\n        quat$1.invert($quat$1, $quat$1);\n        quat$1.multiply(transform.localRotation, $quat$1, rotation);\n        quat$1.normalize(transform.localRotation, transform.localRotation);\n        this.dirtifyLocal(element, transform);\n      }\n    }\n  }, {\n    key: \"setLocalRotation\",\n    value: function setLocalRotation(element, rotation, y, z, w) {\n      var dirtify = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : true;\n      if (typeof rotation === 'number') {\n        rotation = quat$1.set($quat$1, rotation, y, z, w);\n      }\n      var transform = element.transformable;\n      quat$1.copy(transform.localRotation, rotation);\n      if (dirtify) {\n        this.dirtifyLocal(element, transform);\n      }\n    }\n  }, {\n    key: \"setLocalSkew\",\n    value: function setLocalSkew(element, skew, y) {\n      var dirtify = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n      if (typeof skew === 'number') {\n        skew = vec2.set($vec2, skew, y);\n      }\n      var transform = element.transformable;\n      vec2.copy(transform.localSkew, skew);\n      if (dirtify) {\n        this.dirtifyLocal(element, transform);\n      }\n    }\n  }, {\n    key: \"dirtifyLocal\",\n    value: function dirtifyLocal(element, transform) {\n      if (isInFragment(element)) return;\n      if (!transform.localDirtyFlag) {\n        transform.localDirtyFlag = true;\n        if (!transform.dirtyFlag) {\n          this.dirtifyWorld(element, transform);\n        }\n      }\n    }\n  }, {\n    key: \"dirtifyWorld\",\n    value: function dirtifyWorld(element, transform) {\n      if (!transform.dirtyFlag) {\n        this.unfreezeParentToRoot(element);\n      }\n      this.dirtifyWorldInternal(element, transform);\n      this.dirtifyToRoot(element, true);\n    }\n  }, {\n    key: \"dirtifyFragment\",\n    value: function dirtifyFragment(element) {\n      var transform = element.transformable;\n      if (transform) {\n        transform.frozen = false;\n        transform.dirtyFlag = true;\n        transform.localDirtyFlag = true;\n      }\n      var renderable = element.renderable;\n      if (renderable) {\n        renderable.renderBoundsDirty = true;\n        renderable.boundsDirty = true;\n        renderable.dirty = true;\n      }\n      var length = element.childNodes.length;\n      for (var i = 0; i < length; i++) {\n        this.dirtifyFragment(element.childNodes[i]);\n      }\n      if (element.nodeName === Shape.FRAGMENT) {\n        this.pendingEvents.set(element, false);\n      }\n    }\n  }, {\n    key: \"triggerPendingEvents\",\n    value: function triggerPendingEvents() {\n      var _this = this;\n      var triggered = new Set();\n      var skipped = new Set();\n      this.pendingEvents.forEach(function (_, element) {\n        if (element.nodeName === Shape.FRAGMENT) {\n          element.forEach(function (e) {\n            if (e !== element) skipped.add(e);\n          });\n        }\n      });\n      var trigger = function trigger(element, detail) {\n        if (element.isConnected && !triggered.has(element) && !skipped.has(element)) {\n          _this.boundsChangedEvent.detail = detail;\n          _this.boundsChangedEvent.target = element;\n          if (element.isMutationObserved) {\n            element.dispatchEvent(_this.boundsChangedEvent);\n          } else {\n            element.ownerDocument.defaultView.dispatchEvent(_this.boundsChangedEvent, true);\n          }\n          triggered.add(element);\n        }\n      };\n      this.pendingEvents.forEach(function (affectChildren, element) {\n        $triggerPendingEvents_detail.affectChildren = affectChildren;\n        if (affectChildren) {\n          element.forEach(function (e) {\n            trigger(e, $triggerPendingEvents_detail);\n          });\n        } else trigger(element, $triggerPendingEvents_detail);\n      });\n      triggered.clear();\n      skipped.clear();\n      this.clearPendingEvents();\n    }\n  }, {\n    key: \"clearPendingEvents\",\n    value: function clearPendingEvents() {\n      this.pendingEvents.clear();\n    }\n  }, {\n    key: \"dirtifyToRoot\",\n    value: function dirtifyToRoot(element) {\n      var affectChildren = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var p = element;\n\n      // only need to re-render itself\n      if (p.renderable) {\n        p.renderable.dirty = true;\n      }\n      while (p) {\n        markRenderableDirty(p);\n        p = p.parentNode;\n      }\n      if (affectChildren) {\n        element.forEach(function (e) {\n          markRenderableDirty(e);\n        });\n      }\n      this.informDependentDisplayObjects(element);\n      this.pendingEvents.set(element, affectChildren);\n    }\n  }, {\n    key: \"updateDisplayObjectDependency\",\n    value: function updateDisplayObjectDependency(name, oldPath, newPath, object) {\n      // clear ref to old clip path\n      if (oldPath && oldPath !== newPath) {\n        var oldDependencyMap = this.displayObjectDependencyMap.get(oldPath);\n        if (oldDependencyMap && oldDependencyMap[name]) {\n          var index = oldDependencyMap[name].indexOf(object);\n          oldDependencyMap[name].splice(index, 1);\n        }\n      }\n      if (newPath) {\n        var newDependencyMap = this.displayObjectDependencyMap.get(newPath);\n        if (!newDependencyMap) {\n          this.displayObjectDependencyMap.set(newPath, {});\n          newDependencyMap = this.displayObjectDependencyMap.get(newPath);\n        }\n        if (!newDependencyMap[name]) {\n          newDependencyMap[name] = [];\n        }\n        newDependencyMap[name].push(object);\n      }\n    }\n  }, {\n    key: \"informDependentDisplayObjects\",\n    value: function informDependentDisplayObjects(object) {\n      var _this2 = this;\n      var dependencyMap = this.displayObjectDependencyMap.get(object);\n      if (dependencyMap) {\n        Object.keys(dependencyMap).forEach(function (name) {\n          dependencyMap[name].forEach(function (target) {\n            _this2.dirtifyToRoot(target, true);\n            target.dispatchEvent(new MutationEvent(ElementEvent.ATTR_MODIFIED, target, _this2, _this2, name, MutationEvent.MODIFICATION, _this2, _this2));\n            if (target.isCustomElement && target.isConnected) {\n              if (target.attributeChangedCallback) {\n                target.attributeChangedCallback(name, _this2, _this2);\n              }\n            }\n          });\n        });\n      }\n    }\n  }, {\n    key: \"getPosition\",\n    value: function getPosition(element) {\n      var transform = element.transformable;\n      return mat4.getTranslation(transform.position, this.getWorldTransform(element, transform));\n    }\n  }, {\n    key: \"getRotation\",\n    value: function getRotation(element) {\n      var transform = element.transformable;\n      return mat4.getRotation(transform.rotation, this.getWorldTransform(element, transform));\n    }\n  }, {\n    key: \"getScale\",\n    value: function getScale(element) {\n      var transform = element.transformable;\n      return mat4.getScaling(transform.scaling, this.getWorldTransform(element, transform));\n    }\n  }, {\n    key: \"getWorldTransform\",\n    value: function getWorldTransform(element) {\n      var transform = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : element.transformable;\n      if (!transform.localDirtyFlag && !transform.dirtyFlag) {\n        return transform.worldTransform;\n      }\n      if (element.parentNode && element.parentNode.transformable) {\n        this.getWorldTransform(element.parentNode);\n      }\n      this.sync(element, transform);\n      return transform.worldTransform;\n    }\n  }, {\n    key: \"getLocalPosition\",\n    value: function getLocalPosition(element) {\n      return element.transformable.localPosition;\n    }\n  }, {\n    key: \"getLocalRotation\",\n    value: function getLocalRotation(element) {\n      return element.transformable.localRotation;\n    }\n  }, {\n    key: \"getLocalScale\",\n    value: function getLocalScale(element) {\n      return element.transformable.localScale;\n    }\n  }, {\n    key: \"getLocalSkew\",\n    value: function getLocalSkew(element) {\n      return element.transformable.localSkew;\n    }\n  }, {\n    key: \"calcLocalTransform\",\n    value: function calcLocalTransform(transform) {\n      var hasSkew = transform.localSkew[0] !== 0 || transform.localSkew[1] !== 0;\n      if (hasSkew) {\n        mat4.fromRotationTranslationScaleOrigin(transform.localTransform, transform.localRotation, transform.localPosition, vec3.fromValues(1, 1, 1), transform.origin);\n\n        // apply skew2D\n        if (transform.localSkew[0] !== 0 || transform.localSkew[1] !== 0) {\n          mat4.identity($mat4);\n          $mat4[4] = Math.tan(transform.localSkew[0]);\n          $mat4[1] = Math.tan(transform.localSkew[1]);\n          mat4.multiply(transform.localTransform, transform.localTransform, $mat4);\n        }\n        var scaling = mat4.fromRotationTranslationScaleOrigin($mat4, quat$1.set($quat$1, 0, 0, 0, 1), vec3.set($vec3$1, 1, 1, 1), transform.localScale, transform.origin);\n        mat4.multiply(transform.localTransform, transform.localTransform, scaling);\n      } else {\n        var localTransform = transform.localTransform,\n          localPosition = transform.localPosition,\n          localRotation = transform.localRotation,\n          localScale = transform.localScale,\n          origin = transform.origin;\n        var hasPosition = localPosition[0] !== 0 || localPosition[1] !== 0 || localPosition[2] !== 0;\n        var hasRotation = localRotation[3] !== 1 || localRotation[0] !== 0 || localRotation[1] !== 0 || localRotation[2] !== 0;\n        var hasScale = localScale[0] !== 1 || localScale[1] !== 1 || localScale[2] !== 1;\n        var hasOrigin = origin[0] !== 0 || origin[1] !== 0 || origin[2] !== 0;\n        if (!hasRotation && !hasScale && !hasOrigin) {\n          if (hasPosition) {\n            mat4.fromTranslation(localTransform, localPosition);\n          } else {\n            mat4.identity(localTransform);\n          }\n        } else {\n          // @see https://github.com/mattdesl/css-mat4/blob/master/index.js\n          mat4.fromRotationTranslationScaleOrigin(localTransform, localRotation, localPosition, localScale, origin);\n        }\n      }\n    }\n  }, {\n    key: \"getLocalTransform\",\n    value: function getLocalTransform(element) {\n      var transform = element.transformable;\n      if (transform.localDirtyFlag) {\n        this.calcLocalTransform(transform);\n        transform.localDirtyFlag = false;\n      }\n      return transform.localTransform;\n    }\n  }, {\n    key: \"setLocalTransform\",\n    value: function setLocalTransform(element, transform) {\n      var t = mat4.getTranslation($setLocalTransform_1, transform);\n      var r = mat4.getRotation($setLocalTransform_2, transform);\n      var s = mat4.getScaling($setLocalTransform_3, transform);\n      this.setLocalScale(element, s, false);\n      this.setLocalPosition(element, t, false);\n      this.setLocalRotation(element, r, undefined, undefined, undefined, false);\n      this.dirtifyLocal(element, element.transformable);\n    }\n  }, {\n    key: \"resetLocalTransform\",\n    value: function resetLocalTransform(element) {\n      this.setLocalScale(element, $vec3One, false);\n      this.setLocalPosition(element, $vec3Zero, false);\n      this.setLocalEulerAngles(element, $vec3Zero, undefined, undefined, false);\n      this.setLocalSkew(element, $vec2Zero, undefined, false);\n      this.dirtifyLocal(element, element.transformable);\n    }\n  }, {\n    key: \"getTransformedGeometryBounds\",\n    value: function getTransformedGeometryBounds(element) {\n      var render = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var existedAABB = arguments.length > 2 ? arguments[2] : undefined;\n      var bounds = this.getGeometryBounds(element, render);\n      if (!AABB.isEmpty(bounds)) {\n        var aabb = existedAABB || new AABB();\n        aabb.setFromTransformedAABB(bounds, this.getWorldTransform(element));\n        return aabb;\n      }\n      return null;\n    }\n\n    /**\n     * won't account for children\n     */\n  }, {\n    key: \"getGeometryBounds\",\n    value: function getGeometryBounds(element) {\n      var render = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var _ref3 = element,\n        geometry = _ref3.geometry;\n      if (geometry.dirty) {\n        runtime.styleValueRegistry.updateGeometry(element);\n      }\n      var bounds = render ? geometry.renderBounds : geometry.contentBounds || null;\n      // return (bounds && new AABB(bounds.center, bounds.halfExtents)) || new AABB();\n      return bounds || new AABB();\n    }\n\n    /**\n     * account for children in world space\n     */\n  }, {\n    key: \"getBounds\",\n    value: function getBounds(element) {\n      var _this3 = this;\n      var render = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var _ref4 = element,\n        renderable = _ref4.renderable;\n      if (!renderable.boundsDirty && !render && renderable.bounds) {\n        return renderable.bounds;\n      }\n      if (!renderable.renderBoundsDirty && render && renderable.renderBounds) {\n        return renderable.renderBounds;\n      }\n\n      // reuse existed if possible\n      var existedAABB = render ? renderable.renderBounds : renderable.bounds;\n\n      // reset with geometry's aabb\n      var aabb = this.getTransformedGeometryBounds(element, render, existedAABB);\n\n      // merge children's aabbs\n      var children = element.childNodes;\n      children.forEach(function (child) {\n        var childBounds = _this3.getBounds(child, render);\n        if (childBounds) {\n          if (!aabb) {\n            aabb = existedAABB || new AABB();\n            aabb.update(childBounds.center, childBounds.halfExtents);\n          } else {\n            aabb.add(childBounds);\n          }\n        }\n      });\n      if (!aabb) {\n        aabb = new AABB();\n      }\n      if (render) {\n        // FIXME: account for clip path\n        var clipped = findClosestClipPathTarget(element);\n        if (clipped) {\n          // use bounds under world space\n          var clipPathBounds = clipped.parsedStyle.clipPath.getBounds(render);\n          if (!aabb) {\n            aabb.update(clipPathBounds.center, clipPathBounds.halfExtents);\n          } else if (clipPathBounds) {\n            aabb = clipPathBounds.intersection(aabb);\n          }\n        }\n      }\n      if (render) {\n        renderable.renderBounds = aabb;\n        renderable.renderBoundsDirty = false;\n      } else {\n        renderable.bounds = aabb;\n        renderable.boundsDirty = false;\n      }\n      return aabb;\n    }\n\n    /**\n     * account for children in local space\n     */\n  }, {\n    key: \"getLocalBounds\",\n    value: function getLocalBounds(element) {\n      if (element.parentNode) {\n        var parentInvert = $mat4Identity;\n        if (element.parentNode.transformable) {\n          parentInvert = mat4.invert($mat4, this.getWorldTransform(element.parentNode));\n        }\n        var bounds = this.getBounds(element);\n        if (!AABB.isEmpty(bounds)) {\n          var localBounds = new AABB();\n          localBounds.setFromTransformedAABB(bounds, parentInvert);\n          return localBounds;\n        }\n      }\n      return this.getBounds(element);\n    }\n  }, {\n    key: \"getBoundingClientRect\",\n    value: function getBoundingClientRect(element) {\n      var _element$ownerDocumen;\n      var aabb;\n      var bounds = this.getGeometryBounds(element);\n      if (!AABB.isEmpty(bounds)) {\n        aabb = new AABB();\n        // apply transformation to aabb\n        aabb.setFromTransformedAABB(bounds, this.getWorldTransform(element));\n      }\n\n      // calc context's offset\n      var bbox = (_element$ownerDocumen = element.ownerDocument) === null || _element$ownerDocumen === void 0 || (_element$ownerDocumen = _element$ownerDocumen.defaultView) === null || _element$ownerDocumen === void 0 ? void 0 : _element$ownerDocumen.getContextService().getBoundingClientRect();\n      if (aabb) {\n        var _aabb$getMin = aabb.getMin(),\n          _aabb$getMin2 = _slicedToArray(_aabb$getMin, 2),\n          left = _aabb$getMin2[0],\n          top = _aabb$getMin2[1];\n        var _aabb$getMax = aabb.getMax(),\n          _aabb$getMax2 = _slicedToArray(_aabb$getMax, 2),\n          right = _aabb$getMax2[0],\n          bottom = _aabb$getMax2[1];\n        return new Rectangle(left + ((bbox === null || bbox === void 0 ? void 0 : bbox.left) || 0), top + ((bbox === null || bbox === void 0 ? void 0 : bbox.top) || 0), right - left, bottom - top);\n      }\n      return new Rectangle((bbox === null || bbox === void 0 ? void 0 : bbox.left) || 0, (bbox === null || bbox === void 0 ? void 0 : bbox.top) || 0, 0, 0);\n    }\n  }, {\n    key: \"dirtifyWorldInternal\",\n    value: function dirtifyWorldInternal(element, transform) {\n      var _this4 = this;\n      if (!transform.dirtyFlag) {\n        transform.dirtyFlag = true;\n        transform.frozen = false;\n        element.childNodes.forEach(function (child) {\n          var childTransform = child.transformable;\n          if (!childTransform.dirtyFlag) {\n            _this4.dirtifyWorldInternal(child, childTransform);\n          }\n        });\n        var _ref5 = element,\n          renderable = _ref5.renderable;\n        if (renderable) {\n          renderable.renderBoundsDirty = true;\n          renderable.boundsDirty = true;\n          renderable.dirty = true;\n        }\n      }\n    }\n  }, {\n    key: \"syncHierarchy\",\n    value: function syncHierarchy(element) {\n      var transform = element.transformable;\n      if (transform.frozen) {\n        return;\n      }\n      transform.frozen = true;\n      if (transform.localDirtyFlag || transform.dirtyFlag) {\n        this.sync(element, transform);\n      }\n      var children = element.childNodes;\n      for (var i = 0; i < children.length; i++) {\n        this.syncHierarchy(children[i]);\n      }\n    }\n  }, {\n    key: \"sync\",\n    value: function sync(element, transform) {\n      if (transform.localDirtyFlag) {\n        this.calcLocalTransform(transform);\n        transform.localDirtyFlag = false;\n      }\n      if (transform.dirtyFlag) {\n        var parent = element.parentNode;\n        var parentTransform = parent && parent.transformable;\n        if (parent === null || !parentTransform) {\n          mat4.copy(transform.worldTransform, transform.localTransform);\n        } else {\n          // TODO: should we support scale compensation?\n          // @see https://github.com/playcanvas/engine/issues/1077#issuecomment-359765557\n          mat4.multiply(transform.worldTransform, parentTransform.worldTransform, transform.localTransform);\n        }\n        transform.dirtyFlag = false;\n      }\n    }\n  }, {\n    key: \"unfreezeParentToRoot\",\n    value: function unfreezeParentToRoot(child) {\n      var p = child.parentNode;\n      while (p) {\n        var transform = p.transformable;\n        if (transform) {\n          transform.frozen = false;\n        }\n        p = p.parentNode;\n      }\n    }\n  }]);\n}();\n\nvar TEXT_METRICS = {\n  MetricsString: '|ÉqÅ',\n  BaselineSymbol: 'M',\n  BaselineMultiplier: 1.4,\n  HeightMultiplier: 2,\n  Newlines: [0x000a,\n  // line feed\n  0x000d // carriage return\n  ],\n  BreakingSpaces: [0x0009,\n  // character tabulation\n  0x0020,\n  // space\n  0x2000,\n  // en quad\n  0x2001,\n  // em quad\n  0x2002,\n  // en space\n  0x2003,\n  // em space\n  0x2004,\n  // three-per-em space\n  0x2005,\n  // four-per-em space\n  0x2006,\n  // six-per-em space\n  0x2008,\n  // punctuation space\n  0x2009,\n  // thin space\n  0x200a,\n  // hair space\n  0x205f,\n  // medium mathematical space\n  0x3000 // ideographic space\n  ]\n};\nvar LATIN_REGEX = /[a-zA-Z0-9\\u00C0-\\u00D6\\u00D8-\\u00f6\\u00f8-\\u00ff!\"#$%&'()*+,-./:;]/;\n\n// Line breaking rules in CJK (Kinsoku Shori)\n// Refer from https://en.wikipedia.org/wiki/Line_breaking_rules_in_East_Asian_languages\nvar regexCannotStartZhCn = /[!%),.:;?\\]}¢°·'\"\"†‡›℃∶、。〃〆〕〗〞﹚﹜！＂％＇），．：；？！］｝～]/;\nvar regexCannotEndZhCn = /[$(£¥·'\"〈《「『【〔〖〝﹙﹛＄（．［｛￡￥]/;\nvar regexCannotStartZhTw = /[!),.:;?\\]}¢·–—'\"•\"、。〆〞〕〉》」︰︱︲︳﹐﹑﹒﹓﹔﹕﹖﹘﹚﹜！），．：；？︶︸︺︼︾﹀﹂﹗］｜｝､]/;\nvar regexCannotEndZhTw = /[([{£¥'\"‵〈《「『〔〝︴﹙﹛（｛︵︷︹︻︽︿﹁﹃﹏]/;\nvar regexCannotStartJaJp = /[)\\]｝〕〉》」』】〙〗〟'\"｠»ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻‐゠–〜?!‼⁇⁈⁉・、:;,。.]/;\nvar regexCannotEndJaJp = /[([｛〔〈《「『【〘〖〝'\"｟«—...‥〳〴〵]/;\nvar regexCannotStartKoKr = /[!%),.:;?\\]}¢°'\"†‡℃〆〈《「『〕！％），．：；？］｝]/;\nvar regexCannotEndKoKr = /[$([{£¥'\"々〇〉》」〔＄（［｛｠￥￦#]/;\nvar regexCannotStart = new RegExp(\"\".concat(regexCannotStartZhCn.source, \"|\").concat(regexCannotStartZhTw.source, \"|\").concat(regexCannotStartJaJp.source, \"|\").concat(regexCannotStartKoKr.source));\nvar regexCannotEnd = new RegExp(\"\".concat(regexCannotEndZhCn.source, \"|\").concat(regexCannotEndZhTw.source, \"|\").concat(regexCannotEndJaJp.source, \"|\").concat(regexCannotEndKoKr.source));\n\n/**\n * Borrow from pixi/packages/text/src/TextMetrics.ts\n */\nvar TextService = /*#__PURE__*/function () {\n  function TextService(runtime) {\n    var _this = this;\n    _classCallCheck(this, TextService);\n    /**\n     * font metrics cache\n     */\n    this.fontMetricsCache = {};\n    this.shouldBreakByKinsokuShorui = function (_char, nextChar) {\n      if (_this.isBreakingSpace(nextChar)) return false;\n      if (_char) {\n        // Line breaking rules in CJK (Kinsoku Shori)\n        if (regexCannotEnd.exec(nextChar) || regexCannotStart.exec(_char)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    this.trimByKinsokuShorui = function (prev) {\n      var next = _toConsumableArray(prev);\n      var prevLine = next[next.length - 2];\n      if (!prevLine) {\n        return prev;\n      }\n      var lastChar = prevLine[prevLine.length - 1];\n      next[next.length - 2] = prevLine.slice(0, -1);\n      next[next.length - 1] = lastChar + next[next.length - 1];\n      return next;\n    };\n    this.runtime = runtime;\n  }\n  return _createClass(TextService, [{\n    key: \"measureFont\",\n    value:\n    /**\n     * Calculates the ascent, descent and fontSize of a given font-style.\n     */\n    function measureFont(font, offscreenCanvas) {\n      // as this method is used for preparing assets, don't recalculate things if we don't need to\n      if (this.fontMetricsCache[font]) {\n        return this.fontMetricsCache[font];\n      }\n      var properties = {\n        ascent: 0,\n        descent: 0,\n        fontSize: 0\n      };\n      var canvas = this.runtime.offscreenCanvasCreator.getOrCreateCanvas(offscreenCanvas);\n      var context = this.runtime.offscreenCanvasCreator.getOrCreateContext(offscreenCanvas, {\n        willReadFrequently: true\n      });\n      context.font = font;\n      var metricsString = TEXT_METRICS.MetricsString + TEXT_METRICS.BaselineSymbol;\n      var width = Math.ceil(context.measureText(metricsString).width);\n      var baseline = Math.ceil(context.measureText(TEXT_METRICS.BaselineSymbol).width);\n      var height = TEXT_METRICS.HeightMultiplier * baseline;\n      baseline = baseline * TEXT_METRICS.BaselineMultiplier | 0;\n      // @ts-ignore\n      canvas.width = width;\n      // @ts-ignore\n      canvas.height = height;\n      context.fillStyle = '#f00';\n      context.fillRect(0, 0, width, height);\n      context.font = font;\n      context.textBaseline = 'alphabetic';\n      context.fillStyle = '#000';\n      context.fillText(metricsString, 0, baseline);\n      var imagedata = context.getImageData(0, 0, width || 1, height || 1).data;\n      var pixels = imagedata.length;\n      var line = width * 4;\n      var i = 0;\n      var idx = 0;\n      var stop = false;\n      // ascent. scan from top to bottom until we find a non red pixel\n      for (i = 0; i < baseline; ++i) {\n        for (var j = 0; j < line; j += 4) {\n          if (imagedata[idx + j] !== 255) {\n            stop = true;\n            break;\n          }\n        }\n        if (!stop) {\n          idx += line;\n        } else {\n          break;\n        }\n      }\n      properties.ascent = baseline - i;\n      idx = pixels - line;\n      stop = false;\n      // descent. scan from bottom to top until we find a non red pixel\n      for (i = height; i > baseline; --i) {\n        for (var _j = 0; _j < line; _j += 4) {\n          if (imagedata[idx + _j] !== 255) {\n            stop = true;\n            break;\n          }\n        }\n        if (!stop) {\n          idx -= line;\n        } else {\n          break;\n        }\n      }\n      properties.descent = i - baseline;\n      properties.fontSize = properties.ascent + properties.descent;\n      this.fontMetricsCache[font] = properties;\n      return properties;\n    }\n  }, {\n    key: \"measureText\",\n    value: function measureText(text, parsedStyle, offscreenCanvas) {\n      var _parsedStyle$fontSize = parsedStyle.fontSize,\n        fontSize = _parsedStyle$fontSize === void 0 ? 16 : _parsedStyle$fontSize,\n        _parsedStyle$wordWrap = parsedStyle.wordWrap,\n        wordWrap = _parsedStyle$wordWrap === void 0 ? false : _parsedStyle$wordWrap,\n        strokeHeight = parsedStyle.lineHeight,\n        _parsedStyle$lineWidt = parsedStyle.lineWidth,\n        lineWidth = _parsedStyle$lineWidt === void 0 ? 1 : _parsedStyle$lineWidt,\n        _parsedStyle$textBase = parsedStyle.textBaseline,\n        textBaseline = _parsedStyle$textBase === void 0 ? 'alphabetic' : _parsedStyle$textBase,\n        _parsedStyle$textAlig = parsedStyle.textAlign,\n        textAlign = _parsedStyle$textAlig === void 0 ? 'start' : _parsedStyle$textAlig,\n        _parsedStyle$letterSp = parsedStyle.letterSpacing,\n        letterSpacing = _parsedStyle$letterSp === void 0 ? 0 : _parsedStyle$letterSp,\n        textPath = parsedStyle.textPath;\n        parsedStyle.textPathSide;\n        parsedStyle.textPathStartOffset;\n        var _parsedStyle$leading = parsedStyle.leading,\n        leading = _parsedStyle$leading === void 0 ? 0 : _parsedStyle$leading;\n      var font = toFontString(parsedStyle);\n      var fontProperties = this.measureFont(font, offscreenCanvas);\n      // fallback in case UA disallow canvas data extraction\n      if (fontProperties.fontSize === 0) {\n        fontProperties.fontSize = fontSize;\n        fontProperties.ascent = fontSize;\n      }\n      var context = this.runtime.offscreenCanvasCreator.getOrCreateContext(offscreenCanvas);\n      context.font = font;\n\n      // no overflowing by default\n      parsedStyle.isOverflowing = false;\n      var outputText = wordWrap ? this.wordWrap(text, parsedStyle, offscreenCanvas) : text;\n      var lines = outputText.split(/(?:\\r\\n|\\r|\\n)/);\n      var lineWidths = new Array(lines.length);\n      var maxLineWidth = 0;\n\n      // account for textPath\n      if (textPath) {\n        textPath.getTotalLength();\n\n        // const startingPoint = textPath.getPoint(0);\n\n        for (var i = 0; i < lines.length; i++) {\n          context.measureText(lines[i]).width + (lines[i].length - 1) * letterSpacing;\n          // for (\n          //   let i = reverse ? lines[0].length - 1 : 0;\n          //   reverse ? i >= 0 : i < lines[0].length;\n          //   reverse ? i-- : i++\n          // ) {\n          //   graphemeInfo = lineBounds[i];\n          //   if (positionInPath > totalPathLength) {\n          //     positionInPath %= totalPathLength;\n          //   } else if (positionInPath < 0) {\n          //     positionInPath += totalPathLength;\n          //   }\n          //   // it would probably much faster to send all the grapheme position for a line\n          //   // and calculate path position/angle at once.\n          //   this.setGraphemeOnPath(\n          //     positionInPath,\n          //     graphemeInfo,\n          //     startingPoint\n          //   );\n          //   positionInPath += graphemeInfo.kernedWidth;\n          // }\n        }\n      } else {\n        for (var _i = 0; _i < lines.length; _i++) {\n          // char width + letterSpacing\n          var _lineWidth = context.measureText(lines[_i]).width + (lines[_i].length - 1) * letterSpacing;\n          lineWidths[_i] = _lineWidth;\n          maxLineWidth = Math.max(maxLineWidth, _lineWidth);\n        }\n        var _width = maxLineWidth + lineWidth;\n\n        // if (dropShadow) {\n        //   width += dropShadowDistance;\n        // }\n        var lineHeight = strokeHeight || fontProperties.fontSize + lineWidth;\n        var height = Math.max(lineHeight, fontProperties.fontSize + lineWidth) + (lines.length - 1) * (lineHeight + leading);\n        // if (dropShadow) {\n        //   height += dropShadowDistance;\n        // }\n        lineHeight += leading;\n\n        // handle vertical text baseline\n        var offsetY = 0;\n        if (textBaseline === 'middle') {\n          offsetY = -height / 2;\n        } else if (textBaseline === 'bottom' || textBaseline === 'alphabetic' || textBaseline === 'ideographic') {\n          offsetY = -height;\n        } else if (textBaseline === 'top' || textBaseline === 'hanging') {\n          offsetY = 0;\n        }\n        return {\n          font: font,\n          width: _width,\n          height: height,\n          lines: lines,\n          lineWidths: lineWidths,\n          lineHeight: lineHeight,\n          maxLineWidth: maxLineWidth,\n          fontProperties: fontProperties,\n          lineMetrics: lineWidths.map(function (width, i) {\n            var offsetX = 0;\n            // handle horizontal text align\n            if (textAlign === 'center' || textAlign === 'middle') {\n              offsetX -= width / 2;\n            } else if (textAlign === 'right' || textAlign === 'end') {\n              offsetX -= width;\n            }\n            return new Rectangle(offsetX - lineWidth / 2, offsetY + i * lineHeight, width + lineWidth, lineHeight);\n          })\n        };\n      }\n    }\n  }, {\n    key: \"setGraphemeOnPath\",\n    value: function setGraphemeOnPath() {}\n  }, {\n    key: \"wordWrap\",\n    value: function wordWrap(text, parsedStyle, offscreenCanvas) {\n      var _this2 = this;\n      var _parsedStyle$wordWrap2 = parsedStyle.wordWrapWidth,\n        wordWrapWidth = _parsedStyle$wordWrap2 === void 0 ? 0 : _parsedStyle$wordWrap2,\n        _parsedStyle$letterSp2 = parsedStyle.letterSpacing,\n        letterSpacing = _parsedStyle$letterSp2 === void 0 ? 0 : _parsedStyle$letterSp2,\n        _parsedStyle$maxLines = parsedStyle.maxLines,\n        maxLines = _parsedStyle$maxLines === void 0 ? Infinity : _parsedStyle$maxLines,\n        textOverflow = parsedStyle.textOverflow;\n      var context = this.runtime.offscreenCanvasCreator.getOrCreateContext(offscreenCanvas);\n      var maxWidth = wordWrapWidth + letterSpacing;\n      var ellipsis = '';\n      if (textOverflow === 'ellipsis') {\n        ellipsis = '...';\n      } else if (textOverflow && textOverflow !== 'clip') {\n        ellipsis = textOverflow;\n      }\n      var lines = [];\n      var currentIndex = 0;\n      var currentWidth = 0;\n      var cache = {};\n      var calcWidth = function calcWidth(_char2) {\n        return _this2.getFromCache(_char2, letterSpacing, cache, context);\n      };\n      var ellipsisWidth = Array.from(ellipsis).reduce(function (prev, cur) {\n        return prev + calcWidth(cur);\n      }, 0);\n      var chars = Array.from(text);\n      for (var i = 0; i < chars.length; i++) {\n        var _char3 = chars[i];\n        var prevChar = text[i - 1];\n        var nextChar = text[i + 1];\n        var charWidth = calcWidth(_char3);\n        if (this.isNewline(_char3)) {\n          currentIndex++;\n\n          // exceed maxLines, break immediately\n          if (currentIndex >= maxLines) {\n            parsedStyle.isOverflowing = true;\n            break;\n          }\n          currentWidth = 0;\n          lines[currentIndex] = '';\n          continue;\n        }\n        if (currentWidth > 0 && currentWidth + charWidth > maxWidth) {\n          if (currentIndex + 1 >= maxLines) {\n            parsedStyle.isOverflowing = true;\n\n            // If there is not enough space to display the string itself, it is clipped.\n            // @see https://developer.mozilla.org/en-US/docs/Web/CSS/text-overflow#values\n            if (ellipsisWidth > 0 && ellipsisWidth <= maxWidth) {\n              // Backspace from line's end.\n              var currentLineLength = lines[currentIndex].length;\n              var lastLineWidth = 0;\n              var lastLineIndex = currentLineLength;\n              for (var _i2 = 0; _i2 < currentLineLength; _i2++) {\n                var width = calcWidth(lines[currentIndex][_i2]);\n                if (lastLineWidth + width + ellipsisWidth > maxWidth) {\n                  lastLineIndex = _i2;\n                  break;\n                }\n                lastLineWidth += width;\n              }\n              lines[currentIndex] = (lines[currentIndex] || '').slice(0, lastLineIndex) + ellipsis;\n            }\n            break;\n          }\n          currentIndex++;\n          currentWidth = 0;\n          lines[currentIndex] = '';\n          if (this.isBreakingSpace(_char3)) {\n            continue;\n          }\n          if (!this.canBreakInLastChar(_char3)) {\n            lines = this.trimToBreakable(lines);\n            currentWidth = this.sumTextWidthByCache(lines[currentIndex] || '', cache);\n          }\n          if (this.shouldBreakByKinsokuShorui(_char3, nextChar)) {\n            lines = this.trimByKinsokuShorui(lines);\n            currentWidth += calcWidth(prevChar || '');\n          }\n        }\n        currentWidth += charWidth;\n        lines[currentIndex] = (lines[currentIndex] || '') + _char3;\n      }\n      return lines.join('\\n');\n    }\n  }, {\n    key: \"isBreakingSpace\",\n    value: function isBreakingSpace(_char4) {\n      if (typeof _char4 !== 'string') {\n        return false;\n      }\n      return TEXT_METRICS.BreakingSpaces.indexOf(_char4.charCodeAt(0)) >= 0;\n    }\n  }, {\n    key: \"isNewline\",\n    value: function isNewline(_char5) {\n      if (typeof _char5 !== 'string') {\n        return false;\n      }\n      return TEXT_METRICS.Newlines.indexOf(_char5.charCodeAt(0)) >= 0;\n    }\n  }, {\n    key: \"trimToBreakable\",\n    value: function trimToBreakable(prev) {\n      var next = _toConsumableArray(prev);\n      var prevLine = next[next.length - 2];\n      var index = this.findBreakableIndex(prevLine);\n      if (index === -1 || !prevLine) return next;\n      var trimmedChar = prevLine.slice(index, index + 1);\n      var isTrimmedWithSpace = this.isBreakingSpace(trimmedChar);\n      var trimFrom = index + 1;\n      var trimTo = index + (isTrimmedWithSpace ? 0 : 1);\n      next[next.length - 1] += prevLine.slice(trimFrom, prevLine.length);\n      next[next.length - 2] = prevLine.slice(0, trimTo);\n      return next;\n    }\n  }, {\n    key: \"canBreakInLastChar\",\n    value: function canBreakInLastChar(_char6) {\n      if (_char6 && LATIN_REGEX.test(_char6)) return false;\n      return true;\n    }\n  }, {\n    key: \"sumTextWidthByCache\",\n    value: function sumTextWidthByCache(text, cache) {\n      return text.split('').reduce(function (sum, c) {\n        if (!cache[c]) throw Error('cannot count the word without cache');\n        return sum + cache[c];\n      }, 0);\n    }\n  }, {\n    key: \"findBreakableIndex\",\n    value: function findBreakableIndex(line) {\n      for (var i = line.length - 1; i >= 0; i--) {\n        if (!LATIN_REGEX.test(line[i])) return i;\n      }\n      return -1;\n    }\n  }, {\n    key: \"getFromCache\",\n    value: function getFromCache(key, letterSpacing, cache, context) {\n      var width = cache[key];\n      if (typeof width !== 'number') {\n        var spacing = key.length * letterSpacing;\n        width = context.measureText(key).width + spacing;\n        cache[key] = width;\n      }\n      return width;\n    }\n  }]);\n}();\n\nvar runtime = {};\n/**\n * Replace with IoC container\n */\nvar geometryUpdaterFactory = function (_ref) {\n  var rectUpdater = new RectUpdater();\n  var polylineUpdater = new PolylineUpdater();\n  return _ref = {}, _defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_ref, Shape.CIRCLE, new CircleUpdater()), Shape.ELLIPSE, new EllipseUpdater()), Shape.RECT, rectUpdater), Shape.IMAGE, rectUpdater), Shape.GROUP, new GroupUpdater()), Shape.LINE, new LineUpdater()), Shape.TEXT, new TextUpdater(runtime)), Shape.POLYLINE, polylineUpdater), Shape.POLYGON, polylineUpdater), Shape.PATH, new PathUpdater()), _defineProperty(_defineProperty(_ref, Shape.HTML, new HTMLUpdater()), Shape.MESH, null);\n}();\nvar CSSPropertySyntaxFactory = function (_ref2) {\n  var color = new CSSPropertyColor();\n  var length = new CSSPropertyLengthOrPercentage();\n  return _ref2 = {}, _defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_ref2, PropertySyntax.PERCENTAGE, null), PropertySyntax.NUMBER, new CSSPropertyNumber()), PropertySyntax.ANGLE, new CSSPropertyAngle()), PropertySyntax.DEFINED_PATH, new CSSPropertyClipPath()), PropertySyntax.PAINT, color), PropertySyntax.COLOR, color), PropertySyntax.FILTER, new CSSPropertyFilter()), PropertySyntax.LENGTH, length), PropertySyntax.LENGTH_PERCENTAGE, length), PropertySyntax.LENGTH_PERCENTAGE_12, new CSSPropertyLengthOrPercentage12()), _defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_ref2, PropertySyntax.LENGTH_PERCENTAGE_14, new CSSPropertyLengthOrPercentage14()), PropertySyntax.COORDINATE, new CSSPropertyLengthOrPercentage()), PropertySyntax.OFFSET_DISTANCE, new CSSPropertyOffsetDistance()), PropertySyntax.OPACITY_VALUE, new CSSPropertyOpacity()), PropertySyntax.PATH, new CSSPropertyPath()), PropertySyntax.LIST_OF_POINTS, new CSSPropertyPoints()), PropertySyntax.SHADOW_BLUR, new CSSPropertyShadowBlur()), PropertySyntax.TEXT, new CSSPropertyText()), PropertySyntax.TEXT_TRANSFORM, new CSSPropertyTextTransform()), PropertySyntax.TRANSFORM, new CSSPropertyTransform()), _defineProperty(_defineProperty(_defineProperty(_ref2, PropertySyntax.TRANSFORM_ORIGIN, new CSSPropertyTransformOrigin()), PropertySyntax.Z_INDEX, new CSSPropertyZIndex()), PropertySyntax.MARKER, new CSSPropertyMarker());\n}();\nvar getGlobalThis = function getGlobalThis() {\n  if (typeof globalThis !== 'undefined') return globalThis;\n  if (typeof self !== 'undefined') return self;\n  if (typeof window !== 'undefined') return window;\n  // @ts-ignore\n  if (typeof global !== 'undefined') return global;\n  return {};\n  // [!] Error: The 'this' keyword is equivalent to 'undefined' at the top level of an ES module, and has been rewritten\n  // @see https://rollupjs.org/troubleshooting/#error-this-is-undefined\n  // if (typeof this !== 'undefined') return this;\n};\n\n/**\n * Camera\n * `g-camera-api` will provide an advanced implementation\n */\nruntime.CameraContribution = Camera;\n\n/**\n * `g-web-animations-api` will provide an AnimationTimeline\n */\nruntime.AnimationTimeline = null;\nruntime.EasingFunction = null;\nruntime.offscreenCanvasCreator = new OffscreenCanvasCreator();\nruntime.sceneGraphSelector = new DefaultSceneGraphSelector();\nruntime.sceneGraphService = new DefaultSceneGraphService(runtime);\nruntime.textService = new TextService(runtime);\nruntime.geometryUpdaterFactory = geometryUpdaterFactory;\nruntime.CSSPropertySyntaxFactory = CSSPropertySyntaxFactory;\nruntime.styleValueRegistry = new DefaultStyleValueRegistry(runtime);\nruntime.layoutRegistry = null;\nruntime.globalThis = getGlobalThis();\nruntime.enableStyleSyntax = true;\nruntime.enableSizeAttenuation = false;\n\nvar entityCounter = 0;\nfunction resetEntityCounter() {\n  entityCounter = 0;\n}\nvar insertedEvent = new MutationEvent(ElementEvent.INSERTED, null, '', '', '', 0, '', '');\nvar removedEvent = new MutationEvent(ElementEvent.REMOVED, null, '', '', '', 0, '', '');\nvar destroyEvent = new CustomEvent(ElementEvent.DESTROY);\n\n/**\n * Has following capabilities:\n * * Node insert/remove, eg. appendChild, removeChild, remove...\n * * Query eg. querySelector getElementById...\n * * Animation\n */\nvar Element = /*#__PURE__*/function (_Node) {\n  function Element() {\n    var _this;\n    _classCallCheck(this, Element);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, Element, [].concat(args));\n    /**\n     * Unique id.\n     */\n    _this.entity = entityCounter++;\n    _this.renderable = {\n      bounds: undefined,\n      boundsDirty: true,\n      renderBounds: undefined,\n      renderBoundsDirty: true,\n      dirtyRenderBounds: undefined,\n      dirty: false\n    };\n    _this.cullable = {\n      strategy: Strategy.Standard,\n      visibilityPlaneMask: -1,\n      visible: true,\n      enable: true\n    };\n    _this.transformable = {\n      dirtyFlag: false,\n      localDirtyFlag: false,\n      frozen: false,\n      localPosition: [0, 0, 0],\n      localRotation: [0, 0, 0, 1],\n      localScale: [1, 1, 1],\n      localTransform: [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\n      localSkew: [0, 0],\n      position: [0, 0, 0],\n      rotation: [0, 0, 0, 1],\n      scaling: [1, 1, 1],\n      worldTransform: [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\n      origin: [0, 0, 0]\n    };\n    _this.sortable = {\n      dirty: false,\n      sorted: undefined,\n      renderOrder: 0,\n      dirtyChildren: [],\n      dirtyReason: undefined\n    };\n    _this.geometry = {\n      contentBounds: undefined,\n      renderBounds: undefined,\n      dirty: true\n    };\n    _this.rBushNode = {\n      aabb: undefined\n    };\n    /**\n     * https://developer.mozilla.org/zh-CN/docs/Web/API/Element/namespaceURI\n     */\n    _this.namespaceURI = 'g';\n    _this.scrollLeft = 0;\n    _this.scrollTop = 0;\n    /**\n     * We don't support border now\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/clientTop\n     */\n    _this.clientTop = 0;\n    _this.clientLeft = 0;\n    /**\n     * is destroyed or not\n     */\n    _this.destroyed = false;\n    /**\n     * compatible with `style`\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/style\n     */\n    _this.style = {};\n    _this.computedStyle = {};\n    /**\n     * Renderers will use these used values.\n     */\n    _this.parsedStyle = {\n      // opacity: '',\n      // fillOpacity: '',\n      // strokeOpacity: '',\n      // transformOrigin: '',\n      // visibility: '',\n      // pointerEvents: '',\n      // lineWidth: '',\n      // lineCap: '',\n      // lineJoin: '',\n      // increasedLineWidthForHitTesting: '',\n      // fontSize: '',\n      // fontFamily: '',\n      // fontStyle: '',\n      // fontWeight: '',\n      // fontVariant: '',\n      // textAlign: '',\n      // textBaseline: '',\n      // textTransform: '',\n    };\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/attributes\n     */\n    _this.attributes = {};\n    return _this;\n  }\n  _inherits(Element, _Node);\n  return _createClass(Element, [{\n    key: \"className\",\n    get:\n    /**\n     * used with `getElementById()`\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/id\n     */\n\n    /**\n     * used in `getElementsByClassName`\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByClassName\n     */\n    function get() {\n      // @ts-ignore\n      return this.getAttribute('class') || '';\n    },\n    set: function set(className) {\n      this.setAttribute('class', className);\n    }\n\n    /**\n     * used in `getElementsByName`\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByName\n     */\n  }, {\n    key: \"classList\",\n    get:\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/classList\n     */\n    function get() {\n      return this.className.split(' ').filter(function (c) {\n        return c !== '';\n      });\n    }\n  }, {\n    key: \"tagName\",\n    get: function get() {\n      return this.nodeName;\n    }\n  }, {\n    key: \"children\",\n    get: function get() {\n      return this.childNodes;\n    }\n  }, {\n    key: \"childElementCount\",\n    get: function get() {\n      return this.childNodes.length;\n    }\n  }, {\n    key: \"firstElementChild\",\n    get: function get() {\n      return this.firstChild;\n    }\n  }, {\n    key: \"lastElementChild\",\n    get: function get() {\n      return this.lastChild;\n    }\n  }, {\n    key: \"parentElement\",\n    get: function get() {\n      return this.parentNode;\n    }\n  }, {\n    key: \"nextSibling\",\n    get: function get() {\n      if (this.parentNode) {\n        var index = this.parentNode.childNodes.indexOf(this);\n        return this.parentNode.childNodes[index + 1] || null;\n      }\n      return null;\n    }\n  }, {\n    key: \"previousSibling\",\n    get: function get() {\n      if (this.parentNode) {\n        var index = this.parentNode.childNodes.indexOf(this);\n        return this.parentNode.childNodes[index - 1] || null;\n      }\n      return null;\n    }\n  }, {\n    key: \"cloneNode\",\n    value: function cloneNode(deep) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"appendChild\",\n    value: function appendChild(child, index) {\n      var _this$ownerDocument;\n      if (child.destroyed) {\n        throw new Error(ERROR_MSG_APPEND_DESTROYED_ELEMENT);\n      }\n      runtime.sceneGraphService.attach(child, this, index);\n      if ((_this$ownerDocument = this.ownerDocument) !== null && _this$ownerDocument !== void 0 && _this$ownerDocument.defaultView) {\n        if (!isInFragment(this) && child.nodeName === Shape.FRAGMENT) {\n          this.ownerDocument.defaultView.mountFragment(child);\n        } else {\n          this.ownerDocument.defaultView.mountChildren(child);\n        }\n      }\n\n      // @ts-ignore\n      if (this.isMutationObserved) {\n        insertedEvent.relatedNode = this;\n        child.dispatchEvent(insertedEvent);\n      }\n      return child;\n    }\n  }, {\n    key: \"insertBefore\",\n    value: function insertBefore(newChild, refChild) {\n      if (!refChild) {\n        this.appendChild(newChild);\n      } else {\n        if (newChild.parentElement) {\n          newChild.parentElement.removeChild(newChild);\n        }\n        var index = this.childNodes.indexOf(refChild);\n        if (index === -1) {\n          this.appendChild(newChild);\n        } else {\n          this.appendChild(newChild, index);\n        }\n      }\n      return newChild;\n    }\n  }, {\n    key: \"replaceChild\",\n    value: function replaceChild(newChild, oldChild) {\n      var index = this.childNodes.indexOf(oldChild);\n      this.removeChild(oldChild);\n      this.appendChild(newChild, index);\n      return oldChild;\n    }\n  }, {\n    key: \"removeChild\",\n    value: function removeChild(child) {\n      var _child$ownerDocument;\n      // should emit on itself before detach\n      removedEvent.relatedNode = this;\n      child.dispatchEvent(removedEvent);\n      if ((_child$ownerDocument = child.ownerDocument) !== null && _child$ownerDocument !== void 0 && _child$ownerDocument.defaultView) {\n        child.ownerDocument.defaultView.unmountChildren(child);\n      }\n\n      // remove from scene graph\n      runtime.sceneGraphService.detach(child);\n      return child;\n    }\n\n    /**\n     * Remove all children which can be appended to its original parent later again.\n     */\n  }, {\n    key: \"removeChildren\",\n    value: function removeChildren() {\n      for (var i = this.childNodes.length - 1; i >= 0; i--) {\n        var child = this.childNodes[i];\n        this.removeChild(child);\n      }\n    }\n\n    /**\n     * Recursively destroy all children which can not be appended to its original parent later again.\n     */\n  }, {\n    key: \"destroyChildren\",\n    value: function destroyChildren() {\n      for (var i = this.childNodes.length - 1; i >= 0; i--) {\n        var child = this.childNodes[i];\n        if (child.childNodes.length) {\n          child.destroyChildren();\n        }\n        child.destroy();\n      }\n    }\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/matches\n     */\n  }, {\n    key: \"matches\",\n    value: function matches(selector) {\n      return runtime.sceneGraphService.matches(selector, this);\n    }\n  }, {\n    key: \"getElementById\",\n    value: function getElementById(id) {\n      return runtime.sceneGraphService.querySelector(\"#\".concat(id), this);\n    }\n  }, {\n    key: \"getElementsByName\",\n    value: function getElementsByName(name) {\n      return runtime.sceneGraphService.querySelectorAll(\"[name=\\\"\".concat(name, \"\\\"]\"), this);\n    }\n  }, {\n    key: \"getElementsByClassName\",\n    value: function getElementsByClassName(className) {\n      return runtime.sceneGraphService.querySelectorAll(\".\".concat(className), this);\n    }\n  }, {\n    key: \"getElementsByTagName\",\n    value: function getElementsByTagName(tagName) {\n      return runtime.sceneGraphService.querySelectorAll(tagName, this);\n    }\n  }, {\n    key: \"querySelector\",\n    value: function querySelector(selectors) {\n      return runtime.sceneGraphService.querySelector(selectors, this);\n    }\n  }, {\n    key: \"querySelectorAll\",\n    value: function querySelectorAll(selectors) {\n      return runtime.sceneGraphService.querySelectorAll(selectors, this);\n    }\n\n    /**\n     * should traverses the element and its parents (heading toward the document root)\n     * until it finds a node that matches the specified CSS selector.\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/closest\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/closest#polyfill\n     */\n  }, {\n    key: \"closest\",\n    value: function closest(selectors) {\n      var el = this;\n      do {\n        if (runtime.sceneGraphService.matches(selectors, el)) return el;\n        el = el.parentElement;\n      } while (el !== null);\n      return null;\n    }\n\n    /**\n     * search in scene group, but should not include itself\n     */\n  }, {\n    key: \"find\",\n    value: function find(filter) {\n      var _this2 = this;\n      var target = null;\n      this.forEach(function (object) {\n        if (object !== _this2 && filter(object)) {\n          target = object;\n          return false;\n        }\n        return true;\n      });\n      return target;\n    }\n  }, {\n    key: \"findAll\",\n    value: function findAll(filter) {\n      var _this3 = this;\n      var objects = [];\n      this.forEach(function (object) {\n        if (object !== _this3 && filter(object)) {\n          objects.push(object);\n        }\n      });\n      return objects;\n    }\n\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/after\n     */\n  }, {\n    key: \"after\",\n    value: function after() {\n      var _this4 = this;\n      if (this.parentNode) {\n        var index = this.parentNode.childNodes.indexOf(this);\n        for (var _len2 = arguments.length, nodes = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n          nodes[_key2] = arguments[_key2];\n        }\n        nodes.forEach(function (node, i) {\n          var _this4$parentNode;\n          return (_this4$parentNode = _this4.parentNode) === null || _this4$parentNode === void 0 ? void 0 : _this4$parentNode.appendChild(node, index + i + 1);\n        });\n      }\n    }\n\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/before\n     */\n  }, {\n    key: \"before\",\n    value: function before() {\n      if (this.parentNode) {\n        var _ref;\n        var index = this.parentNode.childNodes.indexOf(this);\n        for (var _len3 = arguments.length, nodes = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n          nodes[_key3] = arguments[_key3];\n        }\n        var first = nodes[0],\n          rest = nodes.slice(1);\n        this.parentNode.appendChild(first, index);\n        (_ref = first).after.apply(_ref, _toConsumableArray(rest));\n      }\n    }\n\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/replaceWith\n     */\n  }, {\n    key: \"replaceWith\",\n    value: function replaceWith() {\n      this.after.apply(this, arguments);\n      this.remove();\n    }\n\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/append\n     */\n  }, {\n    key: \"append\",\n    value: function append() {\n      var _this5 = this;\n      for (var _len4 = arguments.length, nodes = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        nodes[_key4] = arguments[_key4];\n      }\n      nodes.forEach(function (node) {\n        return _this5.appendChild(node);\n      });\n    }\n\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/prepend\n     */\n  }, {\n    key: \"prepend\",\n    value: function prepend() {\n      var _this6 = this;\n      for (var _len5 = arguments.length, nodes = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n        nodes[_key5] = arguments[_key5];\n      }\n      nodes.forEach(function (node, i) {\n        return _this6.appendChild(node, i);\n      });\n    }\n\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/replaceChildren\n     */\n  }, {\n    key: \"replaceChildren\",\n    value: function replaceChildren() {\n      while (this.childNodes.length && this.firstChild) {\n        this.removeChild(this.firstChild);\n      }\n      this.append.apply(this, arguments);\n    }\n\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/remove\n     */\n  }, {\n    key: \"remove\",\n    value: function remove() {\n      if (this.parentNode) {\n        return this.parentNode.removeChild(this);\n      }\n      return this;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      // destroy itself before remove\n      this.dispatchEvent(destroyEvent);\n\n      // remove from scenegraph first\n      this.remove();\n\n      // remove event listeners\n      this.emitter.removeAllListeners();\n      this.destroyed = true;\n    }\n  }, {\n    key: \"getGeometryBounds\",\n    value: function getGeometryBounds() {\n      return runtime.sceneGraphService.getGeometryBounds(this);\n    }\n  }, {\n    key: \"getRenderBounds\",\n    value: function getRenderBounds() {\n      return runtime.sceneGraphService.getBounds(this, true);\n    }\n\n    /**\n     * get bounds in world space, account for children\n     */\n  }, {\n    key: \"getBounds\",\n    value: function getBounds() {\n      return runtime.sceneGraphService.getBounds(this);\n    }\n\n    /**\n     * get bounds in local space, account for children\n     */\n  }, {\n    key: \"getLocalBounds\",\n    value: function getLocalBounds() {\n      return runtime.sceneGraphService.getLocalBounds(this);\n    }\n\n    /**\n     * account for context's bounds in client space,\n     * but not accounting for children\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect\n     */\n  }, {\n    key: \"getBoundingClientRect\",\n    value: function getBoundingClientRect() {\n      return runtime.sceneGraphService.getBoundingClientRect(this);\n    }\n\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getClientRects\n     */\n  }, {\n    key: \"getClientRects\",\n    value: function getClientRects() {\n      return [this.getBoundingClientRect()];\n    }\n  }, {\n    key: \"computedStyleMap\",\n    value:\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/computedStyleMap\n     * eg. circle.computedStyleMap().get('fill');\n     */\n    function computedStyleMap() {\n      return new Map(Object.entries(this.computedStyle));\n    }\n  }, {\n    key: \"getAttributeNames\",\n    value:\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/getAttributeNames\n     */\n    function getAttributeNames() {\n      return Object.keys(this.attributes);\n    }\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/getAttribute\n     */\n  }, {\n    key: \"getAttribute\",\n    value: function getAttribute(name) {\n      // @see https://github.com/antvis/G/issues/1267\n      if (typeof name === 'symbol') {\n        return undefined;\n      }\n      var value = this.attributes[name];\n      if (value === undefined) {\n        // if the given attribute does not exist, the value returned will either be null or \"\"\n        return value;\n      }\n      return value;\n    }\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/hasAttribute\n     */\n  }, {\n    key: \"hasAttribute\",\n    value: function hasAttribute(qualifiedName) {\n      return this.getAttributeNames().includes(qualifiedName);\n    }\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/hasAttributes\n     */\n  }, {\n    key: \"hasAttributes\",\n    value: function hasAttributes() {\n      return !!this.getAttributeNames().length;\n    }\n\n    /**\n     * should use removeAttribute() instead of setting the attribute value to null either directly or using setAttribute(). Many attributes will not behave as expected if you set them to null.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/removeAttribute\n     */\n  }, {\n    key: \"removeAttribute\",\n    value: function removeAttribute(attributeName) {\n      this.setAttribute(attributeName, null);\n      delete this.attributes[attributeName];\n    }\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttribute\n     */\n  }, {\n    key: \"setAttribute\",\n    value: function setAttribute(attributeName, value, force, memoize) {\n      this.attributes[attributeName] = value;\n    }\n  }, {\n    key: \"getAttributeNS\",\n    value: function getAttributeNS(namespace, localName) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"getAttributeNode\",\n    value: function getAttributeNode(qualifiedName) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"getAttributeNodeNS\",\n    value: function getAttributeNodeNS(namespace, localName) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"hasAttributeNS\",\n    value: function hasAttributeNS(namespace, localName) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"removeAttributeNS\",\n    value: function removeAttributeNS(namespace, localName) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"removeAttributeNode\",\n    value: function removeAttributeNode(attr) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"setAttributeNS\",\n    value: function setAttributeNS(namespace, qualifiedName, value) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"setAttributeNode\",\n    value: function setAttributeNode(attr) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"setAttributeNodeNS\",\n    value: function setAttributeNodeNS(attr) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"toggleAttribute\",\n    value: function toggleAttribute(qualifiedName, force) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }]);\n}(Node);\n\nfunction isDisplayObject(value) {\n  return !!(value !== null && value !== void 0 && value.nodeName);\n}\nvar Proxy = runtime.globalThis.Proxy ? runtime.globalThis.Proxy : function () {};\nvar mutationEvent = new MutationEvent(ElementEvent.ATTR_MODIFIED, null, null, null, null, MutationEvent.MODIFICATION, null, null);\nvar $vec3 = vec3.create();\nvar $quat = quat$1.create();\n\n/**\n * prototype chains: DisplayObject -> Element -> Node -> EventTarget\n *\n * mixins: Animatable, Transformable, Visible\n * @see https://github.com/tannerntannern/ts-mixer/blob/master/README.md#mixing-generic-classes\n *\n * Provide abilities in scene graph, such as:\n * * transform `translate/rotate/scale`\n * * add/remove child\n * * visibility and z-index\n *\n * Those abilities are implemented with those components: `Transform/Sortable/Visible`.\n *\n * Emit following events:\n * * init\n * * destroy\n * * attributeChanged\n */\nvar DisplayObject = /*#__PURE__*/function (_Element) {\n  function DisplayObject(config) {\n    var _this;\n    _classCallCheck(this, DisplayObject);\n    _this = _callSuper(this, DisplayObject);\n\n    // assign name, id to config\n    // eg. group.get('name')\n    /**\n     * contains style props in constructor's params, eg. fill, stroke...\n     */\n    _this.isCustomElement = false;\n    _this.isMutationObserved = false;\n    /**\n     * push to active animations after calling `animate()`\n     */\n    _this.activeAnimations = [];\n    _this.config = config;\n\n    // init scene graph node\n    _this.id = config.id || '';\n    _this.name = config.name || '';\n    if (config.className || config[\"class\"]) {\n      _this.className = config.className || config[\"class\"];\n    }\n    _this.nodeName = config.type || Shape.GROUP;\n    if (config.initialParsedStyle) {\n      Object.assign(_this.parsedStyle, config.initialParsedStyle);\n    }\n\n    // start to process attributes\n    _this.initAttributes(config.style);\n    if (runtime.enableStyleSyntax) {\n      _this.style = new Proxy(\n      // @ts-ignore\n      {\n        // ...this.attributes,\n        setProperty: function setProperty(propertyName, value\n        // priority?: string,\n        ) {\n          _this.setAttribute(propertyName, value);\n        },\n        getPropertyValue: function getPropertyValue(propertyName) {\n          return _this.getAttribute(propertyName);\n        },\n        removeProperty: function removeProperty(propertyName) {\n          _this.removeAttribute(propertyName);\n        },\n        item: function item() {\n          return '';\n        }\n      }, {\n        get: function get(target, name) {\n          if (target[name] !== undefined) {\n            // if (name in target) {\n            return target[name];\n          }\n          return _this.getAttribute(name);\n        },\n        set: function set(_, prop, value) {\n          _this.setAttribute(prop, value);\n          return true;\n        }\n      });\n    }\n    return _this;\n  }\n  _inherits(DisplayObject, _Element);\n  return _createClass(DisplayObject, [{\n    key: \"destroy\",\n    value: function destroy() {\n      _superPropGet(DisplayObject, \"destroy\", this, 3)([]);\n\n      // stop all active animations\n      this.getAnimations().forEach(function (animation) {\n        animation.cancel();\n      });\n    }\n  }, {\n    key: \"cloneNode\",\n    value: function cloneNode(deep, customCloneFunc) {\n      var clonedStyle = _objectSpread({}, this.attributes);\n      for (var attributeName in clonedStyle) {\n        var attribute = clonedStyle[attributeName];\n\n        // @see https://github.com/antvis/G/issues/1095\n        if (isDisplayObject(attribute) &&\n        // share the same clipPath if possible\n        attributeName !== 'clipPath' && attributeName !== 'offsetPath' && attributeName !== 'textPath') {\n          clonedStyle[attributeName] = attribute.cloneNode(deep);\n        }\n        // TODO: clone other type\n        if (customCloneFunc) {\n          clonedStyle[attributeName] = customCloneFunc(attributeName, attribute);\n        }\n      }\n      var cloned = new this.constructor({\n        // copy id & name\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/Node/cloneNode#notes\n        id: this.id,\n        name: this.name,\n        className: this.name,\n        interactive: this.interactive,\n        style: clonedStyle\n      });\n\n      // apply transform\n      cloned.setLocalTransform(this.getLocalTransform());\n      if (deep) {\n        this.children.forEach(function (child) {\n          // skip marker\n          if (!child.style.isMarker) {\n            var clonedChild = child.cloneNode(deep);\n            cloned.appendChild(clonedChild);\n          }\n        });\n      }\n      return cloned;\n    }\n  }, {\n    key: \"initAttributes\",\n    value: function initAttributes() {\n      var attributes = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var options = {\n        forceUpdateGeometry: true\n      };\n      runtime.styleValueRegistry.processProperties(this, attributes, options);\n\n      // redraw at next frame\n      this.renderable.dirty = true;\n    }\n  }, {\n    key: \"setAttribute\",\n    value: function setAttribute(name, value) {\n      var force = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var memoize = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n      // ignore undefined value\n      if (isUndefined(value)) {\n        return;\n      }\n      if (force || value !== this.attributes[name]) {\n        this.internalSetAttribute(name, value, {\n          memoize: memoize\n        });\n        _superPropGet(DisplayObject, \"setAttribute\", this, 3)([name, value]);\n      }\n    }\n\n    /**\n     * called when attributes get changed or initialized\n     */\n  }, {\n    key: \"internalSetAttribute\",\n    value: function internalSetAttribute(name, value) {\n      var parseOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var renderable = this.renderable;\n      var oldValue = this.attributes[name];\n      var oldParsedValue = this.parsedStyle[name];\n      runtime.styleValueRegistry.processProperties(this, _defineProperty({}, name, value), parseOptions);\n\n      // redraw at next frame\n      renderable.dirty = true;\n      var newParsedValue = this.parsedStyle[name];\n      if (this.isConnected) {\n        mutationEvent.relatedNode = this;\n        mutationEvent.prevValue = oldValue;\n        mutationEvent.newValue = value;\n        mutationEvent.attrName = name;\n        mutationEvent.prevParsedValue = oldParsedValue;\n        mutationEvent.newParsedValue = newParsedValue;\n        if (this.isMutationObserved) {\n          this.dispatchEvent(mutationEvent);\n        } else {\n          mutationEvent.target = this;\n          this.ownerDocument.defaultView.dispatchEvent(mutationEvent, true);\n        }\n      }\n      if ((this.isCustomElement && this.isConnected || !this.isCustomElement) && this.attributeChangedCallback) {\n        this.attributeChangedCallback(name, oldValue, value, oldParsedValue, newParsedValue);\n      }\n    }\n\n    // #region transformable\n    /**\n     * returns different values than getBoundingClientRect(), as the latter returns value relative to the viewport\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/SVGGraphicsElement/getBBox\n     *\n     * FIXME: It is worth noting that getBBox responds to original untransformed values of a drawn object.\n     * @see https://www.w3.org/Graphics/SVG/IG/resources/svgprimer.html#getBBox\n     */\n  }, {\n    key: \"getBBox\",\n    value: function getBBox() {\n      var aabb = this.getBounds();\n      var _aabb$getMin = aabb.getMin(),\n        _aabb$getMin2 = _slicedToArray(_aabb$getMin, 2),\n        left = _aabb$getMin2[0],\n        top = _aabb$getMin2[1];\n      var _aabb$getMax = aabb.getMax(),\n        _aabb$getMax2 = _slicedToArray(_aabb$getMax, 2),\n        right = _aabb$getMax2[0],\n        bottom = _aabb$getMax2[1];\n      return new Rectangle(left, top, right - left, bottom - top);\n    }\n  }, {\n    key: \"setOrigin\",\n    value: function setOrigin(position) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      runtime.sceneGraphService.setOrigin(this, createVec3(position, y, z, false));\n      return this;\n    }\n  }, {\n    key: \"getOrigin\",\n    value: function getOrigin() {\n      return runtime.sceneGraphService.getOrigin(this);\n    }\n\n    /**\n     * set position in world space\n     */\n  }, {\n    key: \"setPosition\",\n    value: function setPosition(position) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      runtime.sceneGraphService.setPosition(this, createVec3(position, y, z, false));\n      return this;\n    }\n\n    /**\n     * set position in local space\n     */\n  }, {\n    key: \"setLocalPosition\",\n    value: function setLocalPosition(position) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      runtime.sceneGraphService.setLocalPosition(this, createVec3(position, y, z, false));\n      return this;\n    }\n\n    /**\n     * translate in world space\n     */\n  }, {\n    key: \"translate\",\n    value: function translate(position) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      runtime.sceneGraphService.translate(this, createVec3(position, y, z, false));\n      return this;\n    }\n\n    /**\n     * translate in local space\n     */\n  }, {\n    key: \"translateLocal\",\n    value: function translateLocal(position) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      runtime.sceneGraphService.translateLocal(this, createVec3(position, y, z, false));\n      return this;\n    }\n  }, {\n    key: \"getPosition\",\n    value: function getPosition() {\n      return runtime.sceneGraphService.getPosition(this);\n    }\n  }, {\n    key: \"getLocalPosition\",\n    value: function getLocalPosition() {\n      return runtime.sceneGraphService.getLocalPosition(this);\n    }\n\n    /**\n     * compatible with G 3.0\n     *\n     * scaling in local space\n     * scale(10) = scale(10, 10, 10)\n     *\n     * we can't set scale in world space\n     */\n  }, {\n    key: \"scale\",\n    value: function scale(scaling, y, z) {\n      return this.scaleLocal(scaling, y, z);\n    }\n  }, {\n    key: \"scaleLocal\",\n    value: function scaleLocal(scaling, y, z) {\n      if (typeof scaling === 'number') {\n        y = y || scaling;\n        z = z || scaling;\n        scaling = createVec3(scaling, y, z, false);\n      }\n      runtime.sceneGraphService.scaleLocal(this, scaling);\n      return this;\n    }\n\n    /**\n     * set scaling in local space\n     */\n  }, {\n    key: \"setLocalScale\",\n    value: function setLocalScale(scaling, y, z) {\n      if (typeof scaling === 'number') {\n        y = y || scaling;\n        z = z || scaling;\n        scaling = createVec3(scaling, y, z, false);\n      }\n      runtime.sceneGraphService.setLocalScale(this, scaling);\n      return this;\n    }\n\n    /**\n     * get scaling in local space\n     */\n  }, {\n    key: \"getLocalScale\",\n    value: function getLocalScale() {\n      return runtime.sceneGraphService.getLocalScale(this);\n    }\n\n    /**\n     * get scaling in world space\n     */\n  }, {\n    key: \"getScale\",\n    value: function getScale() {\n      return runtime.sceneGraphService.getScale(this);\n    }\n\n    /**\n     * only return degrees of Z axis in world space\n     */\n  }, {\n    key: \"getEulerAngles\",\n    value: function getEulerAngles() {\n      var _getEuler = getEuler($vec3, runtime.sceneGraphService.getWorldTransform(this)),\n        _getEuler2 = _slicedToArray(_getEuler, 3),\n        ez = _getEuler2[2];\n      return rad2deg(ez);\n    }\n\n    /**\n     * only return degrees of Z axis in local space\n     */\n  }, {\n    key: \"getLocalEulerAngles\",\n    value: function getLocalEulerAngles() {\n      var _getEuler3 = getEuler($vec3, runtime.sceneGraphService.getLocalRotation(this)),\n        _getEuler4 = _slicedToArray(_getEuler3, 3),\n        ez = _getEuler4[2];\n      return rad2deg(ez);\n    }\n\n    /**\n     * set euler angles(degrees) in world space\n     */\n  }, {\n    key: \"setEulerAngles\",\n    value: function setEulerAngles(z) {\n      runtime.sceneGraphService.setEulerAngles(this, 0, 0, z);\n      return this;\n    }\n\n    /**\n     * set euler angles(degrees) in local space\n     */\n  }, {\n    key: \"setLocalEulerAngles\",\n    value: function setLocalEulerAngles(z) {\n      runtime.sceneGraphService.setLocalEulerAngles(this, 0, 0, z);\n      return this;\n    }\n  }, {\n    key: \"rotateLocal\",\n    value: function rotateLocal(x, y, z) {\n      if (isNil(y) && isNil(z)) {\n        runtime.sceneGraphService.rotateLocal(this, 0, 0, x);\n      } else {\n        runtime.sceneGraphService.rotateLocal(this, x, y, z);\n      }\n      return this;\n    }\n  }, {\n    key: \"rotate\",\n    value: function rotate(x, y, z) {\n      if (isNil(y) && isNil(z)) {\n        runtime.sceneGraphService.rotate(this, 0, 0, x);\n      } else {\n        runtime.sceneGraphService.rotate(this, x, y, z);\n      }\n      return this;\n    }\n  }, {\n    key: \"setRotation\",\n    value: function setRotation(rotation, y, z, w) {\n      runtime.sceneGraphService.setRotation(this, rotation, y, z, w);\n      return this;\n    }\n  }, {\n    key: \"setLocalRotation\",\n    value: function setLocalRotation(rotation, y, z, w) {\n      runtime.sceneGraphService.setLocalRotation(this, rotation, y, z, w);\n      return this;\n    }\n  }, {\n    key: \"setLocalSkew\",\n    value: function setLocalSkew(skew, y) {\n      runtime.sceneGraphService.setLocalSkew(this, skew, y);\n      return this;\n    }\n  }, {\n    key: \"getRotation\",\n    value: function getRotation() {\n      return runtime.sceneGraphService.getRotation(this);\n    }\n  }, {\n    key: \"getLocalRotation\",\n    value: function getLocalRotation() {\n      return runtime.sceneGraphService.getLocalRotation(this);\n    }\n  }, {\n    key: \"getLocalSkew\",\n    value: function getLocalSkew() {\n      return runtime.sceneGraphService.getLocalSkew(this);\n    }\n  }, {\n    key: \"getLocalTransform\",\n    value: function getLocalTransform() {\n      return runtime.sceneGraphService.getLocalTransform(this);\n    }\n  }, {\n    key: \"getWorldTransform\",\n    value: function getWorldTransform() {\n      return runtime.sceneGraphService.getWorldTransform(this);\n    }\n  }, {\n    key: \"setLocalTransform\",\n    value: function setLocalTransform(transform) {\n      runtime.sceneGraphService.setLocalTransform(this, transform);\n      return this;\n    }\n  }, {\n    key: \"resetLocalTransform\",\n    value: function resetLocalTransform() {\n      runtime.sceneGraphService.resetLocalTransform(this);\n    }\n    // #endregion transformable\n\n    // #region animatable\n    /**\n     * returns an array of all Animation objects affecting this element\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/getAnimations\n     */\n  }, {\n    key: \"getAnimations\",\n    value: function getAnimations() {\n      return this.activeAnimations;\n    }\n    /**\n     * create an animation with WAAPI\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/animate\n     */\n  }, {\n    key: \"animate\",\n    value: function animate(keyframes, options) {\n      var _this$ownerDocument;\n      var timeline = (_this$ownerDocument = this.ownerDocument) === null || _this$ownerDocument === void 0 ? void 0 : _this$ownerDocument.timeline;\n      if (timeline) {\n        return timeline.play(this, keyframes, options);\n      }\n      return null;\n    }\n    // #endregion animatable\n\n    // #region visible\n    /**\n     * shortcut for Used value of `visibility`\n     */\n  }, {\n    key: \"isVisible\",\n    value: function isVisible() {\n      var _this$parsedStyle;\n      return ((_this$parsedStyle = this.parsedStyle) === null || _this$parsedStyle === void 0 ? void 0 : _this$parsedStyle.visibility) !== 'hidden';\n    }\n  }, {\n    key: \"interactive\",\n    get: function get() {\n      return this.isInteractive();\n    },\n    set: function set(b) {\n      this.style.pointerEvents = b ? 'auto' : 'none';\n    }\n  }, {\n    key: \"isInteractive\",\n    value: function isInteractive() {\n      var _this$parsedStyle2;\n      return ((_this$parsedStyle2 = this.parsedStyle) === null || _this$parsedStyle2 === void 0 ? void 0 : _this$parsedStyle2.pointerEvents) !== 'none';\n    }\n  }, {\n    key: \"isCulled\",\n    value: function isCulled() {\n      return !!(this.cullable && this.cullable.enable && !this.cullable.visible);\n    }\n\n    /**\n     * bring to front in current group\n     */\n  }, {\n    key: \"toFront\",\n    value: function toFront() {\n      if (this.parentNode) {\n        this.style.zIndex = Math.max.apply(Math, _toConsumableArray(this.parentNode.children.map(function (child) {\n          return Number(child.style.zIndex);\n        }))) + 1;\n      }\n      return this;\n    }\n\n    /**\n     * send to back in current group\n     */\n  }, {\n    key: \"toBack\",\n    value: function toBack() {\n      if (this.parentNode) {\n        this.style.zIndex = Math.min.apply(Math, _toConsumableArray(this.parentNode.children.map(function (child) {\n          return Number(child.style.zIndex);\n        }))) - 1;\n      }\n      return this;\n    }\n    // #endregion visible\n\n    // #region deprecated\n\n    /**\n     * compatible with G 3.0\n     * @alias object.config\n     * @deprecated\n     */\n  }, {\n    key: \"getConfig\",\n    value: function getConfig() {\n      return this.config;\n    }\n\n    /**\n     * @alias style\n     * @example\n     * circle.style.r = 10;\n     * const r = circle.style;\n     * @deprecated\n     */\n  }, {\n    key: \"attr\",\n    value: function attr() {\n      var _this2 = this;\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      var name = args[0],\n        value = args[1];\n      if (!name) {\n        return this.attributes;\n      }\n      if (isObject(name)) {\n        Object.keys(name).forEach(function (key) {\n          _this2.setAttribute(key, name[key]);\n        });\n        return this;\n      }\n      if (args.length === 2) {\n        this.setAttribute(name, value);\n        return this;\n      }\n      return this.attributes[name];\n    }\n\n    /**\n     * return 3x3 matrix in world space\n     * @deprecated\n     */\n  }, {\n    key: \"getMatrix\",\n    value: function getMatrix(transformMat4) {\n      var transform = transformMat4 || this.getWorldTransform();\n      var _mat4$getTranslation = mat4.getTranslation($vec3, transform),\n        _mat4$getTranslation2 = _slicedToArray(_mat4$getTranslation, 2),\n        tx = _mat4$getTranslation2[0],\n        ty = _mat4$getTranslation2[1];\n      var _mat4$getScaling = mat4.getScaling($vec3, transform),\n        _mat4$getScaling2 = _slicedToArray(_mat4$getScaling, 2),\n        sx = _mat4$getScaling2[0],\n        sy = _mat4$getScaling2[1];\n      var rotation = mat4.getRotation($quat, transform);\n      var _getEuler5 = getEuler($vec3, rotation),\n        _getEuler6 = _slicedToArray(_getEuler5, 3),\n        eux = _getEuler6[0],\n        euz = _getEuler6[2];\n      // gimbal lock at 90 degrees\n      return fromRotationTranslationScale(eux || euz, tx, ty, sx, sy);\n    }\n\n    /**\n     * return 3x3 matrix in local space\n     * @deprecated\n     */\n  }, {\n    key: \"getLocalMatrix\",\n    value: function getLocalMatrix() {\n      return this.getMatrix(this.getLocalTransform());\n    }\n\n    /**\n     * set 3x3 matrix in world space\n     * @deprecated\n     */\n  }, {\n    key: \"setMatrix\",\n    value: function setMatrix(mat) {\n      var _decompose = decompose(mat),\n        _decompose2 = _slicedToArray(_decompose, 5),\n        tx = _decompose2[0],\n        ty = _decompose2[1],\n        scalingX = _decompose2[2],\n        scalingY = _decompose2[3],\n        angle = _decompose2[4];\n      this.setEulerAngles(angle).setPosition(tx, ty).setLocalScale(scalingX, scalingY);\n    }\n\n    /**\n     * set 3x3 matrix in local space\n     * @deprecated\n     */\n  }, {\n    key: \"setLocalMatrix\",\n    value: function setLocalMatrix(mat) {\n      var _decompose3 = decompose(mat),\n        _decompose4 = _slicedToArray(_decompose3, 5),\n        tx = _decompose4[0],\n        ty = _decompose4[1],\n        scalingX = _decompose4[2],\n        scalingY = _decompose4[3],\n        angle = _decompose4[4];\n      this.setLocalEulerAngles(angle).setLocalPosition(tx, ty).setLocalScale(scalingX, scalingY);\n    }\n\n    /**\n     * Use `visibility: visible` instead.\n     * @deprecated\n     */\n  }, {\n    key: \"show\",\n    value: function show() {\n      this.forEach(function (object) {\n        object.style.visibility = 'visible';\n      });\n    }\n\n    /**\n     * Use `visibility: hidden` instead.\n     * @deprecated\n     */\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      this.forEach(function (object) {\n        object.style.visibility = 'hidden';\n      });\n    }\n\n    /**\n     * Use `childElementCount` instead.\n     * @deprecated\n     */\n  }, {\n    key: \"getCount\",\n    value: function getCount() {\n      return this.childElementCount;\n    }\n\n    /**\n     * Use `parentElement` instead.\n     * @deprecated\n     */\n  }, {\n    key: \"getParent\",\n    value: function getParent() {\n      return this.parentElement;\n    }\n\n    /**\n     * Use `children` instead.\n     * @deprecated\n     */\n  }, {\n    key: \"getChildren\",\n    value: function getChildren() {\n      return this.children;\n    }\n\n    /**\n     * Use `firstElementChild` instead.\n     * @deprecated\n     */\n  }, {\n    key: \"getFirst\",\n    value: function getFirst() {\n      return this.firstElementChild;\n    }\n\n    /**\n     * Use `lastElementChild` instead.\n     * @deprecated\n     */\n  }, {\n    key: \"getLast\",\n    value: function getLast() {\n      return this.lastElementChild;\n    }\n\n    /**\n     * Use `this.children[index]` instead.\n     * @deprecated\n     */\n  }, {\n    key: \"getChildByIndex\",\n    value: function getChildByIndex(index) {\n      return this.children[index] || null;\n    }\n\n    /**\n     * Use `appendChild` instead.\n     * @deprecated\n     */\n  }, {\n    key: \"add\",\n    value: function add(child, index) {\n      return this.appendChild(child, index);\n    }\n\n    /**\n     * @deprecated\n     */\n  }, {\n    key: \"set\",\n    value: function set(name, value) {\n      // @ts-ignore\n      this.config[name] = value;\n    }\n\n    /**\n     * @deprecated\n     */\n  }, {\n    key: \"get\",\n    value: function get(name) {\n      return this.config[name];\n    }\n\n    /**\n     * Use `setPosition` instead.\n     * @deprecated\n     */\n  }, {\n    key: \"moveTo\",\n    value: function moveTo(position) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      this.setPosition(position, y, z);\n      return this;\n    }\n\n    /**\n     * Use `setPosition` instead.\n     * @deprecated\n     */\n  }, {\n    key: \"move\",\n    value: function move(position) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      this.setPosition(position, y, z);\n      return this;\n    }\n\n    /**\n     * Use `this.style.zIndex` instead.\n     * @deprecated\n     */\n  }, {\n    key: \"setZIndex\",\n    value: function setZIndex(zIndex) {\n      this.style.zIndex = zIndex;\n      return this;\n    }\n\n    // #endregion deprecated\n  }]);\n}(Element);\n\nvar Circle = /*#__PURE__*/function (_DisplayObject) {\n  function Circle() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _classCallCheck(this, Circle);\n    return _callSuper(this, Circle, [_objectSpread({\n      type: Shape.CIRCLE\n    }, options)]);\n  }\n  _inherits(Circle, _DisplayObject);\n  return _createClass(Circle);\n}(DisplayObject);\n\nvar _excluded$6 = [\"style\"];\n/**\n * shadow root\n * @see https://yuque.antfin-inc.com/antv/czqvg5/pgqipg\n */\nvar CustomElement = /*#__PURE__*/function (_DisplayObject) {\n  // private shadowNodes: DisplayObject[] = [];\n\n  function CustomElement() {\n    var _this;\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      style = _ref.style,\n      rest = _objectWithoutProperties(_ref, _excluded$6);\n    _classCallCheck(this, CustomElement);\n    _this = _callSuper(this, CustomElement, [_objectSpread({\n      style: style\n    }, rest)]);\n    // static get observedAttributes(): string[] {\n    //   return [];\n    // }\n    _this.isCustomElement = true;\n    return _this;\n  }\n\n  /**\n   * fired after element insert into DOM tree\n   */\n  _inherits(CustomElement, _DisplayObject);\n  return _createClass(CustomElement);\n}(DisplayObject);\n\nvar Ellipse = /*#__PURE__*/function (_DisplayObject) {\n  function Ellipse() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _classCallCheck(this, Ellipse);\n    return _callSuper(this, Ellipse, [_objectSpread({\n      type: Shape.ELLIPSE\n    }, options)]);\n  }\n  _inherits(Ellipse, _DisplayObject);\n  return _createClass(Ellipse);\n}(DisplayObject);\n\n/**\n * 节点片段，用于包裹多个节点并批量操作\n *\n *  向 Fragment 或者根节点为 Fragment 的节点添加子节点时，不会触发渲染和事件。\n *\n * 当 Fragment 被挂载到 Canvas 中的节点时，其子节点会一次性被渲染，并触发合并事件。\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/DocumentFragment\n */\nvar Fragment = /*#__PURE__*/function (_DisplayObject) {\n  function Fragment() {\n    _classCallCheck(this, Fragment);\n    return _callSuper(this, Fragment, [{\n      type: Shape.FRAGMENT\n    }]);\n  }\n  _inherits(Fragment, _DisplayObject);\n  return _createClass(Fragment);\n}(DisplayObject);\n\n/**\n * its attributes are inherited by its children.\n * @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/g\n * \n * @example\n * <g fill=\"white\" stroke=\"green\" stroke-width=\"5\">\n    <circle cx=\"40\" cy=\"40\" r=\"25\" />\n    <circle cx=\"60\" cy=\"60\" r=\"25\" />\n  </g>\n */\nvar Group = /*#__PURE__*/function (_DisplayObject) {\n  function Group() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _classCallCheck(this, Group);\n    return _callSuper(this, Group, [_objectSpread({\n      type: Shape.GROUP\n    }, options)]);\n  }\n  _inherits(Group, _DisplayObject);\n  return _createClass(Group);\n}(DisplayObject);\n\nvar _excluded$5 = [\"style\"];\n/**\n * HTML container\n * @see https://github.com/pmndrs/drei#html\n */\nvar HTML = /*#__PURE__*/function (_DisplayObject) {\n  function HTML() {\n    var _this;\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      style = _ref.style,\n      rest = _objectWithoutProperties(_ref, _excluded$5);\n    _classCallCheck(this, HTML);\n    _this = _callSuper(this, HTML, [_objectSpread({\n      type: Shape.HTML,\n      style: style\n    }, rest)]);\n    _this.cullable.enable = false;\n    return _this;\n  }\n\n  /**\n   * return wrapper HTMLElement\n   * * <div> in g-webgl/canvas\n   * * <foreignObject> in g-svg\n   */\n  _inherits(HTML, _DisplayObject);\n  return _createClass(HTML, [{\n    key: \"getDomElement\",\n    value: function getDomElement() {\n      return this.parsedStyle.$el;\n    }\n\n    /**\n     * override with $el.getBoundingClientRect\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect\n     *\n     * ! The calculation logic of the html element should be consistent with that of the canvas element\n     */\n    // getBoundingClientRect(): Rectangle {\n    //   if (this.parsedStyle.$el) {\n    //     return this.parsedStyle.$el.getBoundingClientRect();\n    //   } else {\n    //     const { x, y, width, height } = this.parsedStyle;\n    //     return new Rectangle(x, y, width, height);\n    //   }\n    // }\n  }, {\n    key: \"getClientRects\",\n    value: function getClientRects() {\n      return [this.getBoundingClientRect()];\n    }\n\n    // getBounds() {\n    //   const clientRect = this.getBoundingClientRect();\n    //   // calc context's offset\n    //   // @ts-ignore\n    //   const canvasRect = this.ownerDocument?.defaultView\n    //     ?.getContextService()\n    //     .getBoundingClientRect();\n\n    //   const aabb = new AABB();\n    //   const minX = clientRect.left - (canvasRect?.left || 0);\n    //   const minY = clientRect.top - (canvasRect?.top || 0);\n    //   aabb.setMinMax(\n    //     [minX, minY, 0],\n    //     [minX + clientRect.width, minY + clientRect.height, 0],\n    //   );\n    //   return aabb;\n    // }\n  }, {\n    key: \"getLocalBounds\",\n    value: function getLocalBounds() {\n      if (this.parentNode) {\n        var parentInvert = mat4.invert(mat4.create(), this.parentNode.getWorldTransform());\n        var bounds = this.getBounds();\n        if (!AABB.isEmpty(bounds)) {\n          var localBounds = new AABB();\n          localBounds.setFromTransformedAABB(bounds, parentInvert);\n          return localBounds;\n        }\n      }\n      return this.getBounds();\n    }\n  }]);\n}(DisplayObject);\n\nvar Image = /*#__PURE__*/function (_DisplayObject) {\n  function Image() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _classCallCheck(this, Image);\n    return _callSuper(this, Image, [_objectSpread({\n      type: Shape.IMAGE\n    }, options)]);\n  }\n  _inherits(Image, _DisplayObject);\n  return _createClass(Image);\n}(DisplayObject);\n\nvar _excluded$4 = [\"style\"];\n/**\n * Create a line connecting two points.\n * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Element/line\n *\n * Also support for using marker.\n */\nvar Line = /*#__PURE__*/function (_DisplayObject) {\n  function Line() {\n    var _this;\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      style = _ref.style,\n      rest = _objectWithoutProperties(_ref, _excluded$4);\n    _classCallCheck(this, Line);\n    _this = _callSuper(this, Line, [_objectSpread({\n      type: Shape.LINE,\n      style: _objectSpread({\n        x1: 0,\n        y1: 0,\n        x2: 0,\n        y2: 0,\n        z1: 0,\n        z2: 0\n      }, style)\n    }, rest)]);\n    _this.markerStartAngle = 0;\n    _this.markerEndAngle = 0;\n    var _this$parsedStyle = _this.parsedStyle,\n      markerStart = _this$parsedStyle.markerStart,\n      markerEnd = _this$parsedStyle.markerEnd;\n    if (markerStart && isDisplayObject(markerStart)) {\n      _this.markerStartAngle = markerStart.getLocalEulerAngles();\n      _this.appendChild(markerStart);\n    }\n    if (markerEnd && isDisplayObject(markerEnd)) {\n      _this.markerEndAngle = markerEnd.getLocalEulerAngles();\n      _this.appendChild(markerEnd);\n    }\n    _this.transformMarker(true);\n    _this.transformMarker(false);\n    return _this;\n  }\n  _inherits(Line, _DisplayObject);\n  return _createClass(Line, [{\n    key: \"attributeChangedCallback\",\n    value: function attributeChangedCallback(attrName, oldValue, newValue, prevParsedValue, newParsedValue) {\n      if (attrName === 'x1' || attrName === 'y1' || attrName === 'x2' || attrName === 'y2' || attrName === 'markerStartOffset' || attrName === 'markerEndOffset') {\n        this.transformMarker(true);\n        this.transformMarker(false);\n      } else if (attrName === 'markerStart') {\n        if (prevParsedValue && isDisplayObject(prevParsedValue)) {\n          this.markerStartAngle = 0;\n          prevParsedValue.remove();\n        }\n\n        // CSSKeyword 'unset'\n        if (newParsedValue && isDisplayObject(newParsedValue)) {\n          this.markerStartAngle = newParsedValue.getLocalEulerAngles();\n          this.appendChild(newParsedValue);\n          this.transformMarker(true);\n        }\n      } else if (attrName === 'markerEnd') {\n        if (prevParsedValue && isDisplayObject(prevParsedValue)) {\n          this.markerEndAngle = 0;\n          prevParsedValue.remove();\n        }\n        if (newParsedValue && isDisplayObject(newParsedValue)) {\n          this.markerEndAngle = newParsedValue.getLocalEulerAngles();\n          this.appendChild(newParsedValue);\n          this.transformMarker(false);\n        }\n      }\n    }\n  }, {\n    key: \"transformMarker\",\n    value: function transformMarker(isStart) {\n      var _this$parsedStyle2 = this.parsedStyle,\n        markerStart = _this$parsedStyle2.markerStart,\n        markerEnd = _this$parsedStyle2.markerEnd,\n        markerStartOffset = _this$parsedStyle2.markerStartOffset,\n        markerEndOffset = _this$parsedStyle2.markerEndOffset,\n        x1 = _this$parsedStyle2.x1,\n        x2 = _this$parsedStyle2.x2,\n        y1 = _this$parsedStyle2.y1,\n        y2 = _this$parsedStyle2.y2;\n      var marker = isStart ? markerStart : markerEnd;\n      if (!marker || !isDisplayObject(marker)) {\n        return;\n      }\n      var rad = 0;\n      var x;\n      var y;\n      var ox;\n      var oy;\n      var offset;\n      var originalAngle;\n      if (isStart) {\n        ox = x1;\n        oy = y1;\n        x = x2 - x1;\n        y = y2 - y1;\n        offset = markerStartOffset || 0;\n        originalAngle = this.markerStartAngle;\n      } else {\n        ox = x2;\n        oy = y2;\n        x = x1 - x2;\n        y = y1 - y2;\n        offset = markerEndOffset || 0;\n        originalAngle = this.markerEndAngle;\n      }\n      rad = Math.atan2(y, x);\n\n      // account for markerOffset\n      marker.setLocalEulerAngles(rad * 180 / Math.PI + originalAngle);\n      marker.setLocalPosition(ox + Math.cos(rad) * offset, oy + Math.sin(rad) * offset);\n    }\n  }, {\n    key: \"getPoint\",\n    value: function getPoint(ratio) {\n      var inWorldSpace = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      // TODO: account for z1/z2 in 3D line\n      var _this$parsedStyle3 = this.parsedStyle,\n        x1 = _this$parsedStyle3.x1,\n        y1 = _this$parsedStyle3.y1,\n        x2 = _this$parsedStyle3.x2,\n        y2 = _this$parsedStyle3.y2;\n      var _linePointAt = linePointAt(x1, y1, x2, y2, ratio),\n        x = _linePointAt.x,\n        y = _linePointAt.y;\n      var transformed = vec3.transformMat4(vec3.create(), vec3.fromValues(x, y, 0), inWorldSpace ? this.getWorldTransform() : this.getLocalTransform());\n\n      // apply local transformation\n      return new Point(transformed[0], transformed[1]);\n    }\n  }, {\n    key: \"getPointAtLength\",\n    value: function getPointAtLength(distance) {\n      var inWorldSpace = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      return this.getPoint(distance / this.getTotalLength(), inWorldSpace);\n    }\n  }, {\n    key: \"getTotalLength\",\n    value: function getTotalLength() {\n      // TODO: account for z1/z2 in 3D line\n      var _this$parsedStyle4 = this.parsedStyle,\n        x1 = _this$parsedStyle4.x1,\n        y1 = _this$parsedStyle4.y1,\n        x2 = _this$parsedStyle4.x2,\n        y2 = _this$parsedStyle4.y2;\n      return lineLength(x1, y1, x2, y2);\n    }\n  }]);\n}(DisplayObject);\n\nvar _excluded$3 = [\"style\"];\nvar Path = /*#__PURE__*/function (_DisplayObject) {\n  function Path() {\n    var _this;\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      style = _ref.style,\n      rest = _objectWithoutProperties(_ref, _excluded$3);\n    _classCallCheck(this, Path);\n    _this = _callSuper(this, Path, [_objectSpread({\n      type: Shape.PATH,\n      style: style,\n      initialParsedStyle: {\n        miterLimit: 4,\n        d: _objectSpread({}, EMPTY_PARSED_PATH)\n      }\n    }, rest)]);\n    _this.markerStartAngle = 0;\n    _this.markerEndAngle = 0;\n    /**\n     * markers placed at the mid\n     */\n    _this.markerMidList = [];\n    var _this$parsedStyle = _this.parsedStyle,\n      markerStart = _this$parsedStyle.markerStart,\n      markerEnd = _this$parsedStyle.markerEnd,\n      markerMid = _this$parsedStyle.markerMid;\n    if (markerStart && isDisplayObject(markerStart)) {\n      _this.markerStartAngle = markerStart.getLocalEulerAngles();\n      _this.appendChild(markerStart);\n    }\n    if (markerMid && isDisplayObject(markerMid)) {\n      _this.placeMarkerMid(markerMid);\n    }\n    if (markerEnd && isDisplayObject(markerEnd)) {\n      _this.markerEndAngle = markerEnd.getLocalEulerAngles();\n      _this.appendChild(markerEnd);\n    }\n    _this.transformMarker(true);\n    _this.transformMarker(false);\n    return _this;\n  }\n  _inherits(Path, _DisplayObject);\n  return _createClass(Path, [{\n    key: \"attributeChangedCallback\",\n    value: function attributeChangedCallback(attrName, oldValue, newValue, prevParsedValue, newParsedValue) {\n      if (attrName === 'd') {\n        // recalc markers\n        this.transformMarker(true);\n        this.transformMarker(false);\n        this.placeMarkerMid(this.parsedStyle.markerMid);\n      } else if (attrName === 'markerStartOffset' || attrName === 'markerEndOffset') {\n        this.transformMarker(true);\n        this.transformMarker(false);\n      } else if (attrName === 'markerStart') {\n        if (prevParsedValue && isDisplayObject(prevParsedValue)) {\n          this.markerStartAngle = 0;\n          prevParsedValue.remove();\n        }\n\n        // CSSKeyword 'unset'\n        if (newParsedValue && isDisplayObject(newParsedValue)) {\n          this.markerStartAngle = newParsedValue.getLocalEulerAngles();\n          this.appendChild(newParsedValue);\n          this.transformMarker(true);\n        }\n      } else if (attrName === 'markerEnd') {\n        if (prevParsedValue && isDisplayObject(prevParsedValue)) {\n          this.markerEndAngle = 0;\n          prevParsedValue.remove();\n        }\n        if (newParsedValue && isDisplayObject(newParsedValue)) {\n          this.markerEndAngle = newParsedValue.getLocalEulerAngles();\n          this.appendChild(newParsedValue);\n          this.transformMarker(false);\n        }\n      } else if (attrName === 'markerMid') {\n        this.placeMarkerMid(newParsedValue);\n      }\n    }\n  }, {\n    key: \"transformMarker\",\n    value: function transformMarker(isStart) {\n      var _this$parsedStyle2 = this.parsedStyle,\n        markerStart = _this$parsedStyle2.markerStart,\n        markerEnd = _this$parsedStyle2.markerEnd,\n        markerStartOffset = _this$parsedStyle2.markerStartOffset,\n        markerEndOffset = _this$parsedStyle2.markerEndOffset;\n      var marker = isStart ? markerStart : markerEnd;\n      if (!marker || !isDisplayObject(marker)) {\n        return;\n      }\n      var rad = 0;\n      var x;\n      var y;\n      var ox;\n      var oy;\n      var offset;\n      var originalAngle;\n      if (isStart) {\n        var _this$getStartTangent = this.getStartTangent(),\n          _this$getStartTangent2 = _slicedToArray(_this$getStartTangent, 2),\n          p1 = _this$getStartTangent2[0],\n          p2 = _this$getStartTangent2[1];\n        ox = p2[0];\n        oy = p2[1];\n        x = p1[0] - p2[0];\n        y = p1[1] - p2[1];\n        offset = markerStartOffset || 0;\n        originalAngle = this.markerStartAngle;\n      } else {\n        var _this$getEndTangent = this.getEndTangent(),\n          _this$getEndTangent2 = _slicedToArray(_this$getEndTangent, 2),\n          _p = _this$getEndTangent2[0],\n          _p2 = _this$getEndTangent2[1];\n        ox = _p2[0];\n        oy = _p2[1];\n        x = _p[0] - _p2[0];\n        y = _p[1] - _p2[1];\n        offset = markerEndOffset || 0;\n        originalAngle = this.markerEndAngle;\n      }\n      rad = Math.atan2(y, x);\n\n      // account for markerOffset\n      marker.setLocalEulerAngles(rad * 180 / Math.PI + originalAngle);\n      marker.setLocalPosition(ox + Math.cos(rad) * offset, oy + Math.sin(rad) * offset);\n    }\n  }, {\n    key: \"placeMarkerMid\",\n    value: function placeMarkerMid(marker) {\n      var segments = this.parsedStyle.d.segments;\n      // clear all existed markers\n      this.markerMidList.forEach(function (marker) {\n        marker.remove();\n      });\n      if (marker && isDisplayObject(marker)) {\n        for (var i = 1; i < segments.length - 1; i++) {\n          var _segments$i$currentPo = _slicedToArray(segments[i].currentPoint, 2),\n            ox = _segments$i$currentPo[0],\n            oy = _segments$i$currentPo[1];\n          var cloned = i === 1 ? marker : marker.cloneNode(true);\n          this.markerMidList.push(cloned);\n          this.appendChild(cloned);\n          cloned.setLocalPosition(ox, oy);\n          // TODO: orient of marker\n        }\n      }\n    }\n\n    /**\n     * Returns the total length of the path.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/SVGGeometryElement/getTotalLength\n     */\n  }, {\n    key: \"getTotalLength\",\n    value: function getTotalLength() {\n      return getOrCalculatePathTotalLength(this);\n    }\n\n    /**\n     * Returns the point at a given distance along the path.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/SVGGeometryElement/getPointAtLength\n     */\n  }, {\n    key: \"getPointAtLength\",\n    value: function getPointAtLength$1(distance) {\n      var inWorldSpace = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var absolutePath = this.parsedStyle.d.absolutePath;\n      var _getPointAtLength2 = getPointAtLength(absolutePath, distance),\n        x = _getPointAtLength2.x,\n        y = _getPointAtLength2.y;\n      var transformed = vec3.transformMat4(vec3.create(), vec3.fromValues(x, y, 0), inWorldSpace ? this.getWorldTransform() : this.getLocalTransform());\n\n      // apply local transformation\n      return new Point(transformed[0], transformed[1]);\n    }\n\n    /**\n     * Returns the point at a given ratio of the total length in path.\n     */\n  }, {\n    key: \"getPoint\",\n    value: function getPoint(ratio) {\n      var inWorldSpace = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      return this.getPointAtLength(ratio * getOrCalculatePathTotalLength(this), inWorldSpace);\n    }\n\n    /**\n     * Get start tangent vector\n     */\n  }, {\n    key: \"getStartTangent\",\n    value: function getStartTangent() {\n      var segments = this.parsedStyle.d.segments;\n      var result = [];\n      if (segments.length > 1) {\n        var startPoint = segments[0].currentPoint;\n        var endPoint = segments[1].currentPoint;\n        var tangent = segments[1].startTangent;\n        result = [];\n        if (tangent) {\n          result.push([startPoint[0] - tangent[0], startPoint[1] - tangent[1]]);\n          result.push([startPoint[0], startPoint[1]]);\n        } else {\n          result.push([endPoint[0], endPoint[1]]);\n          result.push([startPoint[0], startPoint[1]]);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Get end tangent vector\n     */\n  }, {\n    key: \"getEndTangent\",\n    value: function getEndTangent() {\n      var segments = this.parsedStyle.d.segments;\n      var length = segments.length;\n      var result = [];\n      if (length > 1) {\n        var startPoint = segments[length - 2].currentPoint;\n        var endPoint = segments[length - 1].currentPoint;\n        var tangent = segments[length - 1].endTangent;\n        result = [];\n        if (tangent) {\n          result.push([endPoint[0] - tangent[0], endPoint[1] - tangent[1]]);\n          result.push([endPoint[0], endPoint[1]]);\n        } else {\n          result.push([startPoint[0], startPoint[1]]);\n          result.push([endPoint[0], endPoint[1]]);\n        }\n      }\n      return result;\n    }\n  }]);\n}(DisplayObject);\n\nvar _excluded$2 = [\"style\"];\nvar Polygon = /*#__PURE__*/function (_DisplayObject) {\n  function Polygon() {\n    var _this;\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      style = _ref.style,\n      rest = _objectWithoutProperties(_ref, _excluded$2);\n    _classCallCheck(this, Polygon);\n    _this = _callSuper(this, Polygon, [_objectSpread({\n      type: Shape.POLYGON,\n      style: style,\n      initialParsedStyle: {\n        points: {\n          points: [],\n          totalLength: 0,\n          segments: []\n        },\n        miterLimit: 4,\n        isClosed: true\n      }\n    }, rest)]);\n    _this.markerStartAngle = 0;\n    _this.markerEndAngle = 0;\n    /**\n     * markers placed at the mid\n     */\n    _this.markerMidList = [];\n    var _this$parsedStyle = _this.parsedStyle,\n      markerStart = _this$parsedStyle.markerStart,\n      markerEnd = _this$parsedStyle.markerEnd,\n      markerMid = _this$parsedStyle.markerMid;\n    if (markerStart && isDisplayObject(markerStart)) {\n      _this.markerStartAngle = markerStart.getLocalEulerAngles();\n      _this.appendChild(markerStart);\n    }\n    if (markerMid && isDisplayObject(markerMid)) {\n      _this.placeMarkerMid(markerMid);\n    }\n    if (markerEnd && isDisplayObject(markerEnd)) {\n      _this.markerEndAngle = markerEnd.getLocalEulerAngles();\n      _this.appendChild(markerEnd);\n    }\n    _this.transformMarker(true);\n    _this.transformMarker(false);\n    return _this;\n  }\n  _inherits(Polygon, _DisplayObject);\n  return _createClass(Polygon, [{\n    key: \"attributeChangedCallback\",\n    value: function attributeChangedCallback(attrName, oldValue, newValue, prevParsedValue, newParsedValue) {\n      if (attrName === 'points') {\n        // recalc markers\n        this.transformMarker(true);\n        this.transformMarker(false);\n        this.placeMarkerMid(this.parsedStyle.markerMid);\n      } else if (attrName === 'markerStartOffset' || attrName === 'markerEndOffset') {\n        this.transformMarker(true);\n        this.transformMarker(false);\n      } else if (attrName === 'markerStart') {\n        if (prevParsedValue && isDisplayObject(prevParsedValue)) {\n          this.markerStartAngle = 0;\n          prevParsedValue.remove();\n        }\n\n        // CSSKeyword 'unset'\n        if (newParsedValue && isDisplayObject(newParsedValue)) {\n          this.markerStartAngle = newParsedValue.getLocalEulerAngles();\n          this.appendChild(newParsedValue);\n          this.transformMarker(true);\n        }\n      } else if (attrName === 'markerEnd') {\n        if (prevParsedValue && isDisplayObject(prevParsedValue)) {\n          this.markerEndAngle = 0;\n          prevParsedValue.remove();\n        }\n        if (newParsedValue && isDisplayObject(newParsedValue)) {\n          this.markerEndAngle = newParsedValue.getLocalEulerAngles();\n          this.appendChild(newParsedValue);\n          this.transformMarker(false);\n        }\n      } else if (attrName === 'markerMid') {\n        this.placeMarkerMid(newParsedValue);\n      }\n    }\n  }, {\n    key: \"transformMarker\",\n    value: function transformMarker(isStart) {\n      var _this$parsedStyle2 = this.parsedStyle,\n        markerStart = _this$parsedStyle2.markerStart,\n        markerEnd = _this$parsedStyle2.markerEnd,\n        markerStartOffset = _this$parsedStyle2.markerStartOffset,\n        markerEndOffset = _this$parsedStyle2.markerEndOffset,\n        P = _this$parsedStyle2.points;\n      var _ref2 = P || {},\n        points = _ref2.points;\n      var marker = isStart ? markerStart : markerEnd;\n      if (!marker || !isDisplayObject(marker) || !points) {\n        return;\n      }\n      var rad = 0;\n      var x;\n      var y;\n      var ox;\n      var oy;\n      var offset;\n      var originalAngle;\n      ox = points[0][0];\n      oy = points[0][1];\n      if (isStart) {\n        x = points[1][0] - points[0][0];\n        y = points[1][1] - points[0][1];\n        offset = markerStartOffset || 0;\n        originalAngle = this.markerStartAngle;\n      } else {\n        var length = points.length;\n        if (!this.parsedStyle.isClosed) {\n          ox = points[length - 1][0];\n          oy = points[length - 1][1];\n          x = points[length - 2][0] - points[length - 1][0];\n          y = points[length - 2][1] - points[length - 1][1];\n        } else {\n          x = points[length - 1][0] - points[0][0];\n          y = points[length - 1][1] - points[0][1];\n        }\n        offset = markerEndOffset || 0;\n        originalAngle = this.markerEndAngle;\n      }\n      rad = Math.atan2(y, x);\n\n      // account for markerOffset\n      marker.setLocalEulerAngles(rad * 180 / Math.PI + originalAngle);\n      marker.setLocalPosition(ox + Math.cos(rad) * offset, oy + Math.sin(rad) * offset);\n    }\n  }, {\n    key: \"placeMarkerMid\",\n    value: function placeMarkerMid(marker) {\n      var P = this.parsedStyle.points;\n      var _ref3 = P || {},\n        points = _ref3.points;\n\n      // clear all existed markers\n      this.markerMidList.forEach(function (marker) {\n        marker.remove();\n      });\n      this.markerMidList = [];\n      if (marker && isDisplayObject(marker) && points) {\n        for (var i = 1; i < (this.parsedStyle.isClosed ? points.length : points.length - 1); i++) {\n          var ox = points[i][0];\n          var oy = points[i][1];\n          var cloned = i === 1 ? marker : marker.cloneNode(true);\n          this.markerMidList.push(cloned);\n          this.appendChild(cloned);\n          cloned.setLocalPosition(ox, oy);\n\n          // TODO: orient of marker\n        }\n      }\n    }\n  }]);\n}(DisplayObject);\n\nvar _excluded$1 = [\"style\"];\n/**\n * Polyline inherits the marker-related capabilities of Polygon.\n */\nvar Polyline = /*#__PURE__*/function (_Polygon) {\n  function Polyline() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      style = _ref.style,\n      rest = _objectWithoutProperties(_ref, _excluded$1);\n    _classCallCheck(this, Polyline);\n    return _callSuper(this, Polyline, [_objectSpread({\n      type: Shape.POLYLINE,\n      style: style,\n      initialParsedStyle: {\n        points: {\n          points: [],\n          totalLength: 0,\n          segments: []\n        },\n        miterLimit: 4,\n        isClosed: false\n      }\n    }, rest)]);\n  }\n  _inherits(Polyline, _Polygon);\n  return _createClass(Polyline, [{\n    key: \"getTotalLength\",\n    value: function getTotalLength() {\n      return getOrCalculatePolylineTotalLength(this);\n    }\n  }, {\n    key: \"getPointAtLength\",\n    value: function getPointAtLength(distance) {\n      var inWorldSpace = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      return this.getPoint(distance / this.getTotalLength(), inWorldSpace);\n    }\n  }, {\n    key: \"getPoint\",\n    value: function getPoint(ratio) {\n      var inWorldSpace = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var points = this.parsedStyle.points.points;\n      if (this.parsedStyle.points.segments.length === 0) {\n        var segments = [];\n        var tempLength = 0;\n        var segmentT;\n        var segmentL;\n        var totalLength = this.getTotalLength();\n        points.forEach(function (p, i) {\n          if (points[i + 1]) {\n            segmentT = [0, 0];\n            segmentT[0] = tempLength / totalLength;\n            segmentL = lineLength(p[0], p[1], points[i + 1][0], points[i + 1][1]);\n            tempLength += segmentL;\n            segmentT[1] = tempLength / totalLength;\n            segments.push(segmentT);\n          }\n        });\n        this.parsedStyle.points.segments = segments;\n      }\n      var subt = 0;\n      var index = 0;\n      this.parsedStyle.points.segments.forEach(function (v, i) {\n        if (ratio >= v[0] && ratio <= v[1]) {\n          subt = (ratio - v[0]) / (v[1] - v[0]);\n          index = i;\n        }\n      });\n      var _linePointAt = linePointAt(points[index][0], points[index][1], points[index + 1][0], points[index + 1][1], subt),\n        x = _linePointAt.x,\n        y = _linePointAt.y;\n      var transformed = vec3.transformMat4(vec3.create(), vec3.fromValues(x, y, 0), inWorldSpace ? this.getWorldTransform() : this.getLocalTransform());\n\n      // apply local transformation\n      return new Point(transformed[0], transformed[1]);\n    }\n  }, {\n    key: \"getStartTangent\",\n    value: function getStartTangent() {\n      var points = this.parsedStyle.points.points;\n      var result = [];\n      result.push([points[1][0], points[1][1]]);\n      result.push([points[0][0], points[0][1]]);\n      return result;\n    }\n  }, {\n    key: \"getEndTangent\",\n    value: function getEndTangent() {\n      var points = this.parsedStyle.points.points;\n      var l = points.length - 1;\n      var result = [];\n      result.push([points[l - 1][0], points[l - 1][1]]);\n      result.push([points[l][0], points[l][1]]);\n      return result;\n    }\n  }]);\n}(Polygon);\n\nvar Rect = /*#__PURE__*/function (_DisplayObject) {\n  function Rect() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _classCallCheck(this, Rect);\n    return _callSuper(this, Rect, [_objectSpread({\n      type: Shape.RECT\n    }, options)]);\n  }\n  _inherits(Rect, _DisplayObject);\n  return _createClass(Rect);\n}(DisplayObject);\n\nvar _excluded = [\"style\"];\n/**\n * <text> @see https://developer.mozilla.org/en-US/docs/Web/API/SVGTextElement\n */\nvar Text = /*#__PURE__*/function (_DisplayObject) {\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/SVGTextContentElement#constants\n   */\n  // LENGTHADJUST_SPACING: number = 1;\n  // LENGTHADJUST_SPACINGANDGLYPHS: number = 2;\n  // LENGTHADJUST_UNKNOWN: number = 0;\n\n  function Text() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      style = _ref.style,\n      rest = _objectWithoutProperties(_ref, _excluded);\n    _classCallCheck(this, Text);\n    return _callSuper(this, Text, [_objectSpread({\n      type: Shape.TEXT,\n      style: _objectSpread({\n        fill: 'black'\n      }, style)\n    }, rest)]);\n  }\n\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/SVGTextContentElement\n   */\n  _inherits(Text, _DisplayObject);\n  return _createClass(Text, [{\n    key: \"getComputedTextLength\",\n    value: function getComputedTextLength() {\n      var _this$parsedStyle$met;\n      this.getGeometryBounds();\n      return ((_this$parsedStyle$met = this.parsedStyle.metrics) === null || _this$parsedStyle$met === void 0 ? void 0 : _this$parsedStyle$met.maxLineWidth) || 0;\n    }\n  }, {\n    key: \"getLineBoundingRects\",\n    value: function getLineBoundingRects() {\n      var _this$parsedStyle$met2;\n      this.getGeometryBounds();\n      return ((_this$parsedStyle$met2 = this.parsedStyle.metrics) === null || _this$parsedStyle$met2 === void 0 ? void 0 : _this$parsedStyle$met2.lineMetrics) || [];\n    }\n  }, {\n    key: \"isOverflowing\",\n    value: function isOverflowing() {\n      this.getGeometryBounds();\n      return !!this.parsedStyle.isOverflowing;\n    }\n  }]);\n}(DisplayObject);\n\n/**\n * canvas.customElements\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/CustomElementRegistry\n */\nvar CustomElementRegistry = /*#__PURE__*/function () {\n  function CustomElementRegistry() {\n    _classCallCheck(this, CustomElementRegistry);\n    this.registry = {};\n    this.define(Shape.CIRCLE, Circle);\n    this.define(Shape.ELLIPSE, Ellipse);\n    this.define(Shape.RECT, Rect);\n    this.define(Shape.IMAGE, Image);\n    this.define(Shape.LINE, Line);\n    this.define(Shape.GROUP, Group);\n    this.define(Shape.PATH, Path);\n    this.define(Shape.POLYGON, Polygon);\n    this.define(Shape.POLYLINE, Polyline);\n    this.define(Shape.TEXT, Text);\n    this.define(Shape.HTML, HTML);\n  }\n  return _createClass(CustomElementRegistry, [{\n    key: \"define\",\n    value: function define(name, constructor) {\n      this.registry[name] = constructor;\n    }\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/CustomElementRegistry/get\n     */\n  }, {\n    key: \"get\",\n    value: function get(name) {\n      return this.registry[name];\n    }\n  }]);\n}();\n\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/API/CSS/RegisterProperty#parameters\n */\n\n/**\n * holds useful CSS-related methods.\n * @see https://developer.mozilla.org/en-US/docs/Web/API/CSS\n *\n * * CSS Typed OM @see https://developer.mozilla.org/en-US/docs/Web/API/CSS/factory_functions\n * * register property @see https://developer.mozilla.org/en-US/docs/Web/API/CSS/RegisterProperty\n * * CSS Layout API\n */\nvar CSS = {\n  /**\n   * <number>\n   * @see https://drafts.csswg.org/css-values-4/#number-value\n   */\n  number: function number(n) {\n    return new CSSUnitValue(n);\n  },\n  /**\n   * <percentage>\n   * @see https://drafts.csswg.org/css-values-4/#percentage-value\n   */\n  percent: function percent(n) {\n    return new CSSUnitValue(n, '%');\n  },\n  /**\n   * <length>\n   */\n  px: function px(n) {\n    return new CSSUnitValue(n, 'px');\n  },\n  /**\n   * <length>\n   */\n  em: function em(n) {\n    return new CSSUnitValue(n, 'em');\n  },\n  rem: function rem(n) {\n    return new CSSUnitValue(n, 'rem');\n  },\n  /**\n   * <angle>\n   */\n  deg: function deg(n) {\n    return new CSSUnitValue(n, 'deg');\n  },\n  /**\n   * <angle>\n   */\n  grad: function grad(n) {\n    return new CSSUnitValue(n, 'grad');\n  },\n  /**\n   * <angle>\n   */\n  rad: function rad(n) {\n    return new CSSUnitValue(n, 'rad');\n  },\n  /**\n   * <angle>\n   */\n  turn: function turn(n) {\n    return new CSSUnitValue(n, 'turn');\n  },\n  /**\n   * <time>\n   */\n  s: function s(n) {\n    return new CSSUnitValue(n, 's');\n  },\n  /**\n   * <time>\n   */\n  ms: function ms(n) {\n    return new CSSUnitValue(n, 'ms');\n  },\n  /**\n   * CSS Properties & Values API\n   *\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/CSS_Properties_and_Values_API\n   * @see https://drafts.css-houdini.org/css-properties-values-api/#registering-custom-properties\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/CSS/RegisterProperty\n   */\n  registerProperty: function registerProperty(definition) {\n    var name = definition.name,\n      inherits = definition.inherits,\n      interpolable = definition.interpolable,\n      initialValue = definition.initialValue,\n      syntax = definition.syntax;\n    runtime.styleValueRegistry.registerMetadata({\n      n: name,\n      inh: inherits,\n      \"int\": interpolable,\n      d: initialValue,\n      syntax: syntax\n    });\n  },\n  /**\n   * CSS Layout API\n   * register layout\n   *\n   * @see https://github.com/w3c/css-houdini-drafts/blob/main/css-layout-api/EXPLAINER.md\n   * @see https://developer.mozilla.org/en-US/docs/Web/Guide/Houdini#css_layout_api\n   */\n  registerLayout: function registerLayout(name, clazz) {\n    runtime.layoutRegistry.registerLayout(name, clazz);\n  }\n};\n\n/**\n * the entry of DOM tree\n * Document -> Node -> EventTarget\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Document\n */\nvar Document = /*#__PURE__*/function (_Node) {\n  function Document() {\n    var _this;\n    _classCallCheck(this, Document);\n    _this = _callSuper(this, Document);\n    /**\n     * only document has defaultView, points to canvas,\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/defaultView\n     */\n    _this.defaultView = null;\n    _this.ownerDocument = null;\n    _this.nodeName = 'document';\n\n    // create timeline\n    try {\n      _this.timeline = new runtime.AnimationTimeline(_this);\n    } catch (_unused) {}\n\n    /**\n     * for inherited properties, the initial value is used on the root element only,\n     * as long as no specified value is supplied.\n     * @see https://developer.mozilla.org/en-US/docs/Web/CSS/initial_value\n     */\n    var initialStyle = {};\n    BUILT_IN_PROPERTIES.forEach(function (_ref) {\n      var n = _ref.n,\n        inh = _ref.inh,\n        d = _ref.d;\n      if (inh && d) {\n        initialStyle[n] = isFunction(d) ? d(Shape.GROUP) : d;\n      }\n    });\n\n    // like <html> in DOM tree\n    _this.documentElement = new Group({\n      id: 'g-root',\n      style: initialStyle\n    });\n    _this.documentElement.ownerDocument = _this;\n    _this.documentElement.parentNode = _this;\n    _this.childNodes = [_this.documentElement];\n    return _this;\n  }\n  _inherits(Document, _Node);\n  return _createClass(Document, [{\n    key: \"children\",\n    get: function get() {\n      return this.childNodes;\n    }\n  }, {\n    key: \"childElementCount\",\n    get: function get() {\n      return this.childNodes.length;\n    }\n  }, {\n    key: \"firstElementChild\",\n    get: function get() {\n      return this.firstChild;\n    }\n  }, {\n    key: \"lastElementChild\",\n    get: function get() {\n      return this.lastChild;\n    }\n  }, {\n    key: \"createElement\",\n    value:\n    /**\n     * @example const circle = document.createElement('circle', { style: { r: 10 } });\n     */\n    function createElement(tagName, options) {\n      // @observablehq/plot will create <svg>\n      if (tagName === 'svg') {\n        return this.documentElement;\n      }\n\n      // d3 will use <tspan>\n      var clazz = this.defaultView.customElements.get(tagName);\n      if (!clazz) {\n        console.warn('Unsupported tagName: ', tagName);\n        clazz = tagName === 'tspan' ? Text : Group;\n      }\n      var shape = new clazz(options);\n      shape.ownerDocument = this;\n      return shape;\n    }\n  }, {\n    key: \"createElementNS\",\n    value: function createElementNS(namespaceURI, tagName, options) {\n      return this.createElement(tagName, options);\n    }\n  }, {\n    key: \"cloneNode\",\n    value: function cloneNode(deep) {\n      throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      try {\n        this.documentElement.destroyChildren();\n        this.timeline.destroy();\n      } catch (_unused2) {}\n    }\n\n    /**\n     * Picking 2D graphics with RBush based on BBox, fast but inaccurate.\n     */\n  }, {\n    key: \"elementsFromBBox\",\n    value: function elementsFromBBox(minX, minY, maxX, maxY) {\n      var rBush = this.defaultView.context.rBushRoot;\n      var rBushNodes = rBush.search({\n        minX: minX,\n        minY: minY,\n        maxX: maxX,\n        maxY: maxY\n      });\n      var hitTestList = [];\n      rBushNodes.forEach(function (_ref2) {\n        var displayObject = _ref2.displayObject;\n        var _ref3 = displayObject.parsedStyle,\n          _ref3$pointerEvents = _ref3.pointerEvents,\n          pointerEvents = _ref3$pointerEvents === void 0 ? 'auto' : _ref3$pointerEvents;\n\n        // account for `visibility`\n        // @see https://developer.mozilla.org/en-US/docs/Web/CSS/pointer-events\n        var isVisibilityAffected = ['auto', 'visiblepainted', 'visiblefill', 'visiblestroke', 'visible'].includes(pointerEvents);\n        if ((!isVisibilityAffected || isVisibilityAffected && displayObject.isVisible()) && !displayObject.isCulled() && displayObject.isInteractive()) {\n          hitTestList.push(displayObject);\n        }\n      });\n      // find group with max z-index\n      hitTestList.sort(function (a, b) {\n        return b.sortable.renderOrder - a.sortable.renderOrder;\n      });\n      return hitTestList;\n    }\n  }, {\n    key: \"elementFromPointSync\",\n    value: function elementFromPointSync(x, y) {\n      var _this$defaultView$can = this.defaultView.canvas2Viewport({\n          x: x,\n          y: y\n        }),\n        viewportX = _this$defaultView$can.x,\n        viewportY = _this$defaultView$can.y;\n      var _this$defaultView$get = this.defaultView.getConfig(),\n        width = _this$defaultView$get.width,\n        height = _this$defaultView$get.height;\n      // outside canvas' viewport\n      if (viewportX < 0 || viewportY < 0 || viewportX > width || viewportY > height) {\n        return null;\n      }\n      var _this$defaultView$vie = this.defaultView.viewport2Client({\n          x: viewportX,\n          y: viewportY\n        }),\n        clientX = _this$defaultView$vie.x,\n        clientY = _this$defaultView$vie.y;\n      var _this$defaultView$get2 = this.defaultView.getRenderingService().hooks.pickSync.call({\n          topmost: true,\n          position: {\n            x: x,\n            y: y,\n            viewportX: viewportX,\n            viewportY: viewportY,\n            clientX: clientX,\n            clientY: clientY\n          },\n          picked: []\n        }),\n        picked = _this$defaultView$get2.picked;\n      return picked && picked[0] || this.documentElement;\n    }\n\n    /**\n     * Do picking with API instead of triggering interactive events.\n     *\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Document/elementFromPoint\n     */\n  }, {\n    key: \"elementFromPoint\",\n    value: (function () {\n      var _elementFromPoint = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(x, y) {\n        var _this$defaultView$can2, viewportX, viewportY, _this$defaultView$get3, width, height, _this$defaultView$vie2, clientX, clientY, _yield$this$defaultVi, picked;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _this$defaultView$can2 = this.defaultView.canvas2Viewport({\n                x: x,\n                y: y\n              }), viewportX = _this$defaultView$can2.x, viewportY = _this$defaultView$can2.y;\n              _this$defaultView$get3 = this.defaultView.getConfig(), width = _this$defaultView$get3.width, height = _this$defaultView$get3.height; // outside canvas' viewport\n              if (!(viewportX < 0 || viewportY < 0 || viewportX > width || viewportY > height)) {\n                _context.next = 4;\n                break;\n              }\n              return _context.abrupt(\"return\", null);\n            case 4:\n              _this$defaultView$vie2 = this.defaultView.viewport2Client({\n                x: viewportX,\n                y: viewportY\n              }), clientX = _this$defaultView$vie2.x, clientY = _this$defaultView$vie2.y;\n              _context.next = 7;\n              return this.defaultView.getRenderingService().hooks.pick.promise({\n                topmost: true,\n                position: {\n                  x: x,\n                  y: y,\n                  viewportX: viewportX,\n                  viewportY: viewportY,\n                  clientX: clientX,\n                  clientY: clientY\n                },\n                picked: []\n              });\n            case 7:\n              _yield$this$defaultVi = _context.sent;\n              picked = _yield$this$defaultVi.picked;\n              return _context.abrupt(\"return\", picked && picked[0] || this.documentElement);\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function elementFromPoint(_x, _x2) {\n        return _elementFromPoint.apply(this, arguments);\n      }\n      return elementFromPoint;\n    }())\n  }, {\n    key: \"elementsFromPointSync\",\n    value: function elementsFromPointSync(x, y) {\n      var _this$defaultView$can3 = this.defaultView.canvas2Viewport({\n          x: x,\n          y: y\n        }),\n        viewportX = _this$defaultView$can3.x,\n        viewportY = _this$defaultView$can3.y;\n      var _this$defaultView$get4 = this.defaultView.getConfig(),\n        width = _this$defaultView$get4.width,\n        height = _this$defaultView$get4.height;\n      // outside canvas' viewport\n      if (viewportX < 0 || viewportY < 0 || viewportX > width || viewportY > height) {\n        return [];\n      }\n      var _this$defaultView$vie3 = this.defaultView.viewport2Client({\n          x: viewportX,\n          y: viewportY\n        }),\n        clientX = _this$defaultView$vie3.x,\n        clientY = _this$defaultView$vie3.y;\n      var _this$defaultView$get5 = this.defaultView.getRenderingService().hooks.pickSync.call({\n          topmost: false,\n          position: {\n            x: x,\n            y: y,\n            viewportX: viewportX,\n            viewportY: viewportY,\n            clientX: clientX,\n            clientY: clientY\n          },\n          picked: []\n        }),\n        picked = _this$defaultView$get5.picked;\n      if (picked[picked.length - 1] !== this.documentElement) {\n        picked.push(this.documentElement);\n      }\n      return picked;\n    }\n\n    /**\n     * Do picking with API instead of triggering interactive events.\n     *\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Document/elementsFromPoint\n     */\n  }, {\n    key: \"elementsFromPoint\",\n    value: (function () {\n      var _elementsFromPoint = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(x, y) {\n        var _this$defaultView$can4, viewportX, viewportY, _this$defaultView$get6, width, height, _this$defaultView$vie4, clientX, clientY, _yield$this$defaultVi2, picked;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _this$defaultView$can4 = this.defaultView.canvas2Viewport({\n                x: x,\n                y: y\n              }), viewportX = _this$defaultView$can4.x, viewportY = _this$defaultView$can4.y;\n              _this$defaultView$get6 = this.defaultView.getConfig(), width = _this$defaultView$get6.width, height = _this$defaultView$get6.height; // outside canvas' viewport\n              if (!(viewportX < 0 || viewportY < 0 || viewportX > width || viewportY > height)) {\n                _context2.next = 4;\n                break;\n              }\n              return _context2.abrupt(\"return\", []);\n            case 4:\n              _this$defaultView$vie4 = this.defaultView.viewport2Client({\n                x: viewportX,\n                y: viewportY\n              }), clientX = _this$defaultView$vie4.x, clientY = _this$defaultView$vie4.y;\n              _context2.next = 7;\n              return this.defaultView.getRenderingService().hooks.pick.promise({\n                topmost: false,\n                position: {\n                  x: x,\n                  y: y,\n                  viewportX: viewportX,\n                  viewportY: viewportY,\n                  clientX: clientX,\n                  clientY: clientY\n                },\n                picked: []\n              });\n            case 7:\n              _yield$this$defaultVi2 = _context2.sent;\n              picked = _yield$this$defaultVi2.picked;\n              if (picked[picked.length - 1] !== this.documentElement) {\n                picked.push(this.documentElement);\n              }\n              return _context2.abrupt(\"return\", picked);\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function elementsFromPoint(_x3, _x4) {\n        return _elementsFromPoint.apply(this, arguments);\n      }\n      return elementsFromPoint;\n    }()\n    /**\n     * eg. Uncaught DOMException: Failed to execute 'appendChild' on 'Node': Only one element on document allowed.\n     */\n    )\n  }, {\n    key: \"appendChild\",\n    value: function appendChild(newChild, index) {\n      throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT);\n    }\n  }, {\n    key: \"insertBefore\",\n    value: function insertBefore(newChild, refChild) {\n      throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT);\n    }\n  }, {\n    key: \"removeChild\",\n    value: function removeChild(oldChild, destroy) {\n      throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT);\n    }\n  }, {\n    key: \"replaceChild\",\n    value: function replaceChild(newChild, oldChild, destroy) {\n      throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT);\n    }\n  }, {\n    key: \"append\",\n    value: function append() {\n      throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT);\n    }\n  }, {\n    key: \"prepend\",\n    value: function prepend() {\n      throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT);\n    }\n\n    /**\n     * Execute query on documentElement.\n     */\n  }, {\n    key: \"getElementById\",\n    value: function getElementById(id) {\n      return this.documentElement.getElementById(id);\n    }\n  }, {\n    key: \"getElementsByName\",\n    value: function getElementsByName(name) {\n      return this.documentElement.getElementsByName(name);\n    }\n  }, {\n    key: \"getElementsByTagName\",\n    value: function getElementsByTagName(tagName) {\n      return this.documentElement.getElementsByTagName(tagName);\n    }\n  }, {\n    key: \"getElementsByClassName\",\n    value: function getElementsByClassName(className) {\n      return this.documentElement.getElementsByClassName(className);\n    }\n  }, {\n    key: \"querySelector\",\n    value: function querySelector(selectors) {\n      return this.documentElement.querySelector(selectors);\n    }\n  }, {\n    key: \"querySelectorAll\",\n    value: function querySelectorAll(selectors) {\n      return this.documentElement.querySelectorAll(selectors);\n    }\n  }, {\n    key: \"find\",\n    value: function find(filter) {\n      return this.documentElement.find(filter);\n    }\n  }, {\n    key: \"findAll\",\n    value: function findAll(filter) {\n      return this.documentElement.findAll(filter);\n    }\n  }]);\n}(Node);\n\n/**\n * apply following rules:\n * 1. `visibility` in scenegraph node\n * 2. other custom culling strategies, eg. frustum culling\n */\nvar CullingPlugin = /*#__PURE__*/function () {\n  function CullingPlugin(strategies) {\n    _classCallCheck(this, CullingPlugin);\n    this.strategies = strategies;\n  }\n  return _createClass(CullingPlugin, [{\n    key: \"apply\",\n    value: function apply(context) {\n      var camera = context.camera,\n        renderingService = context.renderingService,\n        renderingContext = context.renderingContext;\n      var strategies = this.strategies;\n      renderingService.hooks.cull.tap(CullingPlugin.tag, function (object) {\n        if (object) {\n          var cullable = object.cullable;\n          // cullable.visible = true;\n          // const renderBounds = object.getRenderBounds();\n          // if (AABB.isEmpty(renderBounds)) {\n          //   cullable.visible = false;\n          // } else {\n          //   const isShape2D = shape2D.indexOf(object.nodeName as Shape) > -1;\n          //   const [p0, p1, p2, p3] = camera.getFrustum().planes;\n          //   tmpAABB.setMinMax([-p1.distance, -p3.distance, 0], [p0.distance, p2.distance, 0]);\n\n          //   cullable.visible = isShape2D ? renderBounds.intersects(tmpAABB) : true;\n          // }\n\n          if (strategies.length === 0) {\n            cullable.visible = renderingContext.unculledEntities.indexOf(object.entity) > -1;\n          } else {\n            // eg. implemented by g-webgl(frustum culling)\n            cullable.visible = strategies.every(function (strategy) {\n              return strategy.isVisible(camera, object);\n            });\n          }\n          if (!object.isCulled() && object.isVisible()) {\n            return object;\n          }\n          // if (this.renderingContext.renderListLastFrame.indexOf(object) > -1) {\n          object.dispatchEvent(new CustomEvent(ElementEvent.CULLED));\n          // }\n\n          return null;\n        }\n        return object;\n      });\n      renderingService.hooks.afterRender.tap(CullingPlugin.tag, function (object) {\n        object.cullable.visibilityPlaneMask = -1;\n      });\n    }\n  }]);\n}();\nCullingPlugin.tag = 'Culling';\n\n/**\n * support mouse & touch events\n * @see https://github.com/pixijs/pixi.js/blob/dev/packages/interaction/README.md\n *\n * also provide some extra events such as `drag`\n */\nvar EventPlugin = /*#__PURE__*/function () {\n  function EventPlugin() {\n    var _this = this;\n    _classCallCheck(this, EventPlugin);\n    this.autoPreventDefault = false;\n    this.rootPointerEvent = new FederatedPointerEvent(null);\n    this.rootWheelEvent = new FederatedWheelEvent(null);\n    this.onPointerMove = function (nativeEvent) {\n      var _this$context$renderi;\n      var canvas = (_this$context$renderi = _this.context.renderingContext.root) === null || _this$context$renderi === void 0 || (_this$context$renderi = _this$context$renderi.ownerDocument) === null || _this$context$renderi === void 0 ? void 0 : _this$context$renderi.defaultView;\n      if (canvas.supportsTouchEvents && nativeEvent.pointerType === 'touch') return;\n      var normalizedEvents = _this.normalizeToPointerEvent(nativeEvent, canvas);\n      var _iterator = _createForOfIteratorHelper(normalizedEvents),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var normalizedEvent = _step.value;\n          var event = _this.bootstrapEvent(_this.rootPointerEvent, normalizedEvent, canvas, nativeEvent);\n          _this.context.eventService.mapEvent(event);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      _this.setCursor(_this.context.eventService.cursor);\n    };\n    this.onClick = function (nativeEvent) {\n      var _this$context$renderi2;\n      var canvas = (_this$context$renderi2 = _this.context.renderingContext.root) === null || _this$context$renderi2 === void 0 || (_this$context$renderi2 = _this$context$renderi2.ownerDocument) === null || _this$context$renderi2 === void 0 ? void 0 : _this$context$renderi2.defaultView;\n      var normalizedEvents = _this.normalizeToPointerEvent(nativeEvent, canvas);\n      var _iterator2 = _createForOfIteratorHelper(normalizedEvents),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var normalizedEvent = _step2.value;\n          var event = _this.bootstrapEvent(_this.rootPointerEvent, normalizedEvent, canvas, nativeEvent);\n          _this.context.eventService.mapEvent(event);\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n      _this.setCursor(_this.context.eventService.cursor);\n    };\n  }\n  return _createClass(EventPlugin, [{\n    key: \"apply\",\n    value: function apply(context) {\n      var _this2 = this;\n      this.context = context;\n      var renderingService = context.renderingService;\n      var canvas = this.context.renderingContext.root.ownerDocument.defaultView;\n      this.context.eventService.setPickHandler(function (position) {\n        var _this2$context$render = _this2.context.renderingService.hooks.pickSync.call({\n            position: position,\n            picked: [],\n            topmost: true // we only concern the topmost element\n          }),\n          picked = _this2$context$render.picked;\n        return picked[0] || null;\n      });\n      renderingService.hooks.pointerWheel.tap(EventPlugin.tag, function (nativeEvent) {\n        var wheelEvent = _this2.normalizeWheelEvent(nativeEvent);\n        _this2.context.eventService.mapEvent(wheelEvent);\n      });\n      renderingService.hooks.pointerDown.tap(EventPlugin.tag, function (nativeEvent) {\n        if (canvas.supportsTouchEvents && nativeEvent.pointerType === 'touch') return;\n        var events = _this2.normalizeToPointerEvent(nativeEvent, canvas);\n        if (_this2.autoPreventDefault && events[0].isNormalized) {\n          var cancelable = nativeEvent.cancelable || !('cancelable' in nativeEvent);\n          if (cancelable) {\n            nativeEvent.preventDefault();\n          }\n        }\n        var _iterator3 = _createForOfIteratorHelper(events),\n          _step3;\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var event = _step3.value;\n            var federatedEvent = _this2.bootstrapEvent(_this2.rootPointerEvent, event, canvas, nativeEvent);\n            _this2.context.eventService.mapEvent(federatedEvent);\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n        _this2.setCursor(_this2.context.eventService.cursor);\n      });\n      renderingService.hooks.pointerUp.tap(EventPlugin.tag, function (nativeEvent) {\n        if (canvas.supportsTouchEvents && nativeEvent.pointerType === 'touch') return;\n\n        // account for element in SVG\n        var $element = _this2.context.contextService.getDomElement();\n        var isNativeEventFromCanvas = _this2.context.eventService.isNativeEventFromCanvas($element, nativeEvent);\n        var outside = !isNativeEventFromCanvas ? 'outside' : '';\n        var normalizedEvents = _this2.normalizeToPointerEvent(nativeEvent, canvas);\n        var _iterator4 = _createForOfIteratorHelper(normalizedEvents),\n          _step4;\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var normalizedEvent = _step4.value;\n            var event = _this2.bootstrapEvent(_this2.rootPointerEvent, normalizedEvent, canvas, nativeEvent);\n            event.type += outside;\n            _this2.context.eventService.mapEvent(event);\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n        _this2.setCursor(_this2.context.eventService.cursor);\n      });\n      renderingService.hooks.pointerMove.tap(EventPlugin.tag, this.onPointerMove);\n      renderingService.hooks.pointerOver.tap(EventPlugin.tag, this.onPointerMove);\n      renderingService.hooks.pointerOut.tap(EventPlugin.tag, this.onPointerMove);\n      renderingService.hooks.click.tap(EventPlugin.tag, this.onClick);\n      renderingService.hooks.pointerCancel.tap(EventPlugin.tag, function (nativeEvent) {\n        var normalizedEvents = _this2.normalizeToPointerEvent(nativeEvent, canvas);\n        var _iterator5 = _createForOfIteratorHelper(normalizedEvents),\n          _step5;\n        try {\n          for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n            var normalizedEvent = _step5.value;\n            var event = _this2.bootstrapEvent(_this2.rootPointerEvent, normalizedEvent, canvas, nativeEvent);\n            _this2.context.eventService.mapEvent(event);\n          }\n        } catch (err) {\n          _iterator5.e(err);\n        } finally {\n          _iterator5.f();\n        }\n        _this2.setCursor(_this2.context.eventService.cursor);\n      });\n    }\n  }, {\n    key: \"bootstrapEvent\",\n    value: function bootstrapEvent(event, normalizedEvent, view, nativeEvent) {\n      event.view = view;\n      event.originalEvent = null;\n      event.nativeEvent = nativeEvent;\n      event.pointerId = normalizedEvent.pointerId;\n      event.width = normalizedEvent.width;\n      event.height = normalizedEvent.height;\n      event.isPrimary = normalizedEvent.isPrimary;\n      event.pointerType = normalizedEvent.pointerType;\n      event.pressure = normalizedEvent.pressure;\n      event.tangentialPressure = normalizedEvent.tangentialPressure;\n      event.tiltX = normalizedEvent.tiltX;\n      event.tiltY = normalizedEvent.tiltY;\n      event.twist = normalizedEvent.twist;\n      this.transferMouseData(event, normalizedEvent);\n      var _this$context$eventSe = this.context.eventService.client2Viewport({\n          x: normalizedEvent.clientX,\n          y: normalizedEvent.clientY\n        }),\n        x = _this$context$eventSe.x,\n        y = _this$context$eventSe.y;\n      event.viewport.x = x;\n      event.viewport.y = y;\n      var _this$context$eventSe2 = this.context.eventService.viewport2Canvas(event.viewport),\n        canvasX = _this$context$eventSe2.x,\n        canvasY = _this$context$eventSe2.y;\n      event.canvas.x = canvasX;\n      event.canvas.y = canvasY;\n      event.global.copyFrom(event.canvas);\n      event.offset.copyFrom(event.canvas);\n      event.isTrusted = nativeEvent.isTrusted;\n      if (event.type === 'pointerleave') {\n        event.type = 'pointerout';\n      }\n      if (event.type.startsWith('mouse')) {\n        event.type = event.type.replace('mouse', 'pointer');\n      }\n      if (event.type.startsWith('touch')) {\n        event.type = TOUCH_TO_POINTER[event.type] || event.type;\n      }\n      return event;\n    }\n  }, {\n    key: \"normalizeWheelEvent\",\n    value: function normalizeWheelEvent(nativeEvent) {\n      var event = this.rootWheelEvent;\n      this.transferMouseData(event, nativeEvent);\n      event.deltaMode = nativeEvent.deltaMode;\n      event.deltaX = nativeEvent.deltaX;\n      event.deltaY = nativeEvent.deltaY;\n      event.deltaZ = nativeEvent.deltaZ;\n      var _this$context$eventSe3 = this.context.eventService.client2Viewport({\n          x: nativeEvent.clientX,\n          y: nativeEvent.clientY\n        }),\n        x = _this$context$eventSe3.x,\n        y = _this$context$eventSe3.y;\n      event.viewport.x = x;\n      event.viewport.y = y;\n      var _this$context$eventSe4 = this.context.eventService.viewport2Canvas(event.viewport),\n        canvasX = _this$context$eventSe4.x,\n        canvasY = _this$context$eventSe4.y;\n      event.canvas.x = canvasX;\n      event.canvas.y = canvasY;\n      event.global.copyFrom(event.canvas);\n      event.offset.copyFrom(event.canvas);\n      event.nativeEvent = nativeEvent;\n      event.type = nativeEvent.type;\n      return event;\n    }\n\n    /**\n     * Transfers base & mouse event data from the nativeEvent to the federated event.\n     */\n  }, {\n    key: \"transferMouseData\",\n    value: function transferMouseData(event, nativeEvent) {\n      event.isTrusted = nativeEvent.isTrusted;\n      event.srcElement = nativeEvent.srcElement;\n      event.timeStamp = clock.now();\n      event.type = nativeEvent.type;\n      event.altKey = nativeEvent.altKey;\n      event.metaKey = nativeEvent.metaKey;\n      event.shiftKey = nativeEvent.shiftKey;\n      event.ctrlKey = nativeEvent.ctrlKey;\n      event.button = nativeEvent.button;\n      event.buttons = nativeEvent.buttons;\n      event.client.x = nativeEvent.clientX;\n      event.client.y = nativeEvent.clientY;\n      event.movement.x = nativeEvent.movementX;\n      event.movement.y = nativeEvent.movementY;\n      event.page.x = nativeEvent.pageX;\n      event.page.y = nativeEvent.pageY;\n      event.screen.x = nativeEvent.screenX;\n      event.screen.y = nativeEvent.screenY;\n      event.relatedTarget = null;\n    }\n  }, {\n    key: \"setCursor\",\n    value: function setCursor(cursor) {\n      this.context.contextService.applyCursorStyle(cursor || this.context.config.cursor || 'default');\n    }\n  }, {\n    key: \"normalizeToPointerEvent\",\n    value: function normalizeToPointerEvent(event, canvas) {\n      var normalizedEvents = [];\n      if (canvas.isTouchEvent(event)) {\n        for (var i = 0; i < event.changedTouches.length; i++) {\n          var touch = event.changedTouches[i];\n\n          // use changedTouches instead of touches since touchend has no touches\n          // @see https://stackoverflow.com/a/10079076\n          if (isUndefined(touch.button)) touch.button = 0;\n          if (isUndefined(touch.buttons)) touch.buttons = 1;\n          if (isUndefined(touch.isPrimary)) {\n            touch.isPrimary = event.touches.length === 1 && event.type === 'touchstart';\n          }\n          if (isUndefined(touch.width)) touch.width = touch.radiusX || 1;\n          if (isUndefined(touch.height)) touch.height = touch.radiusY || 1;\n          if (isUndefined(touch.tiltX)) touch.tiltX = 0;\n          if (isUndefined(touch.tiltY)) touch.tiltY = 0;\n          if (isUndefined(touch.pointerType)) touch.pointerType = 'touch';\n          // @see https://developer.mozilla.org/zh-CN/docs/Web/API/Touch/identifier\n          if (isUndefined(touch.pointerId)) touch.pointerId = touch.identifier || 0;\n          if (isUndefined(touch.pressure)) touch.pressure = touch.force || 0.5;\n          if (isUndefined(touch.twist)) touch.twist = 0;\n          if (isUndefined(touch.tangentialPressure)) touch.tangentialPressure = 0;\n          touch.isNormalized = true;\n          touch.type = event.type;\n          normalizedEvents.push(touch);\n        }\n      } else if (canvas.isMouseEvent(event)) {\n        var tempEvent = event;\n        if (isUndefined(tempEvent.isPrimary)) tempEvent.isPrimary = true;\n        if (isUndefined(tempEvent.width)) tempEvent.width = 1;\n        if (isUndefined(tempEvent.height)) tempEvent.height = 1;\n        if (isUndefined(tempEvent.tiltX)) tempEvent.tiltX = 0;\n        if (isUndefined(tempEvent.tiltY)) tempEvent.tiltY = 0;\n        if (isUndefined(tempEvent.pointerType)) tempEvent.pointerType = 'mouse';\n        if (isUndefined(tempEvent.pointerId)) tempEvent.pointerId = MOUSE_POINTER_ID;\n        if (isUndefined(tempEvent.pressure)) tempEvent.pressure = 0.5;\n        if (isUndefined(tempEvent.twist)) tempEvent.twist = 0;\n        if (isUndefined(tempEvent.tangentialPressure)) tempEvent.tangentialPressure = 0;\n        tempEvent.isNormalized = true;\n        normalizedEvents.push(tempEvent);\n      } else {\n        normalizedEvents.push(event);\n      }\n      return normalizedEvents;\n    }\n  }]);\n}();\nEventPlugin.tag = 'Event';\n\n// group is not a 2d shape\nvar shape2D = [Shape.CIRCLE, Shape.ELLIPSE, Shape.IMAGE, Shape.RECT, Shape.LINE, Shape.POLYLINE, Shape.POLYGON, Shape.TEXT, Shape.PATH, Shape.HTML];\nvar FrustumCullingStrategy = /*#__PURE__*/function () {\n  function FrustumCullingStrategy() {\n    _classCallCheck(this, FrustumCullingStrategy);\n  }\n  return _createClass(FrustumCullingStrategy, [{\n    key: \"isVisible\",\n    value: function isVisible(camera, object) {\n      var _object$parentNode;\n      // return true;\n\n      var cullable = object.cullable;\n      if (!cullable.enable) {\n        return true;\n      }\n      var renderBounds = object.getRenderBounds();\n      if (AABB.isEmpty(renderBounds)) {\n        return false;\n      }\n\n      // get VP matrix from camera\n      var frustum = camera.getFrustum();\n      var parentVisibilityPlaneMask = (_object$parentNode = object.parentNode) === null || _object$parentNode === void 0 || (_object$parentNode = _object$parentNode.cullable) === null || _object$parentNode === void 0 ? void 0 : _object$parentNode.visibilityPlaneMask;\n      cullable.visibilityPlaneMask = this.computeVisibilityWithPlaneMask(object, renderBounds, parentVisibilityPlaneMask || Mask.INDETERMINATE, frustum.planes);\n      cullable.visible = cullable.visibilityPlaneMask !== Mask.OUTSIDE;\n      return cullable.visible;\n    }\n\n    /**\n     *\n     * @see「Optimized View Frustum Culling Algorithms for Bounding Boxes」\n     * @see https://github.com/antvis/GWebGPUEngine/issues/3\n     *\n     * * 基础相交测试 the basic intersection test\n     * * 标记 masking @see https://cesium.com/blog/2015/08/04/fast-hierarchical-culling/\n     * * TODO: 平面一致性测试 the plane-coherency test\n     * * TODO: 支持 mesh 指定自身的剔除策略，参考 Babylon.js @see https://doc.babylonjs.com/how_to/optimizing_your_scene#changing-mesh-culling-strategy\n     *\n     * @param aabb aabb\n     * @param parentPlaneMask mask of parent\n     * @param planes planes of frustum\n     */\n  }, {\n    key: \"computeVisibilityWithPlaneMask\",\n    value: function computeVisibilityWithPlaneMask(object, aabb, parentPlaneMask, planes) {\n      if (parentPlaneMask === Mask.OUTSIDE || parentPlaneMask === Mask.INSIDE) {\n        // 父节点完全位于视锥内或者外部，直接返回\n        return parentPlaneMask;\n      }\n\n      // Start with MASK_INSIDE (all zeros) so that after the loop, the return value can be compared with MASK_INSIDE.\n      // (Because if there are fewer than 31 planes, the upper bits wont be changed.)\n      var mask = Mask.INSIDE;\n      var isShape2D = shape2D.indexOf(object.nodeName) > -1;\n\n      // Use viewport culling for 2D shapes\n      // @see https://github.com/antvis/g/issues/914\n      for (var k = 0, len = planes.length; k < len; ++k) {\n        // For k greater than 31 (since 31 is the maximum number of INSIDE/INTERSECTING bits we can store), skip the optimization.\n        var flag = 1 << k;\n        if ((parentPlaneMask & flag) === 0) {\n          // 父节点处于当前面内部，可以跳过\n          continue;\n        }\n\n        // skip near & far planes when testing 2D shapes\n        if (isShape2D && (k === 4 || k === 5)) {\n          continue;\n        }\n\n        // p-vertex n-vertex <-|plane p-vertex n-vertex\n        // 使用 p-vertex 和 n-vertex 加速，避免进行平面和 aabb 全部顶点的相交检测\n        var _planes$k = planes[k],\n          normal = _planes$k.normal,\n          distance = _planes$k.distance;\n        if (vec3.dot(normal, aabb.getPositiveFarPoint(planes[k])) + distance < 0) {\n          return Mask.OUTSIDE;\n        }\n        if (vec3.dot(normal, aabb.getNegativeFarPoint(planes[k])) + distance < 0) {\n          // 和当前面相交，对应位置为1，继续检测下一个面\n          mask |= flag;\n        }\n      }\n      return mask;\n    }\n  }]);\n}();\n\nvar PrepareRendererPlugin = /*#__PURE__*/function () {\n  function PrepareRendererPlugin() {\n    _classCallCheck(this, PrepareRendererPlugin);\n    this.syncTasks = new Map();\n    this.isFirstTimeRendering = true;\n    this.syncing = false;\n    this.isFirstTimeRenderingFinished = false;\n  }\n  return _createClass(PrepareRendererPlugin, [{\n    key: \"apply\",\n    value: function apply(context) {\n      var _this = this,\n        _runtime$globalThis$r;\n      var renderingService = context.renderingService,\n        renderingContext = context.renderingContext,\n        rBushRoot = context.rBushRoot;\n      var canvas = renderingContext.root.ownerDocument.defaultView;\n      this.rBush = rBushRoot;\n      var handleAttributeChanged = function handleAttributeChanged(e) {\n        var object = e.target;\n        object.renderable.dirty = true;\n        renderingService.dirtify();\n      };\n      var handleBoundsChanged = function handleBoundsChanged(e) {\n        _this.syncTasks.set(e.target, e.detail.affectChildren);\n        renderingService.dirtify();\n      };\n      var handleMounted = function handleMounted(e) {\n        var object = e.target;\n        if (runtime.enableSizeAttenuation) {\n          runtime.styleValueRegistry.updateSizeAttenuation(object, canvas.getCamera().getZoom());\n        }\n      };\n      var handleUnmounted = function handleUnmounted(e) {\n        var object = e.target;\n        var rBushNode = object.rBushNode;\n        if (rBushNode.aabb) {\n          _this.rBush.remove(rBushNode.aabb);\n        }\n        _this.syncTasks[\"delete\"](object);\n        runtime.sceneGraphService.dirtifyToRoot(object);\n        renderingService.dirtify();\n      };\n      renderingService.hooks.init.tap(PrepareRendererPlugin.tag, function () {\n        canvas.addEventListener(ElementEvent.MOUNTED, handleMounted);\n        canvas.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n        canvas.addEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n        canvas.addEventListener(ElementEvent.BOUNDS_CHANGED, handleBoundsChanged);\n      });\n      renderingService.hooks.destroy.tap(PrepareRendererPlugin.tag, function () {\n        canvas.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n        canvas.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n        canvas.removeEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n        canvas.removeEventListener(ElementEvent.BOUNDS_CHANGED, handleBoundsChanged);\n        _this.syncTasks.clear();\n      });\n      var ric = (_runtime$globalThis$r = runtime.globalThis.requestIdleCallback) !== null && _runtime$globalThis$r !== void 0 ? _runtime$globalThis$r : raf.bind(runtime.globalThis);\n      renderingService.hooks.endFrame.tap(PrepareRendererPlugin.tag, function () {\n        if (_this.isFirstTimeRendering) {\n          _this.isFirstTimeRendering = false;\n          _this.syncing = true;\n          ric(function () {\n            _this.syncRTree(true);\n            _this.isFirstTimeRenderingFinished = true;\n          });\n        } else {\n          _this.syncRTree();\n        }\n      });\n    }\n  }, {\n    key: \"syncNode\",\n    value: function syncNode(node) {\n      var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      if (!node.isConnected) return;\n      var rBushNode = node.rBushNode;\n\n      // clear dirty node\n      if (rBushNode.aabb) this.rBush.remove(rBushNode.aabb);\n      var renderBounds = node.getRenderBounds();\n      if (renderBounds) {\n        var renderable = node.renderable;\n        if (force) {\n          if (!renderable.dirtyRenderBounds) {\n            renderable.dirtyRenderBounds = new AABB();\n          }\n          // save last dirty aabb\n          renderable.dirtyRenderBounds.update(renderBounds.center, renderBounds.halfExtents);\n        }\n        var _renderBounds$getMin = renderBounds.getMin(),\n          _renderBounds$getMin2 = _slicedToArray(_renderBounds$getMin, 2),\n          minX = _renderBounds$getMin2[0],\n          minY = _renderBounds$getMin2[1];\n        var _renderBounds$getMax = renderBounds.getMax(),\n          _renderBounds$getMax2 = _slicedToArray(_renderBounds$getMax, 2),\n          maxX = _renderBounds$getMax2[0],\n          maxY = _renderBounds$getMax2[1];\n        if (!rBushNode.aabb) {\n          rBushNode.aabb = {};\n        }\n        rBushNode.aabb.displayObject = node;\n        rBushNode.aabb.minX = minX;\n        rBushNode.aabb.minY = minY;\n        rBushNode.aabb.maxX = maxX;\n        rBushNode.aabb.maxY = maxY;\n      }\n      if (rBushNode.aabb) {\n        // TODO: NaN occurs when width/height of Rect is 0\n        if (!isNaN(rBushNode.aabb.maxX) && !isNaN(rBushNode.aabb.maxX) && !isNaN(rBushNode.aabb.minX) && !isNaN(rBushNode.aabb.minY)) {\n          return rBushNode.aabb;\n        }\n      }\n    }\n  }, {\n    key: \"syncRTree\",\n    value: function syncRTree() {\n      var _this2 = this;\n      var force = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      if (!force && (this.syncing || this.syncTasks.size === 0)) {\n        return;\n      }\n      this.syncing = true;\n\n      // bounds changed, need re-inserting its children\n      var bulk = [];\n      var synced = new Set();\n      var sync = function sync(node) {\n        if (!synced.has(node) && node.renderable) {\n          var aabb = _this2.syncNode(node, force);\n          if (aabb) {\n            bulk.push(aabb);\n            synced.add(node);\n          }\n        }\n      };\n      this.syncTasks.forEach(function (affectChildren, node) {\n        if (affectChildren) {\n          node.forEach(sync);\n        }\n        var parent = node;\n        while (parent) {\n          sync(parent);\n          parent = parent.parentElement;\n        }\n      });\n\n      // use bulk inserting, which is ~2-3 times faster\n      // @see https://github.com/mourner/rbush#bulk-inserting-data\n      this.rBush.load(bulk);\n      bulk.length = 0;\n      this.syncing = false;\n    }\n  }]);\n}();\nPrepareRendererPlugin.tag = 'Prepare';\n\nfunction isCanvas(value) {\n  return !!value.document;\n}\nvar CanvasEvent = /*#__PURE__*/function (CanvasEvent) {\n  CanvasEvent[\"READY\"] = \"ready\";\n  CanvasEvent[\"BEFORE_RENDER\"] = \"beforerender\";\n  CanvasEvent[\"RERENDER\"] = \"rerender\";\n  CanvasEvent[\"AFTER_RENDER\"] = \"afterrender\";\n  CanvasEvent[\"BEFORE_DESTROY\"] = \"beforedestroy\";\n  CanvasEvent[\"AFTER_DESTROY\"] = \"afterdestroy\";\n  CanvasEvent[\"RESIZE\"] = \"resize\";\n  CanvasEvent[\"DIRTY_RECTANGLE\"] = \"dirtyrectangle\";\n  CanvasEvent[\"RENDERER_CHANGED\"] = \"rendererchanged\";\n  return CanvasEvent;\n}({});\nvar DEFAULT_CAMERA_Z = 500;\nvar DEFAULT_CAMERA_NEAR = 0.1;\nvar DEFAULT_CAMERA_FAR = 1000;\n\n/**\n * reuse custom event preventing from re-create them in every frame\n */\nvar mountedEvent = new CustomEvent(ElementEvent.MOUNTED);\nvar unmountedEvent = new CustomEvent(ElementEvent.UNMOUNTED);\nvar beforeRenderEvent = new CustomEvent(CanvasEvent.BEFORE_RENDER);\nvar rerenderEvent = new CustomEvent(CanvasEvent.RERENDER);\nvar afterRenderEvent = new CustomEvent(CanvasEvent.AFTER_RENDER);\n\n/**\n * can be treated like Window in DOM\n * provide some extra methods like `window`, such as:\n * * `window.requestAnimationFrame`\n * * `window.devicePixelRatio`\n *\n * prototype chains: Canvas(Window) -> EventTarget\n */\nvar Canvas = /*#__PURE__*/function (_EventTarget) {\n  function Canvas(config) {\n    var _this;\n    _classCallCheck(this, Canvas);\n    _this = _callSuper(this, Canvas);\n\n    // create document\n    /**\n     * window.document\n     */\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/CustomElementRegistry\n     */\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame\n     */\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Window/cancelAnimationFrame\n     */\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Window/devicePixelRatio\n     */\n    /**\n     * whether the runtime supports PointerEvent?\n     * if not, the event system won't trigger pointer events like `pointerdown`\n     */\n    /**\n     * whether the runtime supports TouchEvent?\n     * if not, the event system won't trigger touch events like `touchstart`\n     */\n    /**\n     * is this native event a TouchEvent?\n     */\n    /**\n     * is this native event a MouseEvent?\n     */\n    /**\n     * double click speed (ms), default is 200ms\n     */\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element\n     */\n    _this.Element = DisplayObject;\n    _this.inited = false;\n    _this.context = {};\n    _this.document = new Document();\n    _this.document.defaultView = _this;\n\n    // create registry of custom elements\n    _this.customElements = new CustomElementRegistry();\n    var container = config.container,\n      canvas = config.canvas,\n      offscreenCanvas = config.offscreenCanvas,\n      width = config.width,\n      height = config.height,\n      devicePixelRatio = config.devicePixelRatio,\n      renderer = config.renderer,\n      background = config.background,\n      cursor = config.cursor,\n      document = config.document,\n      requestAnimationFrame = config.requestAnimationFrame,\n      cancelAnimationFrame = config.cancelAnimationFrame,\n      createImage = config.createImage,\n      enableLargeImageOptimization = config.enableLargeImageOptimization,\n      supportsPointerEvents = config.supportsPointerEvents,\n      supportsTouchEvents = config.supportsTouchEvents,\n      supportsCSSTransform = config.supportsCSSTransform,\n      _config$cleanUpOnDest = config.cleanUpOnDestroy,\n      cleanUpOnDestroy = _config$cleanUpOnDest === void 0 ? true : _config$cleanUpOnDest,\n      supportsMutipleCanvasesInOneContainer = config.supportsMutipleCanvasesInOneContainer,\n      useNativeClickEvent = config.useNativeClickEvent,\n      alwaysTriggerPointerEventOnCanvas = config.alwaysTriggerPointerEventOnCanvas,\n      isTouchEvent = config.isTouchEvent,\n      isMouseEvent = config.isMouseEvent,\n      dblClickSpeed = config.dblClickSpeed;\n    if (!supportsMutipleCanvasesInOneContainer) {\n      cleanExistedCanvas(container, _this, cleanUpOnDestroy);\n    }\n    var canvasWidth = width;\n    var canvasHeight = height;\n    var dpr = devicePixelRatio;\n    // use user-defined <canvas> or OffscreenCanvas\n    if (canvas) {\n      // infer width & height with dpr\n      dpr = devicePixelRatio || isBrowser && window.devicePixelRatio || 1;\n      dpr = dpr >= 1 ? Math.ceil(dpr) : 1;\n      canvasWidth = width || getWidth(canvas) || canvas.width / dpr;\n      canvasHeight = height || getHeight(canvas) || canvas.height / dpr;\n    }\n\n    // override it in runtime\n    if (offscreenCanvas) {\n      runtime.offscreenCanvas = offscreenCanvas;\n    }\n\n    /**\n     * implements `Window` interface\n     */\n    _this.devicePixelRatio = dpr;\n    _this.requestAnimationFrame = requestAnimationFrame !== null && requestAnimationFrame !== void 0 ? requestAnimationFrame : raf.bind(runtime.globalThis);\n    _this.cancelAnimationFrame = cancelAnimationFrame !== null && cancelAnimationFrame !== void 0 ? cancelAnimationFrame : caf.bind(runtime.globalThis);\n\n    /**\n     * limits query\n     */\n    // the following feature-detect from hammer.js\n    // @see https://github.com/hammerjs/hammer.js/blob/master/src/inputjs/input-consts.js#L5\n    _this.supportsTouchEvents = supportsTouchEvents !== null && supportsTouchEvents !== void 0 ? supportsTouchEvents : 'ontouchstart' in runtime.globalThis;\n    _this.supportsPointerEvents = supportsPointerEvents !== null && supportsPointerEvents !== void 0 ? supportsPointerEvents : !!runtime.globalThis.PointerEvent;\n    _this.isTouchEvent = isTouchEvent !== null && isTouchEvent !== void 0 ? isTouchEvent : function (event) {\n      return _this.supportsTouchEvents && event instanceof runtime.globalThis.TouchEvent;\n    };\n    _this.isMouseEvent = isMouseEvent !== null && isMouseEvent !== void 0 ? isMouseEvent : function (event) {\n      return !runtime.globalThis.MouseEvent || event instanceof runtime.globalThis.MouseEvent && (!_this.supportsPointerEvents || !(event instanceof runtime.globalThis.PointerEvent));\n    };\n    _this.dblClickSpeed = dblClickSpeed !== null && dblClickSpeed !== void 0 ? dblClickSpeed : 200;\n    _this.initRenderingContext({\n      container: container,\n      canvas: canvas,\n      width: canvasWidth,\n      height: canvasHeight,\n      renderer: renderer,\n      offscreenCanvas: offscreenCanvas,\n      devicePixelRatio: dpr,\n      cursor: cursor || 'default',\n      background: background || 'transparent',\n      createImage: createImage,\n      enableLargeImageOptimization: enableLargeImageOptimization,\n      document: document,\n      supportsCSSTransform: supportsCSSTransform,\n      useNativeClickEvent: useNativeClickEvent,\n      cleanUpOnDestroy: cleanUpOnDestroy,\n      alwaysTriggerPointerEventOnCanvas: alwaysTriggerPointerEventOnCanvas\n    });\n    _this.initDefaultCamera(canvasWidth, canvasHeight, renderer.clipSpaceNearZ);\n    _this.initRenderer(renderer, true);\n    return _this;\n  }\n  _inherits(Canvas, _EventTarget);\n  return _createClass(Canvas, [{\n    key: \"initRenderingContext\",\n    value: function initRenderingContext(mergedConfig) {\n      this.context.config = mergedConfig;\n\n      // bind rendering context, shared by all renderers\n      this.context.renderingContext = {\n        /**\n         * the root node in scene graph\n         */\n        root: this.document.documentElement,\n        renderListCurrentFrame: [],\n        unculledEntities: [],\n        renderReasons: new Set(),\n        force: false,\n        dirty: false\n      };\n    }\n  }, {\n    key: \"initDefaultCamera\",\n    value: function initDefaultCamera(width, height, clipSpaceNearZ) {\n      var _this2 = this;\n      // set a default ortho camera\n      var camera = new runtime.CameraContribution();\n      camera.clipSpaceNearZ = clipSpaceNearZ;\n      camera.setType(CameraType.EXPLORING, CameraTrackingMode.DEFAULT).setPosition(width / 2, height / 2, DEFAULT_CAMERA_Z).setFocalPoint(width / 2, height / 2, 0).setOrthographic(width / -2, width / 2, height / 2, height / -2, DEFAULT_CAMERA_NEAR, DEFAULT_CAMERA_FAR);\n\n      // keep ref since it will use raf in camera animation\n      camera.canvas = this;\n\n      // redraw when camera changed\n      camera.eventEmitter.on(CameraEvent.UPDATED, function () {\n        _this2.context.renderingContext.renderReasons.add(RenderReason.CAMERA_CHANGED);\n        if (runtime.enableSizeAttenuation && _this2.getConfig().renderer.getConfig().enableSizeAttenuation) {\n          _this2.updateSizeAttenuation();\n        }\n      });\n\n      // bind camera\n      this.context.camera = camera;\n    }\n  }, {\n    key: \"updateSizeAttenuation\",\n    value: function updateSizeAttenuation() {\n      var zoom = this.getCamera().getZoom();\n      this.document.documentElement.forEach(function (node) {\n        runtime.styleValueRegistry.updateSizeAttenuation(node, zoom);\n      });\n    }\n  }, {\n    key: \"getConfig\",\n    value: function getConfig() {\n      return this.context.config;\n    }\n\n    /**\n     * get the root displayObject in scenegraph\n     * @alias this.document.documentElement\n     */\n  }, {\n    key: \"getRoot\",\n    value: function getRoot() {\n      return this.document.documentElement;\n    }\n\n    /**\n     * get the camera of canvas\n     */\n  }, {\n    key: \"getCamera\",\n    value: function getCamera() {\n      return this.context.camera;\n    }\n  }, {\n    key: \"getContextService\",\n    value: function getContextService() {\n      return this.context.contextService;\n    }\n  }, {\n    key: \"getEventService\",\n    value: function getEventService() {\n      return this.context.eventService;\n    }\n  }, {\n    key: \"getRenderingService\",\n    value: function getRenderingService() {\n      return this.context.renderingService;\n    }\n  }, {\n    key: \"getRenderingContext\",\n    value: function getRenderingContext() {\n      return this.context.renderingContext;\n    }\n  }, {\n    key: \"getStats\",\n    value: function getStats() {\n      return this.getRenderingService().getStats();\n    }\n\n    // /**\n    //  * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Window/getComputedStyle\n    //  */\n    // getComputedStyle(node: DisplayObject) {\n    //   return node.computedStyle;\n    // }\n  }, {\n    key: \"ready\",\n    get: function get() {\n      var _this3 = this;\n      if (!this.readyPromise) {\n        this.readyPromise = new Promise(function (resolve) {\n          _this3.resolveReadyPromise = function () {\n            resolve(_this3);\n          };\n        });\n        if (this.inited) {\n          this.resolveReadyPromise();\n        }\n      }\n      return this.readyPromise;\n    }\n\n    /**\n     * `cleanUp` means clean all the internal services of Canvas which happens when calling `canvas.destroy()`.\n     */\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var cleanUp = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      var skipTriggerEvent = arguments.length > 1 ? arguments[1] : undefined;\n      if (skipTriggerEvent === undefined) skipTriggerEvent = this.getConfig().fastCleanExistingCanvas;\n      if (!skipTriggerEvent) {\n        this.dispatchEvent(new CustomEvent(CanvasEvent.BEFORE_DESTROY));\n      }\n      if (this.frameId) {\n        var cancelRAF = this.getConfig().cancelAnimationFrame || cancelAnimationFrame;\n        cancelRAF(this.frameId);\n      }\n\n      // unmount all children\n      var root = this.getRoot();\n      this.unmountChildren(root);\n      if (cleanUp) {\n        // destroy Document\n        this.document.destroy();\n        this.getEventService().destroy();\n      }\n\n      // destroy services\n      this.getRenderingService().destroy();\n      this.getContextService().destroy();\n\n      // clear root after renderservice destroyed\n      if (cleanUp && this.context.rBushRoot) {\n        // clear rbush\n        this.context.rBushRoot.clear();\n        this.context.rBushRoot = null;\n        this.context.renderingContext.root = null;\n      }\n      if (!skipTriggerEvent) {\n        this.dispatchEvent(new CustomEvent(CanvasEvent.AFTER_DESTROY));\n      }\n      var clearEventRetain = function clearEventRetain(event) {\n        event.currentTarget = null;\n        event.manager = null;\n        event.target = null;\n      };\n      clearEventRetain(mountedEvent);\n      clearEventRetain(unmountedEvent);\n      clearEventRetain(beforeRenderEvent);\n      clearEventRetain(rerenderEvent);\n      clearEventRetain(afterRenderEvent);\n      this.cancelAnimationFrame(this.frameId);\n    }\n\n    /**\n     * compatible with G 3.0\n     * @deprecated\n     * @alias resize\n     */\n  }, {\n    key: \"changeSize\",\n    value: function changeSize(width, height) {\n      this.resize(width, height);\n    }\n  }, {\n    key: \"resize\",\n    value: function resize(width, height) {\n      // update canvas' config\n      var canvasConfig = this.context.config;\n      canvasConfig.width = width;\n      canvasConfig.height = height;\n\n      // resize context\n      this.getContextService().resize(width, height);\n\n      // resize camera\n      var camera = this.context.camera;\n      var projectionMode = camera.getProjectionMode();\n      camera.setPosition(width / 2, height / 2, DEFAULT_CAMERA_Z).setFocalPoint(width / 2, height / 2, 0);\n      if (projectionMode === CameraProjectionMode.ORTHOGRAPHIC) {\n        camera.setOrthographic(width / -2, width / 2, height / 2, height / -2, camera.getNear(), camera.getFar());\n      } else {\n        camera.setAspect(width / height);\n      }\n      this.dispatchEvent(new CustomEvent(CanvasEvent.RESIZE, {\n        width: width,\n        height: height\n      }));\n    }\n\n    // proxy to document.documentElement\n  }, {\n    key: \"appendChild\",\n    value: function appendChild(child, index) {\n      return this.document.documentElement.appendChild(child, index);\n    }\n  }, {\n    key: \"insertBefore\",\n    value: function insertBefore(newChild, refChild) {\n      return this.document.documentElement.insertBefore(newChild, refChild);\n    }\n  }, {\n    key: \"removeChild\",\n    value: function removeChild(child) {\n      return this.document.documentElement.removeChild(child);\n    }\n\n    /**\n     * Remove all children which can be appended to its original parent later again.\n     */\n  }, {\n    key: \"removeChildren\",\n    value: function removeChildren() {\n      this.document.documentElement.removeChildren();\n    }\n\n    /**\n     * Recursively destroy all children which can not be appended to its original parent later again.\n     * But the canvas remains running which means display objects can be appended later.\n     */\n  }, {\n    key: \"destroyChildren\",\n    value: function destroyChildren() {\n      this.document.documentElement.destroyChildren();\n    }\n  }, {\n    key: \"render\",\n    value: function render(frame) {\n      var _this4 = this;\n      if (frame) {\n        beforeRenderEvent.detail = frame;\n        afterRenderEvent.detail = frame;\n      }\n      this.dispatchEvent(beforeRenderEvent);\n      var renderingService = this.getRenderingService();\n      renderingService.render(this.getConfig(), frame, function () {\n        // trigger actual rerender event\n        // @see https://github.com/antvis/G/issues/1268\n        _this4.dispatchEvent(rerenderEvent);\n      });\n      this.dispatchEvent(afterRenderEvent);\n    }\n  }, {\n    key: \"run\",\n    value: function run() {\n      var _this5 = this;\n      var _tick = function tick(time, frame) {\n        _this5.render(frame);\n        _this5.frameId = _this5.requestAnimationFrame(_tick);\n      };\n      _tick();\n    }\n  }, {\n    key: \"initRenderer\",\n    value: function initRenderer(renderer) {\n      var _this6 = this;\n      var firstContentfullPaint = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      if (!renderer) {\n        throw new Error('Renderer is required.');\n      }\n\n      // reset\n      this.inited = false;\n      this.readyPromise = undefined;\n\n      // FIXME: should re-create here?\n      this.context.rBushRoot = new RBush();\n\n      // reset rendering plugins\n      this.context.renderingPlugins = [];\n      this.context.renderingPlugins.push(new EventPlugin(), new PrepareRendererPlugin(),\n      // new DirtyCheckPlugin(),\n      new CullingPlugin([new FrustumCullingStrategy()]));\n\n      //\n      this.loadRendererContainerModule(renderer);\n\n      // init context service\n      this.context.contextService = new this.context.ContextService(_objectSpread(_objectSpread({}, runtime), this.context));\n\n      // init rendering service\n      this.context.renderingService = new RenderingService(runtime, this.context);\n\n      // init event service\n      this.context.eventService = new EventService(runtime, this.context);\n      this.context.eventService.init();\n      if (this.context.contextService.init) {\n        this.context.contextService.init();\n        this.initRenderingService(renderer, firstContentfullPaint, true);\n      } else {\n        this.context.contextService.initAsync().then(function () {\n          _this6.initRenderingService(renderer, firstContentfullPaint);\n        });\n      }\n    }\n  }, {\n    key: \"initRenderingService\",\n    value: function initRenderingService(renderer) {\n      var _this7 = this;\n      var firstContentfullPaint = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var async = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      this.context.renderingService.init(function () {\n        _this7.inited = true;\n        if (firstContentfullPaint) {\n          if (async) {\n            _this7.requestAnimationFrame(function () {\n              _this7.dispatchEvent(new CustomEvent(CanvasEvent.READY));\n            });\n          } else {\n            _this7.dispatchEvent(new CustomEvent(CanvasEvent.READY));\n          }\n        } else {\n          _this7.dispatchEvent(new CustomEvent(CanvasEvent.RENDERER_CHANGED));\n        }\n        if (_this7.readyPromise) {\n          _this7.resolveReadyPromise();\n        }\n        if (!firstContentfullPaint) {\n          _this7.getRoot().forEach(function (node) {\n            var _ref = node,\n              renderable = _ref.renderable;\n            if (renderable) {\n              renderable.renderBoundsDirty = true;\n              renderable.boundsDirty = true;\n              renderable.dirty = true;\n            }\n          });\n        }\n\n        // keep current scenegraph unchanged, just trigger mounted event\n        _this7.mountChildren(_this7.getRoot());\n        if (renderer.getConfig().enableAutoRendering) {\n          _this7.run();\n        }\n      });\n    }\n  }, {\n    key: \"loadRendererContainerModule\",\n    value: function loadRendererContainerModule(renderer) {\n      var _this8 = this;\n      // load other container modules provided by g-canvas/g-svg/g-webgl\n      var plugins = renderer.getPlugins();\n      plugins.forEach(function (plugin) {\n        plugin.context = _this8.context;\n        plugin.init(runtime);\n      });\n    }\n  }, {\n    key: \"setRenderer\",\n    value: function setRenderer(renderer) {\n      // update canvas' config\n      var canvasConfig = this.getConfig();\n      if (canvasConfig.renderer === renderer) {\n        return;\n      }\n      var oldRenderer = canvasConfig.renderer;\n      canvasConfig.renderer = renderer;\n\n      // keep all children undestroyed\n      this.destroy(false, true);\n\n      // destroy all plugins, reverse will mutate origin array\n      _toConsumableArray((oldRenderer === null || oldRenderer === void 0 ? void 0 : oldRenderer.getPlugins()) || []).reverse().forEach(function (plugin) {\n        plugin.destroy(runtime);\n      });\n      this.initRenderer(renderer);\n    }\n  }, {\n    key: \"setCursor\",\n    value: function setCursor(cursor) {\n      var canvasConfig = this.getConfig();\n      canvasConfig.cursor = cursor;\n      this.getContextService().applyCursorStyle(cursor);\n    }\n  }, {\n    key: \"unmountChildren\",\n    value: function unmountChildren(parent) {\n      var _this9 = this;\n      // unmountChildren recursively\n      parent.childNodes.forEach(function (child) {\n        _this9.unmountChildren(child);\n      });\n      if (this.inited) {\n        if (parent.isMutationObserved) {\n          parent.dispatchEvent(unmountedEvent);\n        } else {\n          unmountedEvent.target = parent;\n          this.dispatchEvent(unmountedEvent, true);\n        }\n\n        // skip document.documentElement\n        if (parent !== this.document.documentElement) {\n          parent.ownerDocument = null;\n        }\n        parent.isConnected = false;\n      }\n\n      // trigger after unmounted\n      if (parent.isCustomElement) {\n        if (parent.disconnectedCallback) {\n          parent.disconnectedCallback();\n        }\n      }\n    }\n  }, {\n    key: \"mountChildren\",\n    value: function mountChildren(child) {\n      var _this10 = this;\n      var skipTriggerEvent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : isInFragment(child);\n      if (this.inited) {\n        if (!child.isConnected) {\n          child.ownerDocument = this.document;\n          child.isConnected = true;\n          if (!skipTriggerEvent) {\n            if (child.isMutationObserved) {\n              child.dispatchEvent(mountedEvent);\n            } else {\n              mountedEvent.target = child;\n              this.dispatchEvent(mountedEvent, true);\n            }\n          }\n        }\n      } else {\n        console.warn(\"[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.\", 'appended child: ', child.nodeName);\n      }\n\n      // recursively mount children\n      child.childNodes.forEach(function (c) {\n        _this10.mountChildren(c, skipTriggerEvent);\n      });\n\n      // trigger after mounted\n      if (child.isCustomElement) {\n        if (child.connectedCallback) {\n          child.connectedCallback();\n        }\n      }\n    }\n  }, {\n    key: \"mountFragment\",\n    value: function mountFragment(child) {\n      this.mountChildren(child, false);\n    }\n  }, {\n    key: \"client2Viewport\",\n    value: function client2Viewport(client) {\n      return this.getEventService().client2Viewport(client);\n    }\n  }, {\n    key: \"viewport2Client\",\n    value: function viewport2Client(canvas) {\n      return this.getEventService().viewport2Client(canvas);\n    }\n  }, {\n    key: \"viewport2Canvas\",\n    value: function viewport2Canvas(viewport) {\n      return this.getEventService().viewport2Canvas(viewport);\n    }\n  }, {\n    key: \"canvas2Viewport\",\n    value: function canvas2Viewport(canvas) {\n      return this.getEventService().canvas2Viewport(canvas);\n    }\n\n    /**\n     * @deprecated\n     * @alias client2Viewport\n     */\n  }, {\n    key: \"getPointByClient\",\n    value: function getPointByClient(clientX, clientY) {\n      return this.client2Viewport({\n        x: clientX,\n        y: clientY\n      });\n    }\n\n    /**\n     * @deprecated\n     * @alias viewport2Client\n     */\n  }, {\n    key: \"getClientByPoint\",\n    value: function getClientByPoint(x, y) {\n      return this.viewport2Client({\n        x: x,\n        y: y\n      });\n    }\n  }]);\n}(EventTarget);\n\nexport { AABB, AbstractRenderer, AbstractRendererPlugin, BUILT_IN_PROPERTIES, CSS, CSSGradientValue, CSSKeywordValue, CSSRGB, CSSStyleValue, CSSUnitValue, Camera, CameraEvent, CameraProjectionMode, CameraTrackingMode, CameraType, Canvas, CanvasEvent, Circle, CircleUpdater, ClipSpaceNearZ, CustomElement, CustomElementRegistry, CustomEvent, DefaultSceneGraphSelector, DefaultSceneGraphService, DisplayObject, Document, ERROR_MSG_METHOD_NOT_IMPLEMENTED, Element, ElementEvent, Ellipse, EllipseUpdater, EventService, EventTarget, FederatedEvent, FederatedMouseEvent, FederatedPointerEvent, FederatedWheelEvent, Fragment, Frustum, GradientType, Group, GroupUpdater, HTML, HTMLUpdater, Image, Line, LineUpdater, Mask, MutationEvent, Node, OffscreenCanvasCreator, Path, PathUpdater, Plane, Point, Polygon, Polyline, PolylineUpdater, PropertySyntax, RBush, Rect, RectUpdater, Rectangle, RenderReason, RenderingService, Shape, SortReason, Strategy, Text, TextService, TextUpdater, UnitType, computeLinearGradient, computeRadialGradient, convertToPath, createVec3, decompose, definedProps, deg2rad, deg2turn, findClosestClipPathTarget, fromRotationTranslationScale, getAngle, getEuler, getOrCalculatePathTotalLength, grad2deg, isBrowser, isCSSGradientValue, isCSSRGB, isCanvas, isDisplayObject, isFederatedEvent, isFillOrStrokeAffected, isPattern, mergeColors, parseColor, parseLength, parsePath, parseTransform, parsedTransformToMat4, propertyMetadataCache, rad2deg, resetEntityCounter, runtime, setDOMSize, translatePathToString, turn2deg };\n//# sourceMappingURL=index.esm.js.map\n"],"names":["rbush","globalThis","window","g","self","exports","quickselect","arr","k","left","right","compare","quickselectStep","length","defaultCompare","n","m","z","Math","log","s","exp","sd","sqrt","max","floor","min","t","i","j","swap","tmp","a","b","RBush","maxEntries","this","_maxEntries","_minEntries","ceil","clear","findItem","item","items","equalsFn","indexOf","calcBBox","node","toBBox","distBBox","children","p","destNode","createNode","minX","Infinity","minY","maxX","maxY","child","extend","leaf","compareNodeMinX","compareNodeMinY","bboxArea","bboxMargin","enlargedArea","intersectionArea","contains","intersects","height","multiSelect","stack","pop","mid","push","prototype","all","_all","data","search","bbox","result","nodesToSearch","childBBox","collides","load","insert","_build","slice","_splitRoot","tmpNode","_insert","remove","parent","goingUp","path","indexes","index","splice","_condense","compareMinX","compareMinY","toJSON","fromJSON","apply","N","M","pow","N2","N1","right2","right3","_chooseSubtree","level","minArea","minEnlargement","targetNode","area","enlargement","isNode","insertPath","_split","_adjustParentBBoxes","_chooseSplitAxis","splitIndex","_chooseSplitIndex","newNode","minOverlap","bbox1","bbox2","overlap","_allDistMargin","sort","leftBBox","rightBBox","margin","i$1","child$1","siblings","factory","Shape","ClipSpaceNearZ","AbstractRendererPlugin","plugins","key","value","plugin","context","renderingPlugins","_this","forEach","AbstractRenderer","config","clipSpaceNearZ","NEGATIVE_ONE","enableDirtyCheck","enableCulling","enableAutoRendering","enableDirtyRectangleRendering","enableDirtyRectangleRenderingDebug","enableSizeAttenuation","findIndex","name","find","Object","assign","addVec3","copyVec3","maxVec3","minVec3","scaleVec3","subVec3","AABB","center","halfExtents","aabb","isEmpty","setMinMax","getMin","getMax","tc","tcx","tcy","tcz","th","thx","thy","thz","tminx","tmaxx","tminy","tmaxy","tminz","tmaxz","oc","ocx","ocy","ocz","oh","ohx","ohy","ohz","ominx","omaxx","ominy","omaxy","ominz","omaxz","bc","br","ac","ar","mx0","mx1","mx2","my0","my1","my2","mz0","mz1","mz2","mx0a","abs","mx1a","mx2a","my0a","my1a","my2a","mz0a","mz1a","mz2a","aMax","aMin","bMax","bMin","intersection","plane","pnVertexFlag","Plane","distance","normal","updatePNVertexFlag","Number","point","invLen","start","end","d0","distanceToPoint","Mask","Frustum","planes","projectionMatrix","_projectionMatrix","m0","m1","m2","m3","m4","m5","m6","m7","m8","m9","m10","m11","m12","m13","m14","m15","normalize","Point","x","arguments","undefined","y","Rectangle","width","top","bottom","rect","matrix","topLeft","topRight","bottomLeft","bottomRight","transformedTopLeft","transformedTopRight","transformedBottomLeft","transformedBottomRight","fromRect","ERROR_MSG_METHOD_NOT_IMPLEMENTED","ERROR_MSG_USE_DOCUMENT_ELEMENT","getAngle","angle","$vec3$2","createVec3","clone","Array","isArray","DEG_RAD","PI","deg2rad","deg","RAD_DEG","rad2deg","rad","HALF_PI","getEuler","out","quat","_mat4$getScaling","_mat4$getScaling2","sx","sy","sz","asin","atan2","getEulerFromMat4","w","y2","z2","w2","unit","test","getEulerFromQuat","decompose","mat","row0x","row0y","row1x","row1y","scalingX","scalingY","invScalingX","invScalingY","perspectiveMatrix","tmpVec4","row","pdum3","combine","scale1","scale2","CameraType","CameraTrackingMode","CameraProjectionMode","CameraEvent","MIN_DISTANCE","Camera","eventEmitter","up","forward","position","focalPoint","distanceVector","azimuth","elevation","roll","relAzimuth","relElevation","relRoll","dollyingStep","maxDistance","minDistance","zoom","rotateWorld","fov","near","far","aspect","projectionMatrixInverse","jitteredProjectionMatrix","enableUpdate","type","EXPLORING","trackingMode","DEFAULT","projectionMode","PERSPECTIVE","frustum","orthoMatrix","ORTHOGRAPHIC","view","enabled","setWorldRotation","_getAngles","TRACKING","setTrackingMode","Error","flag","translation","_update","setPerspective","setOrthographic","rright","fullWidth","fullHeight","offsetX","offsetY","viewportPoint","_this$canvas$viewport","canvas","viewport2Canvas","ox","oy","rotate","setPosition","setFocalPoint","setZoom","_this$canvas$viewport2","cx","cy","dvec","dx","dy","_this$getPosition","getPosition","_this$getPosition2","px","py","_this$getFocalPoint","getFocalPoint","_this$getFocalPoint2","fx","fy","_this$view","tan","c","d","twoNear","rightMinusLeft","topMinusBottom","farMinusNear","farMulNear","makePerspective","ZERO","triggerUpdate","l","r","_this$view2","scaleW","scaleH","_getOrthoMatrix","_setPosition","CINEMATIC","el","az","_getAxes","_getDistance","pos","f","computeMatrix","ORBITING","_getPosition","_getFocalPoint","rotZ","rotX","rotY","rotQ","rotMatrix","viewMatrix","getViewTransform","vpMatrix","getPerspective","getFrustum","extractFromVPMatrix","emit","tx","ty","params","options","Strategy","SortReason","EMPTY_PARSED_PATH","absolutePath","hasArc","segments","polygons","polylines","curve","totalLength","PropertySyntax","memoize","func","resolver","TypeError","_memoized","_len","args","_key","cache","has","get","set","Cache","Map","UnitType","UnitCategory","Nested","ParenLess","unit_type","kEms","kPixels","kDegrees","kRadians","kGradians","kMilliseconds","kSeconds","kRems","kTurns","CSSStyleValueType","unitFromName","kNumber","kPercentage","stringToUnitType","kUnknown","conversionToCanonicalUnitsScaleFactor","factor","unitTypeToString","kInteger","CSSStyleValue","buildCSSText","kNo","getType","kUnitType","kClampType","CSSColorValue","_CSSStyleValue","colorSpace","kColorType","GradientType","CSSGradientValue","CSSKeywordValue","kKeywordType","toCanonicalUnit","category","kUNumber","kULength","kUPercent","kUTime","kUAngle","canonicalUnitTypeForCategory","kUOther","unitTypeToUnitCategory","CSSUnitValue","unitOrName","other","other_unit_value","target_unit","canonical_unit","scale_factor","text","toFixed","_unit","isFinite","isNaN","number","suffix","formatInfinityOrNaN","concat","Opx","Odeg","CSSRGB","_CSSColorValue","alpha","isNone","unsetKeywordValue","keywordCache","unset","initial","inherit","noneColor","transparentColor","getOrCreateRGBA","getOrCreateUnitValue","colorStopToString","colorStop","join","parseGradient$1","tokens","input","error","msg","getAST","ast","matchListing","matchDefinition","matchGradient","matchLinearOrientation","matchListRadialOrientations","gradientType","pattern","orientationMatcher","matchCall","captures","orientation","scan","colorStops","matchColorStop","callback","match","radialOrientations","lookaheadCache","radialOrientation","matchRadialOrientation","radialType","circle","style","matchLength","matchExtentKeyword","matchCircle","ellipse","matchDistance","matchEllipse","at","matchAtPosition","extent","positionAt","defaultPosition","matchPositioning","positioning","location","matcher","color","matchNumber","captureIndex","regexp","blankCaptures","exec","consume","size","substring","code","computeLinearGradient","rcx","rcy","cos","sin","x1","y1","x2","computeRadialGradient","regexLG","regexRG","regexPR","regexColorStop","SideOrCornerToDegMap","angleToDeg","positonToCSSUnitValue","unitX","unitY","_position$value","parseGradient","colorStr","map","_ref","_colorStops$length","_colorStops$0$length","previousIndex","previousOffset","_colorStops$i$length","offset","spaceColorStops","steps","LinearGradient","_positonToCSSUnitValu","_orientation$0$style","_type","RadialGradient","_arr$2$match","stop","split","parseFloat","_ref2","_ref3","parsedRadialGradient","gradientStr","_arr$4$match","_ref4","_ref5","parseRadialGradient","patternStr","repetition","src","image","parsePattern","isPattern","object","isCSSRGB","parseColor","rgba","opacity","mergeColors","round","parseDimension","unitRegExp","string","trim","toLowerCase","matchedUnits","replace","taggedUnitRegExp","source","RegExp","parseLengthUnmemoize","css","parseLength","parseLengthOrPercentageUnmemoize","parseLengthOrPercentage","parseAngleUnmemoize","parseAngle","mergeDimensions","target","nonNegative","leftValue","rightValue","canonicalUnit","leftCanonicalUnitValue","convertTo","rightCanonicalUnitValue","isLength","convertPercentUnit","convertAngleUnit","parseDimensionArrayFormat","parsed","segment","valueWithUnit","vec3Index","useMin","bounds","nodeName","GROUP","getLocalBounds","getGeometryBounds","supportedFilters","numberToString","toString","parseNumberUnmemoize","parseNumber","mergeNumbers","clampedMergeNumbers","mergeNumberLists","numberList","getOrCalculatePathTotalLength","parsedStyle","isSamePoint","point1","point2","getExtraFromSegmentWithAngle","lineWidth","prePoint","currentPoint","nextPoint","currentAndPre","currentAndNext","preAndNext","currentAngle","acos","xExtra","yExtra","xAngle","yAngle","toSymmetry","angleBetween","v0","v1","pointOnEllipticalArc","p0","rx","ry","xAxisRotation","largeArcFlag","sweepFlag","p1","xAxisRotationRadians","ellipticalArcAngle","transformedPoint","radiiCheck","cRadicand","cCoef","transformedCenter","startVector","startAngle","sweepAngle","ellipseComponentX","ellipseComponentY","ellipticalArcStartAngle","ellipticalArcEndAngle","ellipticalArcCenter","resultantRx","resultantRy","getTangentAtRatio","ratio","sign","_segment$arcParams","arcParams","_segment$arcParams$rx","_segment$arcParams$ry","xRotation","arcFlag","p2","xDist","yDist","dist","vMag","v","vRatio","u","vAngle","getArcParams","startPoint","xp","yp","lambda","diff","cxp","cyp","theta","dTheta","endAngle","ellipseToCommands","convertToPath","transform","getLocalTransform","commands","LINE","_parsedStyle","_parsedStyle$x","_parsedStyle$y","_parsedStyle$x2","_parsedStyle$y2","lineToCommands","CIRCLE","_parsedStyle2","_parsedStyle2$r","_parsedStyle2$cx","_parsedStyle2$cy","ELLIPSE","_parsedStyle3","_parsedStyle3$rx","_parsedStyle3$ry","_parsedStyle3$cx","_cx","_parsedStyle3$cy","POLYLINE","POLYGON","points","closed","polygonToCommands","RECT","_parsedStyle4","_parsedStyle4$width","_parsedStyle4$height","_parsedStyle4$x","_parsedStyle4$y","radius","hasRadius","some","_radius","tlr","trr","brr","blr","signX","signY","filter","command","rectToCommands","PATH","reduce","prev","cur","p3","_p","_p2","commandsToPathString","internalParsePath","_unused","console","prevSegment","prevCmd","srcPoint","destPoint","removeRedundantMCommand","count","cmd","hasArcOrBezier","_extractPolygons","pathArray","extractPolygons","nextParams","startMovePoint","lastStartMovePointIndex","startTangent","endTangent","box","cubicParams","len","includes","cp","preSegment","_cp","cp1","cp2","_preSegment","_cp2","_cp3","_getTangentAtRatio","dx1","dy1","_getTangentAtRatio2","dx2","dy2","path2Segments","_getPathBBox","xArr","yArr","segmentsWithAngle","_i","_segment","_currentPoint","getPathBBox","memoizedParsePath","parsePath","mergePaths","curve1","curve2","curves","curve0","mergePoints","_","TRANSFORM_REGEXP","cast","contents","id","transformFunctions","matrix3d","rotateX","rotateY","rotateZ","rotate3d","perspective","scale","scaleX","scaleY","scaleZ","scale3d","skew","skewX","skewY","translate","translateX","translateY","translateZ","translate3d","parseArrayTransform","parsedArgs","parseTransform","prevLastIndex","lastIndex","functionName","functionData","argTypes","arg","parsedArg","A","T","L","toUpperCase","parseTransformUnmemoize","convertItemToMatrix","sqrLength","sc","sq","multiplyMatrices","makeMatrixDecomposition","transformList","quaternion","m44","mat4x4","a03","a13","a23","a30","a31","a32","a33","decomposeMat4","convertToMatrix","composeMatrix","multiply","temp","_i2","_j","numberToLongString","mergeMatrices","leftArgs","rightArgs","decompositionPair","list","q","fromQ","toQ","product","v2","dot","typeTo2D","typeTo3D","mergeTransforms","flipResults","_loop","_left$i","defaultValue","lt","rt","leftResult","rightResult","types","merged","_i3","leftType","rightType","leftFunctionData","rightFunctionData","_merged","_merged2","leftArgsCopy","rightArgsCopy","stringConversions","_merged3","stringifiedArgs","parseTransformOrigin","values","convertKeyword2Percent","keyword","BUILT_IN_PROPERTIES","inh","syntax","OPACITY_VALUE","PAINT","COLOR","LENGTH_PERCENTAGE","SHADOW_BLUR","LENGTH_PERCENTAGE_12","DEFINED_PATH","OFFSET_DISTANCE","ind","Z_INDEX","FILTER","TRANSFORM","TRANSFORM_ORIGIN","COORDINATE","LENGTH_PERCENTAGE_14","LIST_OF_POINTS","TEXT","TEXT_TRANSFORM","LENGTH","NUMBER","MARKER","GEOMETRY_ATTRIBUTE_NAMES","propertyMetadataCache","DefaultStyleValueRegistry","runtime","property","registerMetadata","metadata","CSSPropertySyntaxFactory","attributes","skipUpdateAttribute","skipParse","forceUpdateGeometry","usedAttributes","oldClipPath","clipPath","oldOffsetPath","offsetPath","pointsOrStr","needUpdateGeometry","fill","stroke","shadowColor","filterStr","filterRegExp","parseFilter","lineDash","pointStr","_pointStr$split","_pointStr$split2","textTransform","calculator","transformOrigin","markerStart","markerEnd","markerMid","zIndex","postProcessor","offsetDistance","geometry","dirty","renderable","boundsDirty","renderBoundsDirty","sceneGraphService","dirtifyToRoot","geometryUpdater","geometryUpdaterFactory","contentBounds","renderBounds","_geometryUpdater$upda","update","_geometryUpdater$upda2","_geometryUpdater$upda3","_geometryUpdater$upda4","cz","_geometryUpdater$upda5","hwidth","_geometryUpdater$upda6","hheight","_geometryUpdater$upda7","hdepth","_parsedStyle$lineWidt","_parsedStyle$increase","increasedLineWidthForHitTesting","_parsedStyle$shadowTy","shadowType","_parsedStyle$filter","expansion","SQRT2","halfLineWidth","_geometry$renderBound","shadowBlurInPixels","shadowBlur","shadowOffsetXInPixels","shadowOffsetX","shadowOffsetYInPixels","shadowOffsetY","shadowLeft","shadowRight","shadowTop","shadowBottom","blurRadius","_shadowOffsetX","_shadowOffsetY","_shadowBlur","_geometry$renderBound2","_min","_max","_shadowLeft","_shadowRight","_shadowTop","_shadowBottom","flipX","usedOriginXValue","usedOriginYValue","setOrigin","isSizeAttenuation","rawLineWidth","rawR","CSSPropertyAngle","mixer","oldParsed","CSSPropertyClipPath","oldPath","newPath","updateDisplayObjectDependency","childNodes","CSSPropertyColor","parser","CSSPropertyFilter","getFontSize","fontSize","CSSPropertyLengthOrPercentage","computed","isRelativeUnit","parentNode","_object$ownerDocument","ownerDocument","documentElement","_fontSize","CSSPropertyLengthOrPercentage12","CSSPropertyLengthOrPercentage14","CSSPropertyMarker","oldMarker","newMarker","_newMarker","cloned","cloneNode","isMarker","CSSPropertyNumber","CSSPropertyOffsetDistance","_object$parsedStyle","getPoint","setLocalPosition","CSSPropertyOpacity","CSSPropertyPath","CSSPropertyPoints","CSSPropertyShadowBlur","_CSSPropertyLengthOrP","CSSPropertyText","nodeValue","CSSPropertyTextTransform","rawText","getAttribute","transformedText","charAt","CANVAS_Map","WeakMap","cleanExistedCanvas","container","cleanUp","$dom","document","getElementById","destroy","isBrowser","isElement","sortByZIndex","o1","o2","zIndex1","zIndex2","findClosestClipPathTarget","_el$parsedStyle","parentElement","PX_SUFFIX","setDOMSize","$el","getStyle","defaultView","getComputedStyle","getPropertyValue","TOUCH_TO_POINTER","touchstart","touchend","touchendoutside","touchmove","touchcancel","clock","performance","now","Date","isInFragment","FRAGMENT","getRootNode","isFillOrStrokeAffected","pointerEvents","hasFill","hasStroke","isFillOtherThanNone","isStrokeOtherThanNone","uId","root","global","nowOffset","reservedCBs","lastTime","polyfillRaf","currentTime","gap","delay","keys","setTimeout","copied","polyfillCaf","getRequestAnimationFrame","vp","requestAnimationFrame","predicate","raf","caf","cancelAnimationFrame","getCancelAnimationFrame","AsyncParallelHook","callbacks","fn","Promise","AsyncSeriesWaterfallHook","_promise","mark","_callee","_this$callbacks","_args","wrap","_context","next","sent","abrupt","SyncHook","argsArr","SyncWaterfallHook","genericFontFamilies","stringRegExp","createSkewMatrix","skewMatrix","$mat4_1","$mat4_2","$vec3One$1","$vec3Zero$1","optimizer","setLocalScale","setLocalEulerAngles","dirtifyLocal","transformable","parsedTransformToMat4","_transform$i","setLocalTransform","resetLocalTransform","CSSPropertyTransform","CSSPropertyTransformOrigin","CSSPropertyZIndex","parentEntity","parentRenderable","parentSortable","sortable","dirtyReason","Z_INDEX_CHANGED","CircleUpdater","_parsedStyle$cx","_parsedStyle$cy","_parsedStyle$r","EllipseUpdater","_parsedStyle$rx","_parsedStyle$ry","LineUpdater","PathUpdater","_d$rect","PolylineUpdater","RectUpdater","_parsedStyle$width","_parsedStyle$height","contentWidth","contentHeight","TextUpdater","globalRuntime","_parsedStyle$textAlig","textAlign","_parsedStyle$textBase","textBaseline","_parsedStyle$dx","_parsedStyle$dy","isReadyToMeasure","metrics","font","lines","lineWidths","lineHeight","maxLineWidth","fontProperties","ascent","descent","lineMetrics","offscreenCanvas","getConfig","textService","measureText","lineXOffset","lineYOffset","GroupUpdater","HTMLUpdater","FederatedEvent","manager","eventPhase","NONE","bubbles","cancelBubble","cancelable","defaultPrevented","propagationStopped","propagationImmediatelyStopped","layer","page","viewport","composed","CAPTURING_PHASE","AT_TARGET","BUBBLING_PHASE","propagationPath","composedPath","nativeEvent","Event","preventDefault","FederatedMouseEvent","client","movement","screen","getModifierState","FederatedPointerEvent","_FederatedMouseEvent","isPrimary","clonePointerEvent","FederatedWheelEvent","cloneWheelEvent","CustomEvent","_FederatedEvent","eventName","detail","CANVAS_CACHE","EventTarget","emitter","listener","addEventListener","capture","once","_options$capture","_options$once","handleEvent","on","removeEventListener","removeAllEventListeners","_this$emitter","removeAllListeners","_listener","off","dispatchEvent","e","_ownerDocument","skipPropagate","getEventService","Node","_EventTarget","shadow","isConnected","baseURI","nodeType","_step","_iterator","done","_child","textContent","err","content","_this2","removeChild","opts","host","namespace","prefix","otherNode","isEqualNode","node1Root","node2Root","node1Hierarchy","node2Hierarchy","_node1Root$parentNode","DOCUMENT_POSITION_DISCONNECTED","DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC","DOCUMENT_POSITION_PRECEDING","longerHierarchy","shorterHierarchy","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_CONTAINS","longerStart","shorterHierarchyNode","longerHierarchyNode","nodes","EventService","nativeHTMLMap","cursor","mappingTable","mappingState","trackingData","eventPool","tmpMatrix","tmpVec3","onPointerDown","from","createPointerEvent","pointerType","isRightButton","button","pointerId","pressTargetsByButton","freeEvent","onPointerUp","alwaysTriggerPointerEventOnCanvas","rootTarget","pressTarget","findMountedTarget","clickTarget","currentTarget","notifyTarget","_isRightButton","_e$detail","clickEvent","clicksByButton","clickCount","timeStamp","renderingContext","clickHistory","dblClickSpeed","preventClick","useNativeClickEvent","onPointerMove","isMouse","outTarget","overTargets","outType","outEvent","leaveEvent","overType","overEvent","overTargetAncestor","enterEvent","getCursor","onPointerOut","onPointerOver","onPointerUpOutside","onWheel","wheelEvent","createWheelEvent","onClick","onPointerCancel","addEventMapping","contextService","getBoundingClientRect","getDomElement","offsetWidth","offsetHeight","_this$getScale","getScale","_this$getScale2","camera","getCamera","_this$context$config","getPerspectiveInverse","worldMatrix","getWorldTransform","canvasP","clip","_this$context$config2","pickHandler","priority","mappers","warn","notifyListeners","propagate","unshift","viewportX","viewportY","_this$context$config3","disableHitTesting","_target","shadowRoot","event","_arr","eventTarget","existed","hitTest","clientX","clientY","canvasX","canvasY","fallbackTarget","allocateEvent","copyPointerData","copyMouseData","copyData","originalEvent","existedHTML","getExistedHTML","isNativeEventFromCanvas","pickTarget","copyWheelData","overTarget","to","pressure","tangentialPressure","tiltX","tiltY","twist","altKey","buttons","ctrlKey","metaKey","shiftKey","copyFrom","deltaMode","deltaX","deltaY","deltaZ","isTrusted","constructor","listeners","_events","removeListener","call","OffscreenCanvasCreator","contextAttributes","getContext","willReadFrequently","OffscreenCanvas","createElement","getOrCreateCanvas","_unused2","_unused3","RenderReason","RenderingService","inited","stats","total","rendered","zIndexCounter","hooks","init","initAsync","dirtycheck","cull","beginFrame","beforeRender","render","afterRender","endFrame","pick","pickSync","pointerDown","pointerUp","pointerMove","pointerOut","pointerOver","pointerWheel","pointerCancel","click","getCallbacksNum","promise","then","renderer","renderReasons","CAMERA_CHANGED","canvasConfig","frame","rerenderCallback","syncHierarchy","triggerPendingEvents","dirtyRectangleRenderingDisabled","disableDirtyRectangleRendering","onlyCameraChanged","shouldTriggerRenderHooks","disableRenderHooks","renderDisplayObject","renderListCurrentFrame","displayObject","_this3","_canvasConfig$rendere","objectChanged","objectToRender","renderOrder","dirtyChildren","sorted","_index","_index2","array","low","high","sortedIndex","clearPendingEvents","add","DISPLAY_OBJECT_CHANGED","ATTRIBUTE_REGEXP","DefaultSceneGraphSelector","query","startsWith","classList","getIdOrClassname","_this$getAttribute","attributeToString","findAll","_this$getAttribute2","className","_this$getAttribute3","matches","ElementEvent","MutationEvent","typeArg","relatedNode","prevValue","newValue","attrName","attrChange","prevParsedValue","newParsedValue","markRenderableDirty","ADDITION","MODIFICATION","REMOVAL","rectUpdater","polylineUpdater","reparentEvent","REPARENT","$vec2Zero","$vec3Zero","$vec3One","$mat4Identity","$vec2","$vec3$1","$mat4","$quat$1","$setLocalTransform_1","$setLocalTransform_2","$setLocalTransform_3","$setLocalPosition","$setPosition_1","$setPosition_ParentInvertMatrix","$setEulerAngles_InvParentRot","$rotateLocal","$rotate_ParentInvertRotation","$triggerPendingEvents_detail","affectChildren","DefaultSceneGraphService","pendingEvents","boundsChangedEvent","BOUNDS_CHANGED","displayObjectDependencyMap","sceneGraphSelector","is","selectOne","selectAll","_sortable$sorted","detached","detach","isChildFragment","isAttachToFragment","ADDED","dirtifyFragment","dirtifyWorld","_sortable$sorted2","_style","REMOVED","element","origin","originVec","degrees","rotation","rot","getRotation","parentRot","localRotation","rotateLocal","parentRotation","dirtify","localPosition","_position$","parentTransform","worldTransform","_position$2","scaling","_scaling$","localScale","_scaling$2","setLocalRotation","localSkew","localDirtyFlag","dirtyFlag","unfreezeParentToRoot","dirtifyWorldInternal","frozen","triggered","Set","skipped","trigger","isMutationObserved","informDependentDisplayObjects","oldDependencyMap","newDependencyMap","dependencyMap","ATTR_MODIFIED","isCustomElement","attributeChangedCallback","sync","localTransform","hasPosition","hasRotation","hasScale","hasOrigin","calcLocalTransform","setLocalSkew","existedAABB","setFromTransformedAABB","styleValueRegistry","updateGeometry","getTransformedGeometryBounds","childBounds","getBounds","clipped","clipPathBounds","parentInvert","localBounds","_element$ownerDocumen","getContextService","_aabb$getMin","_aabb$getMin2","_aabb$getMax","_aabb$getMax2","_this4","childTransform","TEXT_METRICS","MetricsString","BaselineSymbol","BaselineMultiplier","HeightMultiplier","Newlines","BreakingSpaces","LATIN_REGEX","regexCannotStart","regexCannotEnd","TextService","fontMetricsCache","shouldBreakByKinsokuShorui","_char","nextChar","isBreakingSpace","trimByKinsokuShorui","prevLine","lastChar","properties","offscreenCanvasCreator","getOrCreateContext","metricsString","baseline","fillStyle","fillRect","fillText","imagedata","getImageData","pixels","line","idx","_parsedStyle$fontSize","_parsedStyle$wordWrap","wordWrap","strokeHeight","_parsedStyle$letterSp","letterSpacing","textPath","textPathSide","textPathStartOffset","_parsedStyle$leading","leading","_attributes$fontSize","_attributes$fontFamil","fontFamily","_attributes$fontStyle","fontStyle","_attributes$fontVaria","fontVariant","_attributes$fontWeigh","fontWeight","fontSizeString","fontFamilies","_fontFamily","toFontString","measureFont","isOverflowing","_lineWidth","_width","getTotalLength","_parsedStyle$wordWrap2","wordWrapWidth","_parsedStyle$letterSp2","_parsedStyle$maxLines","maxLines","textOverflow","maxWidth","ellipsis","currentIndex","currentWidth","calcWidth","_char2","getFromCache","ellipsisWidth","chars","_char3","prevChar","charWidth","isNewline","currentLineLength","lastLineWidth","lastLineIndex","canBreakInLastChar","trimToBreakable","sumTextWidthByCache","_char4","charCodeAt","_char5","findBreakableIndex","trimmedChar","trimFrom","trimTo","_char6","sum","spacing","IMAGE","HTML","MESH","PERCENTAGE","ANGLE","CameraContribution","AnimationTimeline","EasingFunction","layoutRegistry","enableStyleSyntax","entityCounter","insertedEvent","INSERTED","removedEvent","destroyEvent","DESTROY","Element","_Node","entity","dirtyRenderBounds","cullable","strategy","Standard","visibilityPlaneMask","visible","enable","rBushNode","namespaceURI","scrollLeft","scrollTop","clientTop","clientLeft","destroyed","computedStyle","setAttribute","firstChild","lastChild","deep","_this$ownerDocument","attach","mountChildren","mountFragment","newChild","refChild","appendChild","oldChild","_child$ownerDocument","unmountChildren","destroyChildren","selector","querySelector","querySelectorAll","tagName","selectors","objects","_len2","_key2","_this4$parentNode","_len3","_key3","first","rest","after","_this5","_len4","_key4","_this6","_len5","_key5","append","entries","qualifiedName","getAttributeNames","attributeName","force","localName","attr","isDisplayObject","Proxy","mutationEvent","$vec3","$quat","DisplayObject","_Element","activeAnimations","initialParsedStyle","initAttributes","setProperty","propertyName","removeProperty","removeAttribute","prop","getAnimations","animation","cancel","customCloneFunc","clonedStyle","attribute","interactive","clonedChild","processProperties","internalSetAttribute","parseOptions","oldValue","oldParsedValue","getOrigin","translateLocal","getLocalPosition","scaleLocal","getLocalScale","_getEuler","_getEuler3","getLocalRotation","setEulerAngles","setRotation","getLocalSkew","keyframes","timeline","play","_this$parsedStyle","visibility","isInteractive","_this$parsedStyle2","transformMat4","_mat4$getTranslation","_mat4$getTranslation2","_getEuler5","_getEuler6","eux","euz","fromRotationTranslationScale","getMatrix","_decompose","_decompose2","_decompose3","_decompose4","childElementCount","firstElementChild","lastElementChild","Circle","_DisplayObject","_excluded$6","CustomElement","Ellipse","Group","_excluded$5","Image","_excluded$4","Line","z1","markerStartAngle","markerEndAngle","getLocalEulerAngles","transformMarker","isStart","markerStartOffset","markerEndOffset","marker","originalAngle","inWorldSpace","_this$parsedStyle3","_linePointAt","transformed","_this$parsedStyle4","_excluded$3","Path","miterLimit","markerMidList","placeMarkerMid","_this$getStartTangent","getStartTangent","_this$getStartTangent2","_this$getEndTangent","getEndTangent","_this$getEndTangent2","_segments$i$currentPo","_getPointAtLength2","getPointAtLength","endPoint","tangent","_excluded$2","Polygon","isClosed","_excluded$1","Polyline","_Polygon","polyline","segmentT","segmentL","tempLength","subt","Rect","_excluded","Text","_this$parsedStyle$met","_this$parsedStyle$met2","CustomElementRegistry","registry","define","CSS","percent","em","rem","grad","turn","ms","registerProperty","definition","inherits","interpolable","initialValue","registerLayout","clazz","Document","initialStyle","customElements","shape","rBushNodes","rBushRoot","hitTestList","_ref3$pointerEvents","isVisibilityAffected","isVisible","isCulled","_this$defaultView$can","canvas2Viewport","_this$defaultView$get","_this$defaultView$vie","viewport2Client","picked","getRenderingService","topmost","_elementFromPoint","_this$defaultView$can2","_this$defaultView$get3","_this$defaultView$vie2","_yield$this$defaultVi","_x","_x2","_this$defaultView$can3","_this$defaultView$get4","_this$defaultView$vie3","_elementsFromPoint","_callee2","_this$defaultView$can4","_this$defaultView$get6","_this$defaultView$vie4","_yield$this$defaultVi2","_context2","_x3","_x4","getElementsByName","getElementsByTagName","getElementsByClassName","CullingPlugin","strategies","renderingService","tap","tag","unculledEntities","every","CULLED","EventPlugin","autoPreventDefault","rootPointerEvent","rootWheelEvent","_this$context$renderi","supportsTouchEvents","normalizedEvents","normalizeToPointerEvent","normalizedEvent","bootstrapEvent","eventService","mapEvent","setCursor","_this$context$renderi2","_step2","_iterator2","setPickHandler","normalizeWheelEvent","events","isNormalized","_step3","_iterator3","federatedEvent","_step4","$element","outside","_iterator4","_step5","_iterator5","transferMouseData","_this$context$eventSe","client2Viewport","_this$context$eventSe2","_this$context$eventSe3","_this$context$eventSe4","srcElement","movementX","movementY","pageX","pageY","screenX","screenY","relatedTarget","applyCursorStyle","isTouchEvent","changedTouches","touch","touches","radiusX","radiusY","identifier","isMouseEvent","tempEvent","shape2D","FrustumCullingStrategy","_object$parentNode","getRenderBounds","parentVisibilityPlaneMask","computeVisibilityWithPlaneMask","INDETERMINATE","OUTSIDE","parentPlaneMask","INSIDE","mask","isShape2D","_planes$k","getPositiveFarPoint","getNegativeFarPoint","PrepareRendererPlugin","syncTasks","isFirstTimeRendering","syncing","isFirstTimeRenderingFinished","_runtime$globalThis$r","rBush","handleAttributeChanged","handleBoundsChanged","handleMounted","updateSizeAttenuation","getZoom","handleUnmounted","MOUNTED","UNMOUNTED","ric","requestIdleCallback","bind","syncRTree","_renderBounds$getMin","_renderBounds$getMin2","_renderBounds$getMax","_renderBounds$getMax2","bulk","synced","syncNode","CanvasEvent","mountedEvent","unmountedEvent","beforeRenderEvent","BEFORE_RENDER","rerenderEvent","RERENDER","afterRenderEvent","AFTER_RENDER","Canvas","devicePixelRatio","background","createImage","enableLargeImageOptimization","supportsPointerEvents","supportsCSSTransform","_config$cleanUpOnDest","cleanUpOnDestroy","supportsMutipleCanvasesInOneContainer","canvasWidth","canvasHeight","dpr","getWidth","getHeight","PointerEvent","TouchEvent","MouseEvent","initRenderingContext","initDefaultCamera","initRenderer","mergedConfig","setType","getStats","readyPromise","resolve","resolveReadyPromise","skipTriggerEvent","fastCleanExistingCanvas","BEFORE_DESTROY","frameId","getRoot","AFTER_DESTROY","clearEventRetain","resize","getProjectionMode","getNear","getFar","setAspect","RESIZE","insertBefore","removeChildren","_tick","time","firstContentfullPaint","loadRendererContainerModule","ContextService","initRenderingService","_this7","async","READY","RENDERER_CHANGED","run","_this8","getPlugins","oldRenderer","reverse","_this9","disconnectedCallback","_this10","connectedCallback"],"sourceRoot":""}